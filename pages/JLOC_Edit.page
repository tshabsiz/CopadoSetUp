<apex:page standardController="JLOC__c" extensions="JLOC_EditController" showHeader="true" sidebar="true" >
    <apex:stylesheet value="{!URLFOR($Resource.easytabs, 'style.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.jquery, 'jquery-1.11.1.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.blockUI, 'jquery.blockUI.js')}"/>
    <script type="text/javascript">
    
    function checkForeCast()
    {
       
        var error = $(this).attr('value');
        if('{!JLOC__c.Stress_Case_ID__c}' ||'{!JLOC__c.Management_Case_ID__c}' || '{!JLOC__c.Banker_Case_ID__c}')
         {
             document.getElementById('{!$Component.j_id0:j_id8:pb:NotApplicable}').checked=false;
             displayMessage();
         }
        
    }
    //Create array of tabs in Javascript
    function Tab(tabKey, tabValue) {
        this.tabKey = tabKey;
        this.tabValue = tabValue;
    }
    
    Tab.prototype.toString = function() {
        return this.tabKey + ', ' + this.tabValue;
    };
    
    var tabItem;
    var tabItemArray = [];
    
    //Load tabs
    <apex:repeat value="{!tabs}" var="tabkey">
        tabItem = new Tab({!tabkey}, '{!tabs[tabkey]}');
    tabItemArray.push(tabItem);
    </apex:repeat>
    </script>
    <script type="text/javascript">
    //Tab switching method
    function switchTab(tabId) {
        for(var i = 0; i < tabItemArray.length; i++) {
            var tabItem = tabItemArray[i];
            
            if(tabItem.tabKey == tabId) {
                $('#' + 'tab-' + tabItem.tabKey + '-content').css('display','block');
                $('#' + 'tab-' + tabItem.tabKey + '-tab').addClass('active');
            } else {
                $('#' + 'tab-' + tabItem.tabKey + '-content').css('display','none');
                $('#' + 'tab-' + tabItem.tabKey + '-tab').removeClass('active');
            }
        }
        saveOnTabSwitch();
    }
    
    //Set initial tabs visibility
    $(document).ready(function() { 
        //Disable all tabs
        for(var i = 0; i < tabItemArray.length; i++) {
            var tabItem = tabItemArray[i];
            $('#' + 'tab-' + tabItem.tabKey + '-content').css('display','none');
            $('#' + 'tab-' + tabItem.tabKey + '-tab').removeClass('active');
        }
        
        //Set active tab
        var hash = $(location).attr('hash');
        if(hash != '') {
            hash = hash.substring(2);
            switchTab(hash);
        } else {
            //Default
            switchTab(1);
        }
        
        //Set onChange handler for all Decleration options
        $('.radiosTable input[type=radio]').change(function() {
            $(this).closest('tr').find('input[type=hidden]').val(this.value);
        });
        
        //Check if someone else recently opened this record for editing
        checkSoftLock();
        window.onfocus = function() {
            
            if (window.mypopup != null && window.mypopup.closed) {
                window.mypopup =null;
                window.location.reload();
            }
        };	
        
    });
    
    
    
    </script> 
    <style>
        .table-1col, .table-2col, .table-3col {
        width: 100%;
        }
        .grid-view {
        border-collapse: collapse;
        margin-left: 1%;
        margin-right: 1%;
        width: 98%;
        }
        .grid-view td, th {
        border: 1px solid #999;
        padding: 4px;
        text-align: left;
        }
        .grid-view th {
        background-color: whitesmoke;
        font-weight: bold;
        }
        .grid-view caption {
        text-align: left;
        }
        .smaller-row-font {
        font-size: 10.5px;
        }
        .table-2col td {
        width: 50%;
         border: 1px solid #999;
        padding: 4px;
        text-align: left;
        }
        .table-3col td {
        width: 33%;
         border: 1px solid #999;
        padding: 4px;
        text-align: left;
        }
        .field-header {
        padding-bottom: 12px;
        }
        .label-header {
        margin-right: 16px;
        font-weight: bold;
        }
        .field {
        margin: 12px;
        }
        .warning {
        border: 1px;
        border-style: solid;
        border-color: #ff0000;
        width: 98%;
        margin:12px;
        }
        .warning .header {
        font-weight: bold;
        padding: 3px;
        margin-bottom: 5px;
        }
        .warning .field {
        font-weight: normal;
        margin: 6px;
        color: #181818;
        }
        .label {
        font-weight: bold;
        margin-bottom: 12px;
        color: #181818;
        }
        .help {
        font-style: italic;
        font-size: 11px;
        color: #282828;
        }
        .text {
        width: 25%;
        }
        .text-area {
        width: 100%;
        resize: vertical;
        }
        .inline-button {
        margin: 12px !important;
        }
        .image {
        max-width: 100%;
        }
        .width10 {
        width: 10em;
        }
        .bold {
        font-weight: bold;
        }
        .hoverTable tr:hover{
        background-color:#6c6d5e;
        }
        .hoverDiv:hover {
        background-color:#6c6d5e;
        }
        td.prob {
        width: 50px;
        background-color: #FEFFE9;
        text-align: right;
        }            
        td.included {
        width: 40px;
        text-align: center;
        }
        td.sum {
        background-color: #E2E2E2;
        color: black;
        text-align: right;
        }
        td.rev {
        text-align: right;
        }
        td.included img {
        width: 12px;
        }
        li {
        color: #ff0000;
        }
        .financialstableul li {
			color: black;
		}
    </style>
    
    <apex:form >
        <apex:pageBlock title="Edit JLOC" id="pb">
            <apex:pageMessages id="pgMsg"/>
            <apex:actionStatus id="processing" onstart="$.blockUI({ css: { 
                                                        border: 'none', 
                                                        padding: '15px', 
                                                        backgroundColor: '#000', 
                                                        '-webkit-border-radius': '10px', 
                                                        '-moz-border-radius': '10px', 
                                                        opacity: .5, 
                                                        color: '#fff' 
                                                        } });" onstop="$.unblockUI();"/>
            <apex:actionFunction action="{!checkSoftLock}" name="checkSoftLock" reRender="pgMsg" />
            <apex:actionFunction action="{!quicksave}" status="processing" name="saveOnTabSwitch" reRender="pgMsg" />
            <apex:actionFunction action="{!displayMessage}" status="processing" name="displayMessage" reRender="pgMsg" />
            <apex:pageBlockButtons >
                <apex:commandButton action="{!save}" value="Save" status="processing" reRender="pgMsg"/>
                <apex:commandButton action="{!cancel}" value="Cancel"/>
            </apex:pageBlockButtons>
            
            <apex:outputPanel >
                <div class="field-header">
                    <span class="label-header">{!$ObjectType.JLOC__c.fields.JLOC_Status__c.Label}</span>
                    <apex:outputField value="{!JLOC__c.JLOC_Status__c}" />
                </div>
                
                <div id="tab-container" class="tab-container">
                    <ul class="tabs">
                        <apex:repeat value="{!tabs}" var="tabkey">
                            <li id="tab-{!tabkey}-tab" class="tab"><a id="tab-{!tabkey}-link" href="#/{!tabkey}" onclick="switchTab({!tabkey})">{!tabs[tabkey]}</a></li>
                        </apex:repeat>
                    </ul>
                    
                    <div class='panel-container'>
                        <div id="tab-1-panel">
                            <div id="tab-1-content">
                                <table class="table-2col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Organisation__c.Label}</div>
                                                <apex:outputText styleClass="text" value="{!JLOC__c.Organisation__r.Name}" />
                                            </div>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Compliance__c.Label}</div>
                                                <apex:inputField styleClass="text" value="{!JLOC__c.Compliance__c}" />
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_MeetingDate}</div>
                                                <apex:inputField styleClass="text" value="{!JLOC__c.Date__c}" />
                                            </div>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Date_of_last_JLOC__c.Label}</div>
                                                <apex:inputField styleClass="text" value="{!JLOC__c.Date_of_last_JLOC__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Reason_for_JLOC__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Reason_for_JLOC__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-3col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_ExistingRelationShipRoRWA} (%)</div>
                                                <apex:outputField styleClass="text" value="{!clientPlan.RoRWA_Existing__c}" />
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_ProductsRoRWA} (%)</div>
                                                <apex:inputField styleClass="text" value="{!JLOC__c.Future_RoRWA__c}" />
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_TotalRelationShipRoRWA} (%)</div>
                                                <apex:inputField styleClass="text" value="{!JLOC__c.Total_RoRWA__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-3col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_TotalFinancingLimits}</div>
                                                <apex:outputField styleClass="text-area" value="{!clientPlan.TFL__c}" />
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Total_Fin_Limits_Proposed__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Total_Fin_Limits_Proposed__c}" />
                                            </div>
                                        </td>                                        
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Status__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Status__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-3col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.Client_Plan__c.fields.DG__c.Label}</div>
                                                <apex:outputField styleClass="text-area" value="{!clientPlan.DG__c}" />
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.CLGD_Consumption__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.CLGD_Consumption__c}" />
                                            </div>
                                        </td>
                                        <td/>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_TransactionSummary}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Brief_Transaction_Description_Without__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_TransactionStructure}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Transaction_Structure__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Recommendation__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Recommendation__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-3col">
                                    <tr>
                                        <td>
                                            <div class="warning">
                                                <div class="header">
                                                    The following fields will be directly imported from the Relationship, Opportunity and Client Plan:
                                                </div>
                                                <div class="field">
                                                    <ul>
                                                        <li>{!$Label.lbl_OriginationCountry}</li>
                                                        <ul><table width="100%">
                                                            <tr>
                                                                <td>{!JLOC__c.Organisation__r.Client_Country__c}</td>
                                                            </tr>
                                                            </table>
                                                        </ul>
                                                        <li>{!$Label.lbl_BookingCountry}</li>
                                                        <ul>
                                                            <table width="100%" >
                                                                <tr>
                                                                    <td>{!jlocOpportunity.Opportunity_Country__c}</td>
                                                                </tr>
                                                            </table>
                                                        </ul>
                                                        <li>{!$Label.lbl_CoverageBanker}</li>
                                                        <ul>
                                                            <table width="100%" >
                                                                <tr>
                                                                    <td>{!JLOC__c.Organisation__r.Owner.Name}</td>
                                                                </tr>
                                                            </table>
                                                        </ul>
                                                        <li>{!$Label.lbl_RelationshipFinancials} - <i>Note: if the Client Plan contains a Relationship Financials image then no individual data points, such as Turnover or EBITDA, can be shown on the JLOC and the relevant table will stay empty. Only if Relationship Financials data on the Client Plan is provided on a granular level (either manual or through integration) can this be displayed on the JLOC.</i></li>
                                                        <li>{!$Label.lbl_TotalFinancingLimits}</li>
                                                        <li>{!$Label.lbl_ExistingRelationShipRoRWA}</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        
                        <div id="tab-2-panel">
                            <div id="tab-2-content">
                                
                                
                                
                                
                                
                                <table class="table-2col">
                                    <tr>
                                        <td>
                                            <div class="warning">
                                                <div class="header">
                                                    The following fields will be directly imported from the Relationship, Opportunity and Client Plan:
                                                </div>
                                                <div class="field">
                                                    <li>Proposed Products (source:  Linked Opportunity / Opportunities)
                                                    </li>
                                                    <ul>
                                                        <!--<a href="window.open('AddProductToOpportunity?retURL=0061w0000024D70&id=00k1w000002xL7G','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">-->
                                                        <table class="grid-view hoverDiv" >
                                                            
                                                            <tr class="smaller-row-font">
                                                                <th> {!$Label.lbl_Product}</th>
                                                                <th>{!$Label.lbl_Tenor}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Hold_Size__c.Label}</th>
                                                                <th>{!$Label.lbl_EstUtilisation} (%)</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Base_Rate__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Gross_Margin__c.Label}</th>
                                                                <th>{!$Label.lbl_FTP}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Margin__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Arranging_Fee__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Committment_Fee__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Annual_Facility_Fee__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.Threshold__c.Label}</th>
                                                                <th>{!$ObjectType.OpportunityLineItem.fields.RoRWA__c.Label}</th>
                                                            </tr>
                                                            <apex:repeat value="{!products}" var="prod">
                                                                <tr class="smaller-row-font" onclick="window.mypopup = window.open('AddProductToOpportunity?&id={!prod.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                                    <td>
                                                                        <apex:outputField value="{!prod.Product_Level_3__r.Name}"   rendered="{!prod.Product_Level_3__c != null}"/>
                                                                        <apex:outputField value="{!prod.Product_Level_2__r.Name}"   rendered="{!prod.Product_Level_3__c == null && prod.Product_Level_2__c != null}"/>
                                                                        <apex:outputField value="{!prod.Product_Name__c}"           rendered="{!prod.Product_Level_3__c == null && prod.Product_Level_2__c == null && prod.Product_Name__c != null}"/>
                                                                    </td>
                                                                    <td>
                                                                        <apex:outputText rendered="{!prod.Term_Interval__c==NULL || prod.Term_Interval__c=='Years'}">{!ROUND(prod.Terms_Years__c,2)} {!prod.Term_Interval__c}</apex:outputText>
                                                                        <apex:outputText rendered="{!prod.Term_Interval__c!=NULL && prod.Term_Interval__c=='Months'}">{!ROUND((prod.Terms_Years__c * 12),2)} {!prod.Term_Interval__c}</apex:outputText>
                                                                        <apex:outputText rendered="{!prod.Term_Interval__c!=NULL && prod.Term_Interval__c=='Days'}">{!FLOOR(prod.Terms_Years__c * 12 * 30.43687500000008)} {!prod.Term_Interval__c}</apex:outputText>
                                                                    </td>
                                                                    <td style="text-align: right">
                                                                        <apex:outputField value="{!prod.Hold_Size__c}" rendered="{!prod.Product2.Family != NULL && prod.Product2.Family == 'Debt'}"/>
                                										<apex:outputField value="{!prod.Balance__c}" rendered="{!prod.Product2.Family == NULL || prod.Product2.Family != 'Debt'}"/>
                                                                    </td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Estimated_Utilisation__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Base_Rate__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Gross_Margin__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Ftp__c}"/><apex:outputText value="%" rendered="{!prod.Ftp__c != null}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Margin__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Arranging_Fee__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Committment_Fee__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Annual_Facility_Fee__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.Threshold__c}"/></td>
                                                                    <td style="text-align: right"><apex:outputField value="{!prod.RoRWA__c}"/></td>
                                                                </tr>
                                                            </apex:repeat>
                                                        </table><!--</a>-->
                                                    </ul>
                                                    
                                                    <li>{!$Label.lbl_OtherPipelineOpportunities}</li>
                                                    <ul>
                                                            <apex:outputPanel rendered="{!!jlocOpenOpportunitiesExcluded.empty}">
                                                                
                                                                <table class="grid-view hoverDiv">
                                                                    <tr class="smaller-row-font">
                                                                        <th>{!$Label.lbl_OpenOpportunity}</th>
                                                                        <th>{!$Label.lbl_Product}</th>
                                                                        <th>{!$Label.lbl_TotalBalanceFacilitySize}</th>
                                                                        <th>{!$Label.lbl_AnnualisedIncome}</th>
                                                                        <th>{!$Label.lbl_CloseDate}</th>
                                                                        <th>{!$Label.lbl_Probability}</th>
                                                                        <th>{!$Label.lbl_Stage}</th>
                                                                    </tr>
                                                                    <apex:repeat value="{!jlocOpenOpportunitiesExcluded}" var="opp">
                                                                        <tr class="smaller-row-font">
                                                                            <td style="width:20%"><apex:outputField value="{!opp.Name}"/></td>
                                                                            <td style="width:20%">
                    															<apex:variable value="{!0}" var="prodNum"/>            
                                												<apex:repeat value="{!opp.OpportunityLineItems}" var="prod">
                                    												<apex:outputText value=", " rendered="{!prodNum > 0}"/>
                                    												<apex:outputText value="{!prod.Product_Name__c}"/>
                                    												<apex:variable var="prodNum" value="{!prodNum + 1}"/>
                                												</apex:repeat>
                            												</td>
                            												<td style="width:15%"><apex:outputField value="{!opp.Total_Balance_Facility_Size__c}"/></td>
                                                                            <td style="width:15%"><apex:outputField value="{!opp.Annualised_Income__c}"/></td>
                                                                            <td style="width:8%"><apex:outputText value="{0,date,dd/MM/yyyy}" rendered="{!opp.CloseDate != null}"><apex:param value="{!opp.CloseDate}" /></apex:outputText></td>
                                                                            <td style="width:8%"><apex:outputField value="{!opp.Probability}"/></td>
                                                                            <td style="width:14%"><apex:outputField value="{!opp.StageName}"/></td>
                                                                        </tr>
                                                                    </apex:repeat>
                                                                </table>
                                                            </apex:outputPanel>
                                                    </ul>
                                                    
                                                        <li>Facilities (Absa) (source: Client Plan – Plan tab)</li>
                                                        <ul>
                                                             <apex:outputPanel rendered="{!!planController.acmfsKeys.empty}">
                                                                <table id="facilitiesTable" class="grid-view hoverDiv"  onclick="window.mypopup = window.open('ClientPlan?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                                    <thead>
                                                                        <tr class="slds-text-hexading--label">
                                                                            <th>
                                                                                {!$ObjectType.ACMFacility__c.fields.FACILITYPRODUCTDESCRIPTION__c.Label}
                                                                            </th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.Country__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.EXPIRYDATE__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.FACILITYAMOUNT__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.LOSSGIVENDEFAULT__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.ACMUTILIZATIONAMOUNT__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.GROSS_MARGIN__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.FTP_bps__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.Net_Margin__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.Arrang_Fee__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.COM_FEES__c.Label}</th>
                                                                            <th>{!$ObjectType.ACMFacility__c.fields.RoRWA__c.Label}</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <apex:variable value="{!0}" var="acmfsKeyIndex"/>
                                                                        <apex:repeat value="{!planController.acmfsKeys}" var="acmfsKey">
                                                                            <tr id="{!acmfsKey}" class="slds-hint-parent">
                                                                                <td class="facilityCPTYLABEL" colspan="13" bgcolor="#bfbfbf">
                                                                                    {!planController.acmfsLabels[acmfsKeyIndex]}
                                                                                </td>
                                                                            </tr>
                                                                            <apex:repeat value="{!planController.acmfsMap[acmfsKey]}" var="acmf">
                                                                                <tr id="{!acmf.Id}" class="slds-hint-parent">
                                                                                    <td class="facilityProductDescription">
                                                                                        {!acmf.FACILITYPRODUCTDESCRIPTION__c}
                                                                                    </td>
                                                                                    <td class="facilityCountry">
                                                                                        {!acmf.Country__c}
                                                                                    </td>
                                                                                    <td class="facilityExpiryDate">
                                                                                        <apex:outputText value="{0, date, dd/MM/yyyy}" rendered="{!acmf.EXPIRYDATE__c != null}">
                                                                                            <apex:param value="{!acmf.EXPIRYDATE__c}" /> 
                                                                                        </apex:outputText>
                                                                                    </td>
                                                                                    <td class="facilityAmount">
                                                                                        {!acmf.FACILITYCURRENCY__c} <apex:outputText value="{0, number, ###,##0}"><apex:param value="{!acmf.FACILITYAMOUNT__c}"/></apex:outputText>
                                                                                    </td>
                                                                                    <td class="facilityLGD">
                                                                                        {!acmf.LOSSGIVENDEFAULT__c}
                                                                                    </td>
                                                                                    <td class="facilityUtilizationAmount">
                                                                                        {!acmf.ACMUTILIZATIONCURRENCY__c} <apex:outputText value="{0, number, ###,##0}"><apex:param value="{!acmf.ACMUTILIZATIONAMOUNT__c}"/></apex:outputText>
                                                                                    </td>
                                                                                    <td class="grossMargin">
                                                                                        <apex:outputText value="{!acmf.GROSS_MARGIN__c}" />
                                                                                    </td>
                                                                                    <td class="ftpBPS" >
                                                                                        <apex:outputText value="{!acmf.FTP_bps__c}"/>
                                                                                    </td>
                                                                                    <td class="netMargin">
                                                                                        <apex:outputText value="{!acmf.NET_MARGIN__c}"/>
                                                                                    </td>
                                                                                    <td class="arrangFee">
                                                                                        <apex:outputText value="{!acmf.Arrang_Fee__c}"/>
                                                                                    </td>
                                                                                    <td class="comFees">
                                                                                        <apex:outputText value="{!acmf.COM_FEES__c}"/>
                                                                                    </td>
                                                                                    <td class="roRWA">
                                                                                        <apex:outputText value="{!acmf.RoRWA__c}"/>
                                                                                    </td>
                                                                                    <td class="RETRIEVEDVIAACM" style="display:none">
                                                                                        <apex:outputText value="{!acmf.RETRIEVEDVIAACM__c}"/>
                                                                                    </td>
                                                                                </tr>
                                                                            </apex:repeat>
                                                                            <apex:variable var="acmfsKeyIndex" value="{!acmfsKeyIndex + 1}"/>
                                                                        </apex:repeat>
                                                                        <tr>
                                                                            <th colspan="12" class="facilityProductDescription">
                                                                                {!$Label.lbl_ACMSubTotal}
                                                                            </th>
                                                                        </tr>
                                                                        <apex:repeat value="{!planController.facilitySubTotalMap}" var="key">
                                                                            <tr>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td>
                                                                                    {!key}&nbsp;<apex:outputText value="{0, number,  ###,###,###.##}">
                                                                                    <apex:param value="{!planController.facilitySubTotalMap[key].facilityAmountSubTotal}"/>
                                                                                    </apex:outputText>
                                                                                </td>
                                                                                <td></td>
                                                                                <td>
                                                                                    {!key}&nbsp;<apex:outputText value="{0, number,  ###,###,###.##}">
                                                                                    <apex:param value="{!planController.facilitySubTotalMap[key].utilizationAmountSubTotal}"/>
                                                                                    </apex:outputText>
                                                                                </td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                <td></td>
                                                                            </tr>
                                                                        </apex:repeat>
                                                                        <tr>
                                                                            <th colspan="12" class="facilityProductDescription">
                                                                                {!$Label.lbl_ACMTotal}
                                                                            </th>
                                                                        </tr>
                                                                        <tr>
                                                                            
                                                                            <td/>
                                                                            <td/>
                                                                            <td/>
                                                                            <td>
                                                                                {!planController.userCurrency}&nbsp;<apex:outputText value="{0, number,  ###,###,###.##}">
                                                                                <apex:param value="{!planController.ACMFacilityFacilityTotal}"/>
                                                                                </apex:outputText>
                                                                            </td>
                                                                            <td/>
                                                                            <td>
                                                                                {!planController.userCurrency}&nbsp;<apex:outputText value="{0, number,  ###,###,###.##}">
                                                                                <apex:param value="{!planController.ACMFacilityUtilizationTotal}"/>
                                                                                </apex:outputText> 
                                                                                
                                                                            </td>
                                                                            <td/>
                                                                            <td/>
                                                                            <td/>
                                                                            <td/>
                                                                            <td/>
                                                                            <td/>
                                                                        </tr>
                                                                    </tbody>
                                                                 </table>
                                                            </apex:outputPanel>
                                                        </ul>
                                                        
                                                        <li>Revenues by Product (Existing and Future) (source: Client Plan – Plan tab)</li>
                                                    <ul>
                                                        <apex:outputPanel rendered="{!revByProduct != null}">
                                                            <table class="grid-view hoverDiv" onclick="window.mypopup = window.open('ClientPlan?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                                <tr>
                                                                    <th>&nbsp;</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductIncludedRoRwa}</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductLast12M}</th>
                                                                    <th>{!$Label.lbl_RWA}</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductNext12M}</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductNext12MProb}</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductNext1224M}</th>
                                                                    <th>{!$Label.lbl_RevenuesByProductNext1224MProb}</th>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductAssetSales}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_AssetSalesFinance__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_AssetSalesFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_AssetSalesFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_AssetSalesFinance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_AssetSalesFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_AssetSalesFinance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_AssetSalesFinance__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductAvgDepBal}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_AverageDepositBalance__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_AverageDepositBalance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_AverageDepositBalance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_AverageDepositBalance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_AverageDepositBalance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_AverageDepositBalance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_AverageDepositBalance__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductCommercialPropertyFinance}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_CommercialPropertyFinance__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_CommercialPropertyFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_CommercialPropertyFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_CommercialPropertyFinance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_CommercialPropertyFinance__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_CommercialPropertyFinance__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_CommercialPropertyFinance__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductDebt}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Debt__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Debt__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Debt__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Debt__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Debt__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Debt__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Debt__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductDeposits}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Deposits__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Deposits__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Deposits__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Deposits__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Deposits__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Deposits__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Deposits__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductEquities}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Equities__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Equities__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Equities__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Equities__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Equities__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Equities__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Equities__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductFixedIncome}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_FixedIncome__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_FixedIncome__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_FixedIncome__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_FixedIncome__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_FixedIncome__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_FixedIncome__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_FixedIncome__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductFX}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_FX__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_FX__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_FX__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_FX__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_FX__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_FX__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_FX__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductOtherMA}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_OtherMADCMECM__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_OtherMADCMECM__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_OtherMADCMECM__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_OtherMADCMECM__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_OtherMADCMECM__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_OtherMADCMECM__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_OtherMADCMECM__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductOtherRBB}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_OtherRBBWealth__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_OtherRBBWealth__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_OtherRBBWealth__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_OtherRBBWealth__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_OtherRBBWealth__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_OtherRBBWealth__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_OtherRBBWealth__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductOtherTrade}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_OtherTrade__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_OtherTrade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_OtherTrade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_OtherTrade__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_OtherTrade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_OtherTrade__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_OtherTrade__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductPassive}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Passive__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Passive__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Passive__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Passive__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Passive__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Passive__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Passive__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductPrimeServices}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_PrimeServices__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_PrimeServices__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_PrimeServices__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_PrimeServices__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_PrimeServices__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_PrimeServices__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_PrimeServices__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductPrivateEquity}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_PrivateEquity__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_PrivateEquity__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_PrivateEquity__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_PrivateEquity__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_PrivateEquity__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_PrivateEquity__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_PrivateEquity__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductTrade}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Trade__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Trade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Trade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Trade__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Trade__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Trade__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Trade__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductTransProd}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_TransactionProducts__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_TransactionProducts__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_TransactionProducts__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_TransactionProducts__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_TransactionProducts__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_TransactionProducts__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_TransactionProducts__c}" /></td>
                                                                </tr>
                                                                <!--<tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductDerivatives}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Derivatives__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Derivatives__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Derivatives__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Derivatives__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Derivatives__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Derivatives__c}" /></td>
                                                                </tr>-->
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductTreasury}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_Treasury__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_Treasury__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_Treasury__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_Treasury__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_Treasury__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_Treasury__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_Treasury__c}" /></td>
                                                                </tr>
                                                                <tr>
                                                                    <td class="label">{!$Label.lbl_RevenuesByProductWorkingCapital}</td>
                                                                    <td class="included"><apex:outputField value="{!revByProduct.rorwa_WorkingCapital__c}"/></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.H12_WorkingCapital__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.RWA_WorkingCapital__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F12_WorkingCapital__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F12P_WorkingCapital__c}" /></td>
                                                                    <td class="rev"><apex:outputField value="{!revByProduct.F24_WorkingCapital__c}" /></td>
                                                                    <td class="prob"><apex:outputField value="{!revByProduct.F24P_WorkingCapital__c}" /></td>
                                                                </tr>
                                                                <!-- Calculations -->
                                                                <tr>
                                                                    <td colspan="2">{!$Label.lbl_RevenuesByProductTotalCon}</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_H12_Contribution__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F12_Contribution__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F24_Contribution__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="2">{!$Label.lbl_RevenuesByProductTotalNonLenCon}</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_H12_Non_Lending_Contrib__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F12_Non_Lending_Contrib__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F24_Non_Lending_Contrib__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                </tr>                           
                                                                <tr>
                                                                    <td colspan="4">{!$Label.lbl_RevenuesByProductTotalConWei}</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F12_Contrib_Weighted__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F24_Contrib_Weighted__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                </tr>                                   
                                                                <tr>
                                                                    <td colspan="4">{!$Label.lbl_RevenuesByProductTotalNonLenConWei}</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F12_Non_Lendng_Contrib_Weighted__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.Tot_F24_Non_Lendng_Contrib_Weighted__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                </tr>
                                                                <tr>
                                                                    <td colspan="2">{!$Label.lbl_DerivativesLegacyTotals}</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.H12_Derivatives__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.F12_Derivatives__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                    <td class="sum"><apex:outputField value="{!revByProduct.F24_Derivatives__c}" /></td>
                                                                    <td>&nbsp;</td>
                                                                </tr>
                                                            </table>
                                                        </apex:outputPanel>
                                                    </ul>
                                                    
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <table class="table-1col">
                                    <tr>
                                       
                                        <div class="field">
                                            <div class="label">{!$Label.lbl_PricingClientRevenueHistory}</div>
                                            <apex:inputField styleClass="text-area" value="{!JLOC__c.Client_Revenue_History_and_Projections__c}" />
                                        </div>
                                        
                                    </tr>
                                </table>
                            </div>
                        </div>
                        
                        <div id="tab-3-panel">
                            <div id="tab-3-content">
                                <div>
                                   <h3>
                                       Client Projections
                                    </h3>
                                     <div>
                                        <apex:commandButton styleClass="inline-button" action="{!uploadStressCaseImage}" value="Stress Case Image" status="processing" reRender="pgMsg"/>
                                         <apex:commandButton rendered="{!!ISBLANK(JLOC__c.Stress_Case_ID__c)}" action="{!removeStressCase}" value="Remove Stress Case" status="processing" reRender="pgMsg"/>
                                        <br/><apex:image url="/servlet/servlet.FileDownload?file={!JLOC__c.Stress_Case_ID__c}" rendered="{!JLOC__c.Stress_Case_ID__c != null}" styleClass="image" />
                                    </div>
                                     <div>
                                         <apex:commandButton styleClass="inline-button" action="{!uploadBankCaseImage}" value="Bank Case Image" status="processing" reRender="pgMsg"/>
                                         <apex:commandButton rendered="{!!ISBLANK(JLOC__c.Banker_Case_ID__c)}" action="{!removeBankCase}" value="Remove Bank Case" status="processing" reRender="pgMsg"/>
                                         <br/><apex:image url="/servlet/servlet.FileDownload?file={!JLOC__c.Banker_Case_ID__c}" rendered="{!JLOC__c.Banker_Case_ID__c != null}" styleClass="image" />
                                    </div>
                                    <div>
                                        <apex:commandButton styleClass="inline-button" action="{!uploadManagementCaseImage}" value="Management Case Image" status="processing" reRender="pgMsg"/>
                                        <apex:commandButton rendered="{!!ISBLANK(JLOC__c.Management_Case_ID__c)}" action="{!removeManagementCase}" value="Remove Management Case" status="processing" reRender="pgMsg"/>
                                        <br/><apex:image url="/servlet/servlet.FileDownload?file={!JLOC__c.Management_Case_ID__c}" rendered="{!JLOC__c.Management_Case_ID__c != null}" styleClass="image" />
                                    </div>
                                        <div class="field">
                                            <label for="NotApplicable">Not Applicable</label>
                                            <apex:inputCheckbox id="NotApplicable" onclick="checkForeCast(this)"  value="{!JLOC__c.Forecast_Not_Available__c}"/>
                                            </div>
                                     <div class="field">
                                        <div class="label">Not Application Description</div>
                                        <apex:inputField styleClass="text-area" value="{!JLOC__c.Forecast_Description__c}" />
                                    </div>
                                    
                                    
                                   
                                </div>
                                <div class="warning" >
                                    <table class="table-2col">
                                        <tr>
                                            <td>
                                                
                                                <div class="header" style="color: red;">
                                                    The following fields will be directly imported from the Relationship, Opportunity and Client Plan:
                                                </div>
                                              
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <h2>
                                                    <li>Brief Client Description (source: Client Plan – Overview tab )</li>
                                                    <ul onclick="window.mypopup = window.open('ClientOverview?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                        <div class="hoverDiv">
                                                            <apex:outputField value="{!clientPlan.Client_Overview__c}"/>
                                                        </div>
                                                    </ul>
                                                </h2>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td>
                                                <li>Client Financials (source: Client Plan – Client Financials tab)</li>
                                                <ul onclick="window.mypopup = window.open('ClientFinancials?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');"><apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c != null}">
                                                    <div class="section">
                                                        <table class="grid creditstatistics hoverDiv">
                                                            <tr>
                                                                <td class="label">
                                                                    <div class="standaloneImgWrapper">
                                                                        <apex:image styleClass="standaloneImg" url="/servlet/servlet.FileDownload?file={!ClientPlan.Financial_Information_Image_ID__c}" />
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                   
                                                    </apex:outputPanel> </ul>
                                                <li>The Client Financials table below will appear in the JLOC paper in the Relationship Financials section</li>
                                                <ul class="financialstableul">
                                                    <apex:outputPanel id="CreditStatisticsInputPanel" rendered="{!!financeList.empty }" layout="none" style="overflow-y:auto;">
                                                        <table id="financialsTable" class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;">
                                                            <thead>
                                                                <tr >
                                                                    <th id="financialsTableFirstCol" scope="col"/>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <th scope="col" id="{!f.Id}">
                                                                            <span class="monthValueHeader">
                                                                                <apex:outputText value="{!f.Month__c} " rendered="{!f.Month__c != null && (f.Financial_Results__c == null || f.Financial_Results__c != 'Audited Full Year')}"/>
                                                                                <apex:outputText value="{!clientPlan.Financial_Year_End__c} " rendered="{!clientPlan.Financial_Year_End__c != null && f.Financial_Results__c != null && f.Financial_Results__c == 'Audited Full Year'}"/>
                                                                            </span>
                                                                            <span class="yearValueHeader">
                                                                                {!f.Year__c}
                                                                            </span>
                                                                            
                                                                        </th>
                                                                    </apex:repeat>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr >
                                                                    <th>
                                                                        <apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Financial_Results__c.Label}"/>
                                                                    </th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td scope="col">
                                                                            <apex:outputField value="{!f.Financial_Results__c}" rendered="{!f.Financial_Results__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat>
                                                                </tr>  
                                                                <tr >
                                                                    <th>
                                                                        <apex:outputText value="{!$Label.lbl_Turnover}"/>
                                                                    </th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td scope="col">
                                                                            <apex:outputField value="{!f.Turnover__c}" rendered="{!f.Turnover__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat>
                                                                </tr>                        
                                                                
                                                                <tr >
                                                                    <th scope="row"><apex:outputText value="{!$Label.lbl_EBITDA}"/></th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td>
                                                                            <apex:outputField value="{!f.EBITDA__c}" rendered="{!f.EBITDA__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.EBITDA_Margin__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.EBITDA_Margin__c}" rendered="{!f.EBITDA_Margin__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Net_Asset_Value__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Interest_Expense_Income__c}" rendered="{!f.Net_Interest_Expense_Income__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_NetInterestExpenseIncomeBAGLFacilitiesOnly}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Interest_Expense_BAGL_facilities__c}" rendered="{!f.Net_Interest_Expense_BAGL_facilities__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.PAT__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.PAT__c}" rendered="{!f.PAT__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr>
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_TotalAssets}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Total_Assets__c}" rendered="{!f.Total_Assets__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                
                                                                <tr>
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_TotalTangibleAssets}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Total_Tangible_Assets__c}" rendered="{!f.Total_Tangible_Assets__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Gross_Debt__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Gross_Debt__c}" rendered="{!f.Gross_Debt__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Subordinated_Shareholder_Loans__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Subordinated_Shareholder_Loans__c}" rendered="{!f.Subordinated_Shareholder_Loans__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Cash_and_cash_equivalents__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Cash_and_cash_equivalents__c}" rendered="{!f.Cash_and_cash_equivalents__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel >
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_NetDebt}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Debt__c}" rendered="{!f.Net_Debt__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_NetWorth}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Worth__c}" rendered="{!f.Net_Worth__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr>
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Tangible_Net_Worth__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Tangible_Net_Worth__c}" rendered="{!f.Tangible_Net_Worth__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Total_Liabilities__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Total_Liabilities__c}" rendered="{!f.Total_Liabilities__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr>
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_CashGeneratedByOperations}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Cash_Generated_by_Operations__c}" rendered="{!f.Cash_Generated_by_Operations__c != null}"/>
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Cash_flow_from_operating_activities_Adj__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Cash_flow_from_operating_activities_Adj__c}" rendered="{!f.Cash_flow_from_operating_activities_Adj__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Capex__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Capex__c}" rendered="{!f.Capex__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_FreeCashFlow}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Free_Cash_Flow__c}" rendered="{!f.Free_Cash_Flow__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Net_cash_generation_utilization__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_cash_generation_utilization__c}" rendered="{!f.Net_cash_generation_utilization__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.EBITDA_Net_Interest_cover__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.EBITDA_Net_Interest_cover__c}" rendered="{!f.EBITDA_Net_Interest_cover__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row">{!$Label.lbl_NetDebtEbitda}</th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Debt_Cash_Ebitda__c}" rendered="{!f.Net_Debt_Cash_Ebitda__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row">{!$Label.lbl_GrossDebtEbitda}</th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Gross_Debt_Cash_Ebitda__c}" rendered="{!f.Gross_Debt_Cash_Ebitda__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Tangible_Gearing_Net_Debt_TNW__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Tangible_Gearing_Net_Debt_TNW__c}" rendered="{!f.Tangible_Gearing_Net_Debt_TNW__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel >
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Net_Asset_Value__c.Label}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Net_Asset_Value__c}" rendered="{!f.Net_Asset_Value__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr ><apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                    <th scope="row"><apex:outputText value="{!$Label.lbl_EPS}"/></th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td>
                                                                            <apex:outputField value="{!f.EPS__c}" rendered="{!f.EPS__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat></apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_EBIT}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.EBIT__c}" rendered="{!f.EBIT__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel >
                                                                        <th scope="row"><apex:outputText value="{!$ObjectType.Financial_Information__c.fields.Market_Cap__c.Label}" /></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Market_Cap__c}" rendered="{!f.Market_Cap__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr> 
                                                                <tr ><apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                    <th scope="row"><apex:outputText value="{!$Label.lbl_ROE}"/></th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td>
                                                                            <apex:outputField value="{!f.ROE__c}" rendered="{!f.ROE__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_ROA}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.ROA__c}" rendered="{!f.ROA__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>
                                                                <tr ><apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                    <th scope="row"><apex:outputText value="{!$Label.lbl_DebtEquity}"/></th>
                                                                    <apex:repeat value="{!financeList}" var="f">
                                                                        <td>
                                                                            <apex:outputField value="{!f.Debt_Equity__c}" rendered="{!f.Debt_Equity__c != null}"/>
                                                                            
                                                                        </td>
                                                                    </apex:repeat></apex:outputPanel>
                                                                </tr>
                                                                
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_CurrentRatio}"/></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Current_Ratio__c}" rendered="{!f.Current_Ratio__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat></apex:outputPanel>
                                                                </tr>
                                                                
                                                                <tr >
                                                                    <apex:outputPanel rendered="{!ClientPlan.Financial_Information_Image_ID__c == null}">
                                                                        <th scope="row"><apex:outputText value="{!$Label.lbl_InterestCoverRatio}" /></th>
                                                                        <apex:repeat value="{!financeList}" var="f">
                                                                            <td>
                                                                                <apex:outputField value="{!f.Interest_Cover_Ratio__c}" rendered="{!f.Interest_Cover_Ratio__c != null}"/>
                                                                                
                                                                            </td>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                </tr>   
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel id="FinancialCommentary" rendered="{!(!financeList.empty||ClientPlan.Financial_Information_Image_ID__c!=null)&&(ClientPlan.FinancialCommentary__c!=NULL && ClientPlan.FinancialCommentary__c!='')}" layout="none" style="overflow-y:auto;">
                                                        <br/>
            											<table id="FinancialCommentary" class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;list-style: none">
                                                        	<tr>
                                                            	<th scope="row"><apex:outputText value="{!$ObjectType.Client_Plan__c.fields.FinancialCommentary__c.Label}"/></th>
                                                            </tr>
                                                            <td>
                                                            	<apex:outputField value="{!ClientPlan.FinancialCommentary__c}"/>
                                                            </td>
                                                        </table>
                                                    </apex:outputPanel>
                                                </ul>                                                    
                                            </td>
                                        </tr>
                            
                                        <tr>
                                            <td>
                                                <li>Other Bank Facilities (source: Client Plan – Client Financials tab)</li>
                                                <ul onclick="window.mypopup = window.open('ClientFinancials?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                    <apex:outputPanel >
                                                        <table class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;">
                                                            <thead>
                                                                <tr >
                                                                    <th scope="col">
                                                                        <span >
                                                                            <apex:outputText value="{!$ObjectType.Client_Plan_Facility__c.fields.Bank__c.Label}" />
                                                                        </span>
                                                                    </th>
                                                                    <th scope="col">
                                                                        <span >
                                                                            <apex:outputText value="{!$ObjectType.Client_Plan_Facility__c.fields.Country__c.Label}" />
                                                                        </span>
                                                                    </th>
                                                                    <th scope="col" style="display:none;">
                                                                        <span >
                                                                            <apex:outputText value="{!$ObjectType.Client_Plan_Facility__c.fields.CurrencyIsoCode.Label}" />
                                                                        </span>
                                                                    </th>                                         
                                                                    <th scope="col">
                                                                        <span >
                                                                            <apex:outputText value="{!$ObjectType.Client_Plan_Facility__c.fields.Product_Level_3__c.Label}" />
                                                                        </span>
                                                                    </th>
                                                                    <th scope="col">
                                                                        <span >
                                                                            <apex:outputText value="{!$ObjectType.Client_Plan_Facility__c.fields.Limit__c.Label}" />
                                                                        </span>
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <apex:repeat value="{!otherFacility}" var="othFac">
                                                                    <tr id="{!othFac.Id}" >
                                                                        <th scope="col">
                                                                                <apex:outputText value="{!othFac.Bank__c}" />
                                                                        </th>                                           
                                                                        <td  scope="col">
                                                                            <apex:outputText value="{!othFac.Country__c}" />
                                                                        </td >
                                                                        <td scope="col">
                                                                            <apex:outputText value="{!othFac.Product_Level_3__r.Name}" />
                                                                        </td>
                                                                        <td  style="display:none;">
                                                                            <apex:outputField value="{!othFac.CurrencyIsoCode}" />
                                                                        </td>                                                
                                                                        <td  style="display:none;">
                                                                            <apex:outputText value="{!othFac.Product_Level_3__c}" />
                                                                        </td>
                                                                        <td >
                                                                            <apex:outputField value="{!othFac.Limit__c}" />
                                                                        </td>
                                                                        
                                                                    </tr>
                                                                </apex:repeat>
                                                            </tbody>
                                                        </table>
                                                    </apex:outputPanel>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr ><td>
                                            <li>Presence (source: Client Plan – Presence tab)</li>
                                            <ul onclick="window.mypopup = window.open('ClientPresence?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                <apex:outputPanel >
                                                    <table class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;">
                                                        <thead>
                                                            <th>Country</th>
                                                            <th>{!$Label.lbl_Engaged}</th>
                                                            <th>{!$Label.lbl_PrimaryBank}</th>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!otherCountry}" var="othCountry">
                                                                <tr>
                                                                    <td>{!othCountry.Banking_Country__c}</td>
                                                                    <td>{!othCountry.Engaged__c}</td>
                                                                    <td>{!othCountry.Primary_Bank__c}</td>
                                                                </tr>
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                </apex:outputPanel>
                                            </ul>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <li>Ownership Structure (source: Client Plan – Overview tab)</li>
                                                <ul onclick="window.mypopup = window.open('ClientOverview?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                   <div class="standaloneImgWrapper hoverDiv">
                                                        <apex:image styleClass="standaloneImg" url="/servlet/servlet.FileDownload?file={!ClientPlan.Org_Structure_Image_ID__c}" rendered="{!ClientPlan.Org_Structure_Image_ID__c != null}"/>
                                                    </div>
                                                </ul>
                                            </td>
                                            
                                        </tr>
                                        <tr>
                                            <td><li>Borrower(s) (source: Client Plan – Overview tab)</li>
                                                <ul onclick="window.mypopup = window.open('ClientOverview?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                    <table class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;">
                                                        <thead>
                                                            <th>Borrowers</th>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!borrowers}" var="BR">
                                                                <tr>
                                                                    <td>{!BR.Value__c}</td>
                                                                    
                                                                </tr>
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                </ul>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td>
                                                <li>Guarantor(s) (source: Client Plan – Overview tab)</li>
                                                <ul onclick="window.mypopup = window.open('ClientOverview?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                    <table class="table-1col hoverDiv" style="border-spacing: 0;border-collapse: collapse;">
                                                        <thead>
                                                            <th>Guarantors</th>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!guarantors}" var="BR">
                                                                <tr>
                                                                    <td>{!BR.Value__c}</td>
                                                                </tr>
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                </ul>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div id="tab-4-panel">
                            <div id="tab-4-content">
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Key_Risks__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Key_Risks__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Key_Mitigants__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Key_Mitigants__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.ReputationalMatters__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.ReputationalMatters__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        
                        <div id="tab-5-panel">
                            <div id="tab-5-content">
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Syndicate__c.Label}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Syndicate__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        
                        <div id="tab-6-panel">
                            <div id="tab-6-content">
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="General Questionnaire"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Deal_Presented_To_Deal_Forum__c}" />
                                            
                                            <td>1. {!$Label.lbl_DealPresentedToDealForum}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Deal_Presented_To_Deal_Forum__c}">
                                                    <input name="Deal_Presented_To_Deal_Forum__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Deal_Presented_To_Deal_Forum__c}">
                                                    <input name="Deal_Presented_To_Deal_Forum__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Deal_Presented_To_Deal_Forum__c}">
                                                    <input name="Deal_Presented_To_Deal_Forum__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Deal_Presented_To_Deal_Forum__c}">
                                                    <input name="Deal_Presented_To_Deal_Forum__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Go_Approval_From_Deal_Forum_Quorum__c}" />
                                            
                                            <td>2. {!$Label.lbl_GoApprovalFromDealForumQuorum}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Go_Approval_From_Deal_Forum_Quorum__c}">
                                                    <input name="Go_Approval_From_Deal_Forum_Quorum__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Go_Approval_From_Deal_Forum_Quorum__c}">
                                                    <input name="Go_Approval_From_Deal_Forum_Quorum__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Go_Approval_From_Deal_Forum_Quorum__c}">
                                                    <input name="Go_Approval_From_Deal_Forum_Quorum__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Go_Approval_From_Deal_Forum_Quorum__c}">
                                                    <input name="Go_Approval_From_Deal_Forum_Quorum__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Approved_By_Financial_Crime_Compliance__c}" />
                                            
                                            <td>3. {!$Label.lbl_ApprovedByFinancialCrimeCompliance}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Approved_By_Financial_Crime_Compliance__c}">
                                                    <input name="Approved_By_Financial_Crime_Compliance__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Approved_By_Financial_Crime_Compliance__c}">
                                                    <input name="Approved_By_Financial_Crime_Compliance__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Approved_By_Financial_Crime_Compliance__c}">
                                                    <input name="Approved_By_Financial_Crime_Compliance__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Approved_By_Financial_Crime_Compliance__c}">
                                                    <input name="Approved_By_Financial_Crime_Compliance__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Deal_Cleared_For_Conflicts__c}" />
                                            
                                            <td>4. {!$Label.lbl_DealClearedForConflicts}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Deal_Cleared_For_Conflicts__c}">
                                                    <input name="Deal_Cleared_For_Conflicts__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Deal_Cleared_For_Conflicts__c}">
                                                    <input name="Deal_Cleared_For_Conflicts__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Deal_Cleared_For_Conflicts__c}">
                                                    <input name="Deal_Cleared_For_Conflicts__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Deal_Cleared_For_Conflicts__c}">
                                                    <input name="Deal_Cleared_For_Conflicts__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Affected_of_Exchange_Control_Regulation__c}" />
                                            
                                            <td>5. {!$Label.lbl_AffectedExchangeControlRegulation}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Affected_of_Exchange_Control_Regulation__c}">
                                                    <input name="Affected_of_Exchange_Control_Regulation__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Affected_of_Exchange_Control_Regulation__c}">
                                                    <input name="Affected_of_Exchange_Control_Regulation__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Affected_of_Exchange_Control_Regulation__c}">
                                                    <input name="Affected_of_Exchange_Control_Regulation__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Affected_of_Exchange_Control_Regulation__c}">
                                                    <input name="Affected_of_Exchange_Control_Regulation__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Securitized_Assets_Liquidity_Facility__c}" />
                                            
                                            <td>6. {!$Label.lbl_SecuritizedAssetsLiquidityFacility}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Securitized_Assets_Liquidity_Facility__c}">
                                                    <input name="Securitized_Assets_Liquidity_Facility__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Securitized_Assets_Liquidity_Facility__c}">
                                                    <input name="Securitized_Assets_Liquidity_Facility__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Securitized_Assets_Liquidity_Facility__c}">
                                                    <input name="Securitized_Assets_Liquidity_Facility__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Securitized_Assets_Liquidity_Facility__c}">
                                                    <input name="Securitized_Assets_Liquidity_Facility__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Absa_Hold_5_of_the_Net_Economic_Value__c}" />
                                            
                                            <td>a. {!$Label.lbl_AbsaHold5NetEconomicValue}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Absa_Hold_5_of_the_Net_Economic_Value__c}">
                                                    <input name="Absa_Hold_5_of_the_Net_Economic_Value__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Absa_Hold_5_of_the_Net_Economic_Value__c}">
                                                    <input name="Absa_Hold_5_of_the_Net_Economic_Value__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Absa_Hold_5_of_the_Net_Economic_Value__c}">
                                                    <input name="Absa_Hold_5_of_the_Net_Economic_Value__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Absa_Hold_5_of_the_Net_Economic_Value__c}">
                                                    <input name="Absa_Hold_5_of_the_Net_Economic_Value__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Transferee_Options_Discussed__c}" />
                                            <td>
                                                <div>7. {!$Label.lbl_TransfereeOptionsDiscussed}</div>
                                                <div>a. {!$Label.lbl_ProvideDetailsUnderBriefClient}</div>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Transferee_Options_Discussed__c}">
                                                    <input name="Transferee_Options_Discussed__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Transferee_Options_Discussed__c}">
                                                    <input name="Transferee_Options_Discussed__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Transferee_Options_Discussed__c}">
                                                    <input name="Transferee_Options_Discussed__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Transferee_Options_Discussed__c}">
                                                    <input name="Transferee_Options_Discussed__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="Ancillary Opportunities"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Discussed_with_RM_re_FX_IRD_other_op__c}" />
                                            
                                            <td>1. {!$Label.lbl_DiscussedWithRM_FX_IRD_other}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_RM_re_FX_IRD_other_op__c}">
                                                    <input name="Discussed_with_RM_re_FX_IRD_other_op__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_RM_re_FX_IRD_other_op__c}">
                                                    <input name="Discussed_with_RM_re_FX_IRD_other_op__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_RM_re_FX_IRD_other_op__c}">
                                                    <input name="Discussed_with_RM_re_FX_IRD_other_op__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_RM_re_FX_IRD_other_op__c}">
                                                    <input name="Discussed_with_RM_re_FX_IRD_other_op__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Discussed_with_BBT_re_operating_product__c}" />
                                            
                                            <td>2. {!$Label.lbl_DiscussedWithBBTOperatingProduct}</td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_BBT_re_operating_product__c}">
                                                    <input name="Discussed_with_BBT_re_operating_product__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_BBT_re_operating_product__c}">
                                                    <input name="Discussed_with_BBT_re_operating_product__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_BBT_re_operating_product__c}">
                                                    <input name="Discussed_with_BBT_re_operating_product__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_BBT_re_operating_product__c}">
                                                    <input name="Discussed_with_BBT_re_operating_product__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Sub_investment_grade_credit__c}" />
                                            
                                            <td>3. {!$Label.lbl_SubInvestmentGradeCredit}</td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Sub_investment_grade_credit__c}">
                                                    <input name="Sub_investment_grade_credit__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Sub_investment_grade_credit__c}">
                                                    <input name="Sub_investment_grade_credit__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Sub_investment_grade_credit__c}">
                                                    <input name="Sub_investment_grade_credit__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Sub_investment_grade_credit__c}">
                                                    <input name="Sub_investment_grade_credit__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="If syndication is applicable"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Market_to_bookrun_this_facility__c}" />
                                            
                                            <td>1. {!$Label.lbl_MarketToBookrun_Facility}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Market_to_bookrun_this_facility__c}">
                                                    <input name="Market_to_bookrun_this_facility__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Market_to_bookrun_this_facility__c}">
                                                    <input name="Market_to_bookrun_this_facility__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Market_to_bookrun_this_facility__c}">
                                                    <input name="Market_to_bookrun_this_facility__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Market_to_bookrun_this_facility__c}">
                                                    <input name="Market_to_bookrun_this_facility__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Syn_team_advised_on_Facility_Syndicati__c}" />
                                            
                                            <td>2. {!$Label.lbl_SynTeamAdvisedFacilitySyndicati}</td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Syn_team_advised_on_Facility_Syndicati__c}">
                                                    <input name="Syn_team_advised_on_Facility_Syndicati__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Syn_team_advised_on_Facility_Syndicati__c}">
                                                    <input name="Syn_team_advised_on_Facility_Syndicati__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td>
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Syn_team_advised_on_Facility_Syndicati__c}">
                                                    <input name="Syn_team_advised_on_Facility_Syndicati__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Syn_team_advised_on_Facility_Syndicati__c}">
                                                    <input name="Syn_team_advised_on_Facility_Syndicati__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="Regulatory"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Volcker_Rule_Guidance_Document_Completed__c}" />
                                            
                                            <td>1. {!$Label.lbl_VolckerRuleGuidanceDocumentCompleted}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Volcker_Rule_Guidance_Document_Completed__c}">
                                                    <input name="Volcker_Rule_Guidance_Document_Completed__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Volcker_Rule_Guidance_Document_Completed__c}">
                                                    <input name="Volcker_Rule_Guidance_Document_Completed__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Volcker_Rule_Guidance_Document_Completed__c}">
                                                    <input name="Volcker_Rule_Guidance_Document_Completed__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Volcker_Rule_Guidance_Document_Completed__c}">
                                                    <input name="Volcker_Rule_Guidance_Document_Completed__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="Credit"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Discussed_with_Credit__c}" />
                                            
                                            <td>1. {!$Label.lbl_DiscussedWithCredit}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_Credit__c}">
                                                    <input name="Discussed_with_Credit__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_Credit__c}">
                                                    <input name="Discussed_with_Credit__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Discussed_with_Credit__c}">
                                                    <input name="Discussed_with_Credit__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Discussed_with_Credit__c}">
                                                    <input name="Discussed_with_Credit__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                {!$ObjectType.JLOC__c.fields.Credit_Appetite_Comment__c.Label}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <apex:inputField value="{!JLOC__c.Credit_Appetite_Comment__c}"/>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view radiosTable">
                                    <caption class="label"><apex:outputText value="Booking"/></caption>
                                    <tbody>
                                        <tr>
                                            <apex:inputHidden value="{!JLOC__c.Asset_Hub_Framework_considered__c}" />
                                            
                                            <td>1. {!$Label.lbl_AssetHubFrameworkConsidered}</td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Asset_Hub_Framework_considered__c}">
                                                    <input name="Asset_Hub_Framework_considered__c" type="radio" value="true" checked="checked"/> Yes
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Asset_Hub_Framework_considered__c}">
                                                    <input name="Asset_Hub_Framework_considered__c" type="radio" value="true"/> Yes
                                                </apex:outputPanel>
                                            </td>
                                            <td class="width10">
                                                <apex:outputPanel layout="none" rendered="{!JLOC__c.Asset_Hub_Framework_considered__c}">
                                                    <input name="Asset_Hub_Framework_considered__c" type="radio" value="false"/> No
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!!JLOC__c.Asset_Hub_Framework_considered__c}">
                                                    <input name="Asset_Hub_Framework_considered__c" type="radio" value="false" checked="checked"/> No
                                                </apex:outputPanel>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                {!$ObjectType.JLOC__c.fields.Asset_Hub_Comment__c.Label}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="3">
                                                <apex:inputField value="{!JLOC__c.Asset_Hub_Comment__c}"/>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br/>
                                <table class="grid-view">
                                    <caption class="label">{!$Label.lbl_DealTeam}</caption>
                                    <tr>
                                        <th>Opportunity</th>
                                        <th>User Name</th>
                                        <th>Team Role</th>
                                    </tr>
                                    <apex:repeat value="{!teamMembers}" var="member">
                                        <tr>
                                            <td><apex:outputField value="{!member.Opportunity.Name}"/></td>
                                            <td><apex:outputField value="{!member.User.Name}"/></td>
                                            <td><apex:outputField value="{!member.TeamMemberRole}"/></td>
                                        </tr>
                                    </apex:repeat>
                                </table>
                                <div class="field">
                                    <apex:inputField value="{!JLOC__c.Deal_Team_Polices_Confirmation__c}"/>
                                    <span>{!$Label.lbl_DealTeamPolicesConfirmation}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div id="tab-7-panel">
                            <div id="tab-7-content">
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Pricing_and_Returns__c.Label}</div>
                                                <div>
                                                    <apex:commandButton id="upload-image" styleClass="inline-button" action="{!uploadPricingAndReturnsDocument}" value="Upload Document" status="processing" reRender="pgMsg"/>
                                                    <apex:commandButton id="delete-image" styleClass="inline-button" action="{!removePricingAndReturnsDocument}" value="Delete Document" status="processing" rendered="{!JLOC__c.Pricing_and_Returns_Document_ID__c != null}" reRender="pgMsg"/>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <apex:image url="/servlet/servlet.FileDownload?file={!JLOC__c.Pricing_and_Returns_Document_ID__c}" rendered="{!JLOC__c.Pricing_and_Returns_Document_ID__c != null}" styleClass="image" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$ObjectType.JLOC__c.fields.Pricing_Justification__c.Label}</div>
                                                <apex:inputField value="{!JLOC__c.Pricing_Justification__c}" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <table class="table-3col">
                                    <caption class="label">{!$Label.lbl_KeyCreditPrudentialGuidelines}</caption>
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_MandateAndScale}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Guidelines_Mandate_and_Scale__c}" />
                                                <div class="help">{!$Label.hlp_MandateAndScale}</div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_CLGD}</div>                                                
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Guidelines_CLGD__c}" />
                                                <div class="help">{!$Label.hlp_CLGD}</div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_MEG}</div>
                                                <apex:inputField styleClass="text-area" value="{!JLOC__c.Guidelines_MEG__c}" />
                                                <div class="help">{!$Label.hlp_MEG}</div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="field">
                                                <div class="label">{!$Label.lbl_AncillaryCalculation}</div>
                                                <div>
                                                    <apex:commandButton id="upload-image2" styleClass="inline-button" action="{!uploadAncillaryCalculationDocument}" value="{!$Label.lbl_AncillaryCalculationUpload}" status="processing" reRender="pgMsg"/>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div>
                                                <apex:image url="/servlet/servlet.FileDownload?file={!JLOC__c.Ancillary_Calculation_Document_ID__c}" rendered="{!JLOC__c.Ancillary_Calculation_Document_ID__c != null}" styleClass="image" />
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                                <table class="table-1col">
                                    <tr>
                                        <td>
                                            <div class="warning">
                                                <div class="header">
                                                    The following fields will be directly imported from the Relationship, Opportunity and Client Plan:
                                                </div>
                                                <div class="field">
                                                    <ul>
                                                        <li>{!$ObjectType.Client_Plan_Security__c.fields.Security_Description__c.Label}</li>
                                                        <ul onclick="window.mypopup = window.open('ClientFinancials?planId={!clientPlan.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                            <apex:outputPanel rendered="{!!absaSecurity.empty}">
                                                                <table class="grid-view">
                                                                    <tr class="smaller-row-font">
                                                                        <th>{!$ObjectType.Client_Plan_Security__c.fields.Security_Description__c.Label}</th>
                                                                        <th>{!$ObjectType.Client_Plan_Security__c.fields.Value__c.Label}</th>
                                                                    </tr>
                                                                    
                                                                    <apex:repeat value="{!absaSecurity}" var="absSec">
                                                                        <tr>
                                                                            <td width="90%">
                                                                                 <apex:outputField value="{!absSec.Security_Description__c}"/>   
                                                                            </td>
                                                                            <td>
                                                                                <apex:outputField value="{!absSec.Value__c}" />
                                                                            </td>
                                                                        </tr>
                                                                    </apex:repeat>
                                                                </table>
                                                            </apex:outputPanel>
                                                        </ul>
                                                        <li>{!$Label.lbl_ListOpenOpportunities}</li>
                                                        <ul>
                                                            <apex:outputPanel id="OppTablePanel" layout="block" rendered="{!SelectedOpportunities.size>0}">          
                                                                <table class="grid-view">
                                                                    <thead>
                                                                        <tr >
                                                                            <th>{!$ObjectType.Opportunity.fields.Name.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.Total_Balance_Facility_Size__c.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.OwnerId.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.CloseDate.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.Probability.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.Annualised_Income__c.Label}</th>
                                                                            <th>{!$ObjectType.Opportunity.fields.StageName.Label}</th>
                                                                        </tr>
                                                                        
                                                                    </thead> 
                                                                    <tbody>
                                                                        <apex:repeat value="{!SelectedOpportunities}" var="opty">
                                                                            <tr onclick="window.mypopup = window.open('/{!opty.Id}','Popup','height=400,width=1000,left=100,top=100,scrollbars=yes,toolbar=no,status=no');">
                                                                                <td>
                                                                                    <apex:outputField value="{!opty.Name}" />
                                                                                </td>
                                                                                <td>
                                                                                    <apex:outputField value="{!opty.Total_Balance_Facility_Size__c}" />
                                                                                </td>                            
                                                                                <td>
                                                                                    <apex:outputField value="{!opty.Owner.Name}" />
                                                                                </td>
                                                                                <td>
                                                                                    <apex:outputText value="{0, date, dd/MM/yyyy}">
                                                                                        <apex:param value="{!opty.CloseDate}" /> 
                                                                                    </apex:outputText>
                                                                                </td>
                                                                                <td>
                                                                                    <apex:outputText value="{!opty.Probability}%" />
                                                                                </td>                            
                                                                                <td>
                                                                                    <apex:outputField value="{!opty.Annualised_Income__c}" />
                                                                                </td>                            
                                                                                <td>
                                                                                    <apex:outputField value="{!opty.StageName}" />
                                                                                </td> 
                                                                            </tr>
                                                                        </apex:repeat>
                                                                    </tbody>
                                                                </table> 
                                                            </apex:outputPanel>
                                                        </ul>
                                                    </ul>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        
                        <div id="tab-8-panel">
                            <div id="tab-8-content">
                                <apex:outputPanel id="attachments-table">
                                    <table class="grid-view">
                                        <caption class="label">Misc. Attachments (not part of other data points)</caption>
                                        <tr>
                                            <th>Action</th>
                                            <th>Name</th>
                                            <th>Type</th>
                                        </tr>
                                        <apex:repeat value="{!attachments}" var="attach">
                                            <tr>
                                                <td>
                                                    <apex:commandLink value="Delete" onclick="if(!confirm('Are you sure?')){return false;}" action="{!deleteAttachment}" status="processing" rerender="attachments-table">
                                                        <apex:param name="attachId" value="{!attach.Id}" assignTo="{!attachIdToDelete}"/>  
                                                    </apex:commandLink>
                                                </td>
                                                <td>
                                                    <apex:outputLink value="/servlet/servlet.FileDownload?file={!attach.Id}" target="_blank">{!attach.Name}</apex:outputLink>
                                                </td>
                                                <td>
                                                    <apex:outputField value="{!attach.ContentType}" />
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </table>
                                </apex:outputPanel>
                                <apex:commandButton styleClass="inline-button" action="{!addAttachment}" status="processing" value="Add Attachment" reRender="attachments-panel" />
                            </div>
                        </div>
                        
                        <div id="tab-9-panel">
                            <div id="tab-9-content">
                                <apex:outputPanel id="linkedopps">
                                    <div class="field">
                                        <span class="label" data-tooltip="{!$ObjectType.JLOC__c.fields.Is_this_a_closed_JLOC__c.inlineHelpText}">
                                            {!$ObjectType.JLOC__c.fields.Is_this_a_closed_JLOC__c.Label}
                                        </span>
                                    	<apex:inputCheckbox value="{!JLOC__c.Is_this_a_closed_JLOC__c}" />
                                    </div>
                                    <apex:pageBlockTable value="{!opportunityItems}" var="item" rendered="{!NOT(isOpportunityListEmpty)}">
                                        <apex:column >
                                            <apex:inputCheckbox value="{!item.isSelected}" disabled="{!!item.isSelectable}" />
                                        </apex:column>
                                        <apex:column value="{!item.opportunity.Name}"/>
                                        <apex:column value="{!item.opportunity.Related_Group_Client__c}"/>
                                        <apex:column value="{!item.opportunity.StageName}"/>
                                        <apex:column value="{!item.opportunity.CloseDate}"/>
                                        <apex:column headerValue="JLOC" value="{!item.opportunity.JLOC__c}"/>
                                        <apex:facet name="footer">
                                            <i>{!$Label.lbl_OpportunitiesLvl3Eligible}</i>
                                        </apex:facet>
                                    </apex:pageBlockTable>
                            	</apex:outputPanel>
                            </div>
                        </div>
                    </div>
                </div>
            </apex:outputPanel>
        </apex:pageBlock>
    </apex:form>
</apex:page>