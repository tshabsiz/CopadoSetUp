<!--
 _____ _                 _ _____           _ _   _         
/  __ \ |               | /  ___|         (_) | | |        
| /  \/ | ___  _   _  __| \ `--. _ __ ___  _| |_| |__  ___ 
| |   | |/ _ \| | | |/ _` |`--. \ '_ ` _ \| | __| '_ \/ __|
| \__/\ | (_) | |_| | (_| /\__/ / | | | | | | |_| | | \__ \
 \____/_|\___/ \__,_|\__,_\____/|_| |_| |_|_|\__|_| |_|___/
 
 *** CHANGE LOG ***
 
 20/06/2017 - PG    - Added Condition Monitored By to deal parties view.
 28/08/2017 - PG    - Changes the page message not escape messages.
 05/02/2018 - TdB   - Change Product functionality to use 3 the 3 new TMG Product Objects
                                                           
-->
<apex:page controller="Matter_AgreementTemplate" tabStyle="advpm__Matter__c" action="{!actionLoadValidation}"> 
    
    <!-- CUSTOM CSS -->
    <style type="text/css">
    .pageDescription {
        white-space: nowrap
    }
    </style>
    <!-- / CUSTOM CSS -->
    
    <!-- PAGE HEADER -->
    <apex:sectionHeader title="Deal Agreements" subtitle="Step 1 - Select Agreements for Product: {!matter.TMG_Product_Level_3__r.Name}" />
    
    <!-- FORM -->
    <apex:form >
    
        <!-- PAGE ERRORS -->
        <apex:pageMessages escape="false" />
        
        <!-- PAGE BLOCK-->
        <apex:pageBlock title="Agreement Templates" rendered="{!NOT(pageHasError)}" mode="detail">
            
            <apex:pageBlockButtons location="top">
                <apex:commandButton value="Create and Add Agreements" action="{!actionCreateAgreements}"/>
                <apex:commandButton value="Cancel" action="{!actionCancel}"/>
            </apex:pageBlockButtons>
            
            <!-- PAGE BLOCK SECTION - AGREEMENTS -->
            <apex:pageBlockSection title="Available Agreement Templates" columns="1" collapsible="false">
                
                <!-- PAGE TABLE -->
                <apex:pageBlockTable value="{!productAgreementsWrapper}" var="wrapperItem">
                    <apex:column >
                        <apex:facet name="header">Select</apex:facet>
                        <apex:inputCheckbox value="{!wrapperItem.selected}" />
                    </apex:column>
                    <apex:column value="{!wrapperItem.record.Agreement_Template__r.Name}">
                        <apex:facet name="header">Agreement Name</apex:facet>
                    </apex:column>
                    <apex:column value="{!wrapperItem.record.Agreement_Template__r.Description__c}">
                        <apex:facet name="header">Description</apex:facet>
                    </apex:column>
                </apex:pageBlockTable>
                <!-- / PAGE TABLE -->
            
            </apex:pageBlockSection>
            <!-- / PAGE BLOCK SECTION -->
            
            <!-- PAGE BLOCK SECTION - DEAL PARTIES -->
            <apex:pageBlockSection title="Deal Parties - Select parties to be included on agreements." columns="1" collapsible="false">
                
                <!-- PAGE TABLE -->
                <apex:pageBlockTable value="{!dealPartiesWrapper}" var="wrapperItem">
                    <apex:column >
                        <apex:facet name="header">Select</apex:facet>
                        <apex:inputCheckbox value="{!wrapperItem.selected}" />
                    </apex:column>
                    <apex:column value="{!wrapperItem.record.Relationship__c}">
                        <apex:facet name="header">Party Relationship Name</apex:facet>
                    </apex:column>
                    <apex:column value="{!wrapperItem.record.Conditions_Monitored_By__c}">
                        <apex:facet name="header">Conditions Monitored By</apex:facet>
                    </apex:column>
                    <apex:column value="{!wrapperItem.record.Party_Type__c}">
                        <apex:facet name="header">Party Type</apex:facet>
                    </apex:column>
                </apex:pageBlockTable>
                <!-- / PAGE TABLE -->
            
            </apex:pageBlockSection>
            <!-- / PAGE BLOCK SECTION -->
        
        </apex:pageBlock>
        <!-- / PAGE BLOCK-->
    
    </apex:form>
    <!-- / FORM -->

</apex:page>