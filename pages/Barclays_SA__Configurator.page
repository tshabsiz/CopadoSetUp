<apex:page cache="false" standardController="Barclays_SA__MobileAppConfig__c" extensions="Barclays_SA.AppConfigController,Barclays_SA.App_Config_Controller_JS" showHeader="false" standardStylesheets="false" action="{!init}">
    <html>
        <head>
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'vendor/jQuery')}"/>
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'vendor/jQueryUI')}"/> 
            <apex:stylesheet value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'vendor/jquery2/css/start/jquery-ui-1.8.21.custom.css')}"/>
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'js/jPickerJs')}"/>
            <script type="text/javascript">jQuery.fn.jPicker.defaults.images.clientPath = "{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'images/images')}/";</script>
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'js/appJs')}"/>      
            <apex:stylesheet value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'css/jPickerCss.css')}" />
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'js/jNumeric')}" />
            <apex:includeScript value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'js/nicescroll.js')}" />
            <apex:stylesheet value="{!URLFOR($Resource.Barclays_SA__DSA_Assets, 'css/pageCss.css')}" />
            <style type="text/css">    
                body {
                    background-color: #444444;
                    background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}'); 
                }

                #tree, #tree ul, #tree li {
                    margin: 0;
                    padding: 0;
                    list-style: none;
                    font-family: helvetica;
                }
                
                #tree ul {
                    display: none;
                }
                
                #tree li {
                    line-height: 200%;
                    position: relative;
                    width: 100%;
                    cursor: pointer;
                    float: left;
                }
                
                #tree li.child {
                    margin-left: 30px;
                }
                
                #tree div {
                    height: 30px;
                    line-height: 30px;
                }
                
                div.has-kids {
                    background: lightblue;
                }
                
                div.has-kids:hover {
                    background: beige;
                }
                
                span.delete-item {
                    margin-right: 15px;
                }
                
                div.no-kids span.tree-item {
                    margin-left: 32.5px;
                }
                
                span.icon {
                    float: left;
                    font-weight: bold;
                    display: block;
                    width: 20px;
                    height: 20px;
                    line-height: 20px;
                    border: 1px solid #A0A0A0;
                    text-align: center;
                    color: #A0A0A0;
                    margin-top: 4px;
                    margin-left: 5px;
                }
                
                span.icon:hover {
                    border: 1px solid red;
                    color: red;
                }
                
                span.tree-item {
                    margin-left: 5px;
                }
                
                div.no-kids:hover {
                    background: #00FFFF;
                }
                
                .active-item {
                    text-decoration: underline;
                }

                .pbBody {
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}) !important;
                }
                
                .sub-tab-style{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}) !important;
                 }
                
                
                .customTabHeader {
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/Gray_Rectangle.png')}) !important;
                    color: #000000;
                    width: 150px;
                    height: 48px;
                    cursor: pointer;
                    padding:0px 0px 6px 0px;
                }
                 .customTabHeader.BGactive {
                    background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/Gray.png')}) !important; 
                    color: #ffffff;
                    width: 150px;
                    height: 48px;
                    padding:0px 0px 6px 0px;
                }
                
                .customTabHeaderInner {
                    margin-top: -3px;
                    margin-left: 20px;
                    margin-right: auto;
                    padding-right: 10px;
                }
               
                .colorsTab{
                width:76px;
                height:26px;
                
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Colors-Off.png')}) !important;
                    background-repeat:no-repeat;
                
                }
                .colorsTab.active{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Colors-On.png')}) !important;
                 width:76px;
                height:26px;
                background-repeat:no-repeat;
                
                }
                .brandTab{
                width:74px;
                height:28px;
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Brand-Off.png')}) !important;
                    
                background-repeat:no-repeat;
                }
                .brandTab.active{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Brand-On-.png')}) !important;
                
                width:74px;
                height:28px;
                background-repeat:no-repeat;
                }
                
                .buttonsTab{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Buttons-Off.png')}) !important;
                  width:89px;
                height:24px;
                background-repeat:no-repeat;
                }
                .buttonsTab.active{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Buttons-On.png')}) !important;
                  width:89px;
                height:24px;
                background-repeat:no-repeat;
                }
                
                
                .categoriesTab{
                width:114px;
                height:27px;
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Categories-Off.png')}) !important;
                
                background-repeat:no-repeat;
                }
                  
                
                .categoriesTab.active{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Categories-On.png')}) !important;
              
                width:114px;
                height:27px;
                background-repeat:no-repeat;
                
                }
                
                .settingTab{
                width:95px;
                height:29px;
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Settings-Off.png')}) !important;
                background-repeat:no-repeat;
                
                }
              
                
                .settingTab.active{
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_newtabs/Settings-On.png')}) !important;
                  width:95px;
                height:29px;
                background-repeat:no-repeat;
                
                }
               
                 
                 .vertical_image{
                
                background-image:url({!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/Vertical-Rule.png')});
                width:2px;height:100%;
                background-repeat:no-repeat;
                 }
                
                .user-panel-table { border-radius:0; }
                .user-panel {  
                border-bottom: 1px solid #5D9207;
                margin: 12px 0 10px 10px !important;
        
                }
                
                .user-panel-title-text {
            
                background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/title_circle.png')}'), url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}'); 
                background-size:19px 16px, 12px 12px;           
                background-repeat: no-repeat, repeat;
                background-position: top left, left top;
                }
                .circular_pointer{
                height:8px;
                width:8px;
                border-radius:8px;
                background-image: linear-gradient(right bottom, #5D9207 18%);
                background-image: -o-linear-gradient(right bottom, #5D9207 18%);
                background-image: -moz-linear-gradient(right bottom, #5D9207 18%);
                background-image: -webkit-linear-gradient(right bottom, #5D9207 18%);
                background-image: -ms-linear-gradient(right bottom, #5D9207 18%);
                
                background-image: -webkit-gradient(
                    linear,
                    right bottom,
                    left top,
                    color-stop(0.18, #5D9207)
                );
                }
                .user-panel-content { border-radius:0;
                background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}');
                color:#ffffff;
                font-size:11px;
                }
                .user-panel-content-ctree { border-radius:0;
                background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}'); 
                color:#000000;
                font-size:11px;
                }
                .activeTab {
                    background-color:#ffffff;
                    border-color:#ffffff !important;
                    padding:3px 7px 7px;
                    background-repeat: no-repeat;
                    color:#ffffff;
                    border-radius:0px !important;
                    height:51px;
                    width:80px;
                    min-width: 100px;
                    background-image:url({!URLFOR($Resource.DSA_Assets, 'images/tab_v6/BlueTab_120.png')}) !important;
                }
                .inactiveTab {
                    background-color: #ffffff;
                    background-repeat: no-repeat;
                    padding: 3px 7px 7px;
                    border-radius:0px !important;
                    color: #000000;
                    min-width: 100px;
                    height: 50px;
                    width: 80px;
                    background-image:url({!URLFOR($Resource.DSA_Assets, 'images/tab_v6/GreyTab_120.png')}) !important;
                }
                .activeWhite {
                    color: #5d9207;
                    font-size:16px;
                    font-weight:bold;
                    border-width: 1px;
                    padding: 8px;
                    min-width: 117px;
                }
                .inactiveWhite {
                    color: #5E5E5F;
                   font-size:16px;
                    border-width: 1px;
                    padding: 8px;
                    min-width: 117px;
                }
                
                .scrollSelectList {
                    overflow-x:hidden;overflow-y:auto;
                }
                
                .scroll-left-div {
                 overflow:auto;
                }
               .scroll-right-div{
               overflow-x:hidden;overflow-y:auto;
               }
               
               .tmp_report_an_issue {
                   width: 218px;
               }
               
                .jPicker {
                    z-index:2000 !important;
                }
                
              .compositor-portrait {
                    background-color:   #d2d2d2;
                    width:          480px;
                    height:         640px;
                    overflow:       hidden;
                    position:       relative;
                }                
            </style>
            
            <!-- Used to clear out Drafts when user closes window/tab without saving -->
            <script type="text/javascript" >
                window.onbeforeunload = unloadPage;
                function unloadPage(){
                    if(doCleanup) {
                        browserClose();
                    }
                }
            </script>

            <script type="text/javascript">
             
                var remotingPrefix = '{!packageNamespace}';
                var packagePrefix  = remotingPrefix + '__';
                if(remotingPrefix=='') {   // special handling for unmanaged package
                    remotingPrefix='NoNS'; // dummy namespace
                    window[remotingPrefix] = {};
                    window[remotingPrefix].App_Config_Controller_JS = App_Config_Controller_JS;
                    packagePrefix = '';
                }

                var doCleanup = true;
                jQuery.noConflict();

                function setupTree(nodes, fromScratch) {
                    var $tree = jQuery('ul#tree');
                    if(fromScratch) {
                        $tree.empty();   
                        jQuery('select#selectParentCategory').empty();
                    }    
                    
                    var numAdded = 0;
                    var i = 0;

                    var numAddedLastTimeThrough = -1;
                    while(numAdded < nodes.length) {
                        //don't let it run forever
/*                        if(numAddedLastTimeThrough == numAdded && i == 0) {
                            numAdded = nodes.length;
                        }*/
                        if(addItem(nodes[i])) {
                            numAdded++;
                        }
                        
                        i = ++i % nodes.length;   
                        if(i == 0)
                            numAddedLastTimeThrough = numAdded;
                    }
                    
                    $tree.find('div').unbind().click(function(event) {
                        event.stopPropagation();
                        var $that   = jQuery(this);
                        var $parent = jQuery(this).parent();
                        
                        jQuery('.active-item').removeClass('active-item');
                        $that.addClass('active-item');
                        
                        selectCategoryAndCMC($that.attr('cmc'), $that.attr('cat'));                       
                        return false;
                    });  
                    
                    $tree.find('span.exp-coll').click(function(event) {
                        event.stopPropagation();
                        var $kids = jQuery(this).parent().next('ul');
                        if($kids.length) {
                            $kids.toggle();
                            toggleText(jQuery(this), '+', '-');
                        }
                        return false;
                    });
                
                    $tree.find('span.delete-item').click(function(event) {
                        event.stopPropagation();
                        if(confirm('Are you sure you want to remove this category?')) {
                          var recId = jQuery(this).parent().attr('cat');
                            console.log('Aaron Debug category' + recId);
                            jQuery(this).parent().parent().remove();
                            if(recId) {
                                deleteSubCategoryById(recId);
                                jQuery("#tabHeader_4").trigger('click');
                            }
                        }
                        
                        return false;
                    });      
                }
                
                function toggleText($ele, text1, text2) {
                    if($ele.text() === text1) {
                        $ele.text(text2);
                    } else {
                        $ele.text(text1);
                    }
                }
                
                function addItem(item) {
                    if(item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__c']) {
                        return addChild(item);
                    } else {
                        return addParent(item);
                    }
                }
                
                function addParent(item) {
                    var $tree = jQuery('ul#tree');

                    if($tree.find('div[cat="' + item[packagePrefix + 'CategoryId__c'] + '"]').length === 0) {
                        $tree.append(getItemMarkup(item, 'parent', true));
                        jQuery('select#selectParentCategory').append(getOptionMarkup(item));
                        return true;
                    }
                    
                    return false;
                }
                
                function getItemMarkup(item, additionalClasses, topLevel) {
                    //Removing Sub-category delete for now: DE546
                    //var deletable = !topLevel ? '<span class="icon delete-item">X</span>' : '';
                    var deletable = '';
                    return '<li class="' + additionalClasses + '">' +
                               '<div class="no-kids" cmc="' + item.Id + '" cat="' + item[packagePrefix + 'CategoryId__c'] + '">' +
                                   deletable +
                                   '<span class="tree-item">' + item[packagePrefix + 'CategoryId__r'].Name + '</span>' +
                               '</div>' +
                           '</li>';    
                }
                
                function getOptionMarkup(item) {
                    var parent = '';
                    if(item[packagePrefix + 'CategoryId__r'] && 
                       item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__r'] && 
                       item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__r'].Name) {
                    
                        parent = ' (Parent: ' + item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__r'].Name + ')';
                    }
                                  
                    return '<option cmc="' + item.Id + 
                                 '" cat="' + item[packagePrefix + 'CategoryId__c'] + 
                               '" value="' + item[packagePrefix + 'CategoryId__c'] + '">' + 
                               item[packagePrefix + 'CategoryId__r'].Name + parent + '</option>';
                }
                
                function addChild(item) {
                    var $tree    = jQuery('ul#tree');
                    var $parent  = $tree.find('div[cat="' + item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__c'] + '"]');
                    var $current = $tree.find('div[cat="' + item[packagePrefix + 'CategoryId__c'] + '"]');
                    var $listDad = jQuery('select#selectParentCategory').find('option[cat="' + item[packagePrefix + 'CategoryId__r'][packagePrefix + 'Parent_Category__c'] + '"]');
                    
                    if($parent.length === 1 && $current.length === 0) {
                        if($parent.hasClass('has-kids')) {
                            $parent.next('ul').append(getItemMarkup(item, 'child', false));       
                        } else {
                            $parent.removeClass('no-kids')
                                   .addClass('has-kids')
                                   .prepend('<span class="icon exp-coll">+</span>')
                                   .after('<ul>' + getItemMarkup(item, 'child', false) + '</ul>');            
                        }
                        
                        $listDad.after(getOptionMarkup(item));
                        return true;
                    }
                    
                    return false;
                }

                function renderCategories() {
                    window[remotingPrefix].App_Config_Controller_JS.getCategoryConfigs('{!mobileAppConfig.Id}', function(result, event) {
                        if(!handleRemotingError(result, event)) {                            
                            setupTree(result, true);
                            hideDivDialog('promptAddCategory');
                        }
                    });
                }

                /*
                  amitchell 12/11 
                  renderCategoriesWithoutRepair rerenders as above
                  but does not attempt to reconnect orphaned categories which
                  is the cause of the lock ups and additional category problem.
                  We keep the above method so that save and quit without saving
                  functionality still works.                  
                
                */
                function renderCategoriesWithoutRepair() {
                  window[remotingPrefix].App_Config_Controller_JS.getCategoryConfigsWithoutRepair('{!mobileAppConfig.Id}', function(result, event) {
                    if(!handleRemotingError(result, event)) {                            
                      setupTree(result, true);
                      hideDivDialog('promptAddCategory');
                    }
                  });                  
                }
                
                function handleRemotingError(event) {
                    if(event.type === 'exception') {
                        alert('Something went wrong :(.  Please reload the page and try again.');
                        console.log(event);
                        console.log(result);                        
                        return true;
                    }
                    
                    return false;
                }

                function initializeButtons() {
                    var buttonAlignLeft = jQuery("#buttonAlignLeft");
                    var buttonAlignCenter = jQuery("#buttonAlignCenter");
                    var buttonAlignRight = jQuery("#buttonAlignRight");
                    buttonAlignLeft.bind('click', function(e) {
                        document.getElementById('{!$Component.form1.pb1.Button_text_align}').value='Left'; 
                        buttonAlignLeft.css({
                            backgroundColor: "rgba(245, 245, 245, 0.6)"
                        });
                        buttonAlignCenter.css({
                            backgroundColor: "transparent"
                        });
                        buttonAlignRight.css({
                            backgroundColor: "transparent"
                        });
                    });
                    buttonAlignCenter.bind('click', function(e) {
                        document.getElementById('{!$Component.form1.pb1.Button_text_align}').value='Center'; 
                        buttonAlignLeft.css({
                            backgroundColor: "transparent"
                        });
                        buttonAlignCenter.css({
                            backgroundColor: "rgba(245, 245, 245, 0.6)"
                        });
                        buttonAlignRight.css({
                            backgroundColor: "transparent"
                        });
                    });
                    buttonAlignRight.bind('click', function(e) {
                        document.getElementById('{!$Component.form1.pb1.Button_text_align}').value='Right'; 
                        buttonAlignLeft.css({
                            backgroundColor: "transparent"
                        });
                        buttonAlignCenter.css({
                            backgroundColor: "transparent"
                        });
                        buttonAlignRight.css({
                            backgroundColor: "rgba(245, 245, 245, 0.6)"
                        });
                    });                    
                }

                //  BEGIN: document ready, execute the following
                jQuery(document).ready(function() {
                    renderCategories();
                    initializeButtons();
                    
                    
                 /**  jQuery("html").niceScroll();
                     jQuery('#tabContentRightScroller').niceScroll();
                     jQuery('#tabContentLeftScroller').niceScroll();
               **/
                 
                    //  BEGIN: Set up the static widths of the panels that we're going to use
                    var resizeComponentsFunction = function() {
                        var jWindow = jQuery(window);
                        var mainHeader = jQuery("#mainHeader");
                        var tabButtons = jQuery("#tabButtons");
                        
                        var windowHeight = jWindow.height();
                        var windowWidth = jWindow.width();
                        
                        var contentHeight = windowHeight - mainHeader.height() - tabButtons.height() - 20;
                        jQuery("#tabContent").css({
                            height: contentHeight + "px"
                        });
                        jQuery("#tabContentLeft").css({
                            height: contentHeight + "px",
                            width: "400px"
                        });
                        jQuery("#tabContentRight").css({
                            height: contentHeight + "px"
                        });
                        
                        contentHeight -= 5;
                        jQuery("#tabContentLeftScroller").css({
                            width: "400px",
                            //height: "600px"
                            height: contentHeight + "px"
                        });
                        jQuery("#tabContentRightScroller").css({
                            width: "100%",
                            height: contentHeight + "px"
                        });
                        
                 
             
                    };
                    
                /*    jQuery(window).unload( function () {  
                    browserClose();
                    } );*/
                    
                    
                    jQuery(window).resize(resizeComponentsFunction);
                    resizeComponentsFunction();
                    // Adding Custom scroller to the DSA: This will replace the brower scroll
                     jQuery("html").niceScroll();
                     jQuery('#tabContentRightScroller').niceScroll();
                     jQuery('#tabContentLeftScroller').niceScroll();
                                            
                                                        
               
                    //  END: Set up the static widths of the panels that we're going to use
                    
                    theme_color_clicked();
                    ShowLandscapePreview();
                    ShowLandscapePreview_Category();
                    
                    
                    //  BEGIN: previous code from $(document).ready();
                    
                    if (jQuery.browser.mozilla) {
                        // Brower compatability issues handled here
                        jQuery('.positionx').removeClass("positionx").addClass("position_new"); 
                      }
                 
                    //Jquery slider for setting the alpha
                    var titleTextAlphaj = jQuery('input.tmp_title_text_alpha').val();
                    var introTextAlphaj  = jQuery('input.tmp_intro_text_alpha').val();
                    var buttonTextAlphaj = jQuery('input.tmp_button_text_alpha').val();
                    var overlaybackgroundj = jQuery('input.overlay_background_alpha').val();
                  
                     jQuery('.dyn-title-name-preview').css({"opacity":+titleTextAlphaj/100});
                     jQuery('.overlay_background_cls').css({"opacity":+overlaybackgroundj/100});
                    
                
                     createSlider_title('slider_title','disp','titleBarTextAlpha',titleTextAlphaj,0,100);
                     createSlider_intro('slider_intro','disp','introTextAlpha',introTextAlphaj,0,100);
                     createSlider_button('slider_button','disp','buttonTextAlpha',buttonTextAlphaj,0,100);
                      //createSlider_overlay('slider_overlay','disp','overlayBackgroundAlpha',overlaybackgroundj,0,100);
                
                    jQuery('input.Ok').live('click',function() {
                        //jQuery('.dyn-title-bg-preview').css({"background-color":"#"+jQuery('.tmp_title_bg_color').val()});
                        jQuery('.dyn-title-name-preview').css({"color":"#"+jQuery('.tmp_title_text_color').val()});
                        jQuery('.sub_category_description').css({"color":"#"+jQuery('.overlay_text_css').val()});
                        //Added by KR DE449
                        jQuery('.sub_category_text_color').css({"color":"#"+jQuery('.subcategory_heading_text_css').val()});
                 
                          jQuery('.overlay_background_cls').css({"background-color":"#"+jQuery('.overlay_background_css').val()});
                          jQuery('.sub_category_hover').css({"background-color":"#"+jQuery('.subcategory_background_css').val()});
                        });
                
                        /* jQuery('.dyn-title-name-preview').css({"opacity":+jQuery('.tmp_title_text_alpha').val()/100});
                           jQuery('.AlphaInput').change(function() {
                           jQuery('.dyn-title-name-preview').css({"opacity":+jQuery('.tmp_title_text_alpha').val()});
                                 });
                       */
    
                //Dynamic CSS changes with Jquery and CSS
    
                jQuery(".tmp_title_text_alpha").keyup(function(){
                             //jQuery('.dyn-title-name-preview').css({"opacity":+jQuery('.tmp_title_text_alpha').val()/100});
                            var titleTextAlpha_j = jQuery('input.tmp_title_text_alpha').val();
                            createSlider_title('slider_title','disp','titleBarTextAlpha',titleTextAlpha_j,0,100);
                        });
                jQuery(".tmp_intro_text_alpha").keyup(function(){
                    var introTextAlpha_j  = jQuery('input.tmp_intro_text_alpha').val();
                createSlider_intro('slider_intro','disp','introTextAlpha',introTextAlpha_j,0,100);
                
                
                    });
                    
                    jQuery(".tmp_button_text_alpha").keyup(function(){
                var titleTextAlpha_j = jQuery('input.tmp_button_text_alpha').val();
                   createSlider_button('slider_button','disp','buttonTextAlpha',titleTextAlpha_j,0,100);
                
                
                    }); 
                    
                    
                    jQuery(".overlay_background_alpha").keyup(function(){
                var overlaybackground_j = jQuery('input.overlay_background_alpha').val();
                   createSlider_overlay('slider_overlay','disp','overlayBackgroundAlpha',overlaybackground_j,0,100);
                
                
                    }); 
                    
                
                jQuery(".tmp_title_text").keyup(function(){
                   
                jQuery(".dyn-title-name-preview").html(jQuery('.tmp_title_text').val());
                
                    });
                    
                    
                jQuery(".tmp_title_text_alpha").keyup(function(){
                   
                 jQuery('.dyn-title-name-preview').css({"opacity":+jQuery('.tmp_title_text_alpha').val()/100});
                 
                    });
                    
                    jQuery(".overlay_background_alpha").keyup(function(){
                   
                 jQuery('.overlay_background_cls').css({"opacity":+jQuery('.overlay_background_alpha').val()/100});
                 
                    });
                    
                    jQuery(".switch_others").click(function(){
                jQuery(".switch_AppConfig").trigger('click');
                
                });
                
                 jQuery(".sub-category-tree-item").click(function(){
                
                
                jQuery("#category_selected").removeClass("show_division").addClass("hide_division");
                
                });
                
                 jQuery(".category-tree-item").click(function(){
                
                jQuery("#category_selected").removeClass("hide_division").addClass("show_division");
                
                });
                
                
                
                
                 jQuery(".select_home_preview").click(function(){
                     setTimeout(function() {
                        jQuery(".switch_home").get(0).click();
                    }, 500);
                
                });
                
                
                
                  jQuery('.tmp_title_text_alpha').mouseover(function() {
                  
                   //jQuery('.dyn-title-name-preview').hide(400);
                //jQuery('.dyn-title-name-preview').show(400);
                  jQuery('.dyn-title-name-preview').effect("shake", { times:1 }, 400);
                }); 
                
                
                  jQuery('.tmp_button_text_alpha').mouseover(function() {
                  jQuery('.button-text-wrapper').effect("pulsate", { times:1 }, 2000);
                }); 
                
                  jQuery('.tmp_title_text').mouseover(function() {
                   //jQuery('.dyn-title-name-preview').hide(400);
                //jQuery('.dyn-title-name-preview').show(400);
                  jQuery('.dyn-title-name-preview').effect("shake", { times:1 }, 2000);
                }); 
                
                
                  jQuery('.logo_input_file_cls').mouseover(function() {
                  jQuery('.logo_preview_cls').effect("pulsate", { times:1 }, 2000);
                });  
                
                
                
                  jQuery('.main_Landscape_background').mouseover(function() {
                  jQuery('.landscape-to-scale').effect("pulsate", { times:1 }, 2000);
                }); 
                
                  jQuery('.main_portrait_background').mouseover(function() {
                  jQuery('.portrait-to-scale').effect("pulsate", { times:1 }, 2000);
                }); 
                
                
                  jQuery('.Landing_page_layout_cls').mouseover(function() {
                  jQuery('.custom-button').effect("pulsate", { times:1 }, 2000);
                });  
                
                
                
                  jQuery('.overlay_background_alpha').mouseover(function() {
                
                  jQuery('.overlay_background_cls').hide(400);
                jQuery('.overlay_background_cls').show(400);
                }); 
                
                  jQuery('.subcategory_gallery_image').mouseover(function() {
                  jQuery('.category_image_preview').effect("pulsate", { times:1 }, 2000);
                }); 
                   
                
                  jQuery('.Category_Landscape_bg_cls').mouseover(function() {
                  jQuery('.category_l_bg_preview').effect("pulsate", { times:1 }, 2000);
                });  
                
                
                
                  jQuery('.Category_portrait_bg_cls').mouseover(function() {
                  jQuery('.category_p_bg_preview').effect("pulsate", { times:1 }, 2000);
                }); 
                
                  jQuery('.Content_List_bg_cls').mouseover(function() {
                  jQuery('.content_list_bg_preview').effect("pulsate", { times:1 }, 2000);
                }); 
                  jQuery('.Landing_page_layout_cls').mouseover(function() {
                  jQuery('.background-wrapper').effect("pulsate", { times:1 }, 2000);
                }); 
                
                  jQuery('.main_button_bg_cls').mouseover(function() {
                  jQuery('.background-wrapper').effect("pulsate", { times:1 }, 2000);
                }); 
                
                
                
                //done here - starting right to left highlighting
                  jQuery('.dyn-title-name-preview').mouseover(function() {
                  jQuery('.Application_title_div_cls').effect("pulsate", { times:1 }, 2000);
                });  
                
                 jQuery('.dyn-title-name-preview').mouseover(function() {
                  jQuery('.tmp_title_text').effect("pulsate", { times:1 }, 2000);
                });  
                
                  jQuery('.logo_preview_cls').mouseover(function() {
                  jQuery('.logo_input_file_cls').effect("pulsate", { times:1 }, 2000);
                });  
                
                
                  jQuery('.landscape-to-scale').mouseover(function() {
                  jQuery('.main_Landscape_background').effect("pulsate", { times:1 }, 2000);
                }); 
                
                  jQuery('.portrait-to-scale').mouseover(function() {
                  jQuery('.main_portrait_background').effect("pulsate", { times:1 }, 2000);
                }); 

                showAsDialog('promptLoading');  
                jQuery.fn.jPicker.defaults.images.clientPath = "{!URLFOR($Resource.DSA_Assets, 'images/images')}/";
                var id = '{!id}';
                var macId = '{!mobileAppConfig.id}';
                if(id == null || id == ''){
                    id = macId;
                }
                
                 var categoryConfigId = null;
                
      // load content after select category to edit
                var landscapeWidth = 640;
                var landscapeHeight = 480;
                var portraitWidth = 480;
                var portraitHeight = 640;
        
                var defaultLandscapeWidth = 1024; // 1.55151
                var defaultLandscapeHeight = 768;
                var defaultPortraitWidth = 768; // 0,885
                var defaultPortraitHeight = 1024;
                
                var zoomLandscapeWidth = 1024;
                var zoomLandscapeHeight = 768;
                var zoomPortraitWidth = 768;
                var zoomPortraitHeight = 1024;
                
                var imgButtonFlag = false;

                function createSlider_title(destination,dispOutput,titleBarTextAlpha,startVal,minVal,maxVal){
                   jQuery("#"+destination).slider({ 
                       range: false,  
                       min: minVal,
                        max: maxVal,
                        values: [startVal],
                        slide: function(event, ui){ 
                       //This function executes every time slider is moved and applies the slider values  
                       //to the input fields as well as the output below the slider
                             jQuery('.dyn-title-name-preview').css({"opacity":ui.values[0]/100});
                           jQuery("[id$="+titleBarTextAlpha+"]").val(ui.values[0]);
                         
                           jQuery("#"+dispOutput).html('alpha' + ui.values[0]);
                        }
                    });
                    //write the initial value in the display div
                   jQuery("#"+dispOutput).html('alpha' + startVal);
               }  
               
                function createSlider_intro(destination,dispOutput,introTextAlpha,startVal,minVal,maxVal){
                   jQuery("#"+destination).slider({ 
                       range: false, 
                       min: minVal,
                        max: maxVal,
                        values: [startVal],
                        slide: function(event, ui){ 
                       //This function executes every time slider is moved and applies the slider values  
                       //to the input fields as well as the output below the slider
                          
                         
                           jQuery("[id$="+introTextAlpha+"]").val(ui.values[0]);
                           jQuery("#"+dispOutput).html('alpha' + ui.values[0]);
                        }
                    });
                    //write the initial value in the display div
                   jQuery("#"+dispOutput).html('alpha' + startVal);
               }
                 
               function createSlider_button(destination,dispOutput,buttonTextAlpha,startVal,minVal,maxVal){
                   jQuery("#"+destination).slider({ 
                       range: false, 
                       min: minVal,
                        max: maxVal,
                        values: [startVal],
                        slide: function(event, ui){ 
                       //This function executes every time slider is moved and applies the slider values  
                       //to the input fields as well as the output below the slider
                                                 jQuery('.button-text-wrapper').css({"opacity":ui.values[0]/100});
                          
                          
                           jQuery("[id$="+buttonTextAlpha+"]").val(ui.values[0]);
                           jQuery("#"+dispOutput).html('alpha' + ui.values[0]);
                        }
                    });
                    //write the initial value in the display div
                   jQuery("#"+dispOutput).html('alpha' + startVal);
               }  
               
               function createSlider_overlay(destination,dispOutput,overlayBackgroundAlpha,startVal,minVal,maxVal){
                   jQuery("#"+destination).slider({ 
                       range: false, 
                       min: minVal,
                        max: maxVal,
                        values: [startVal],
                        slide: function(event, ui){ 
                       //This function executes every time slider is moved and applies the slider values  
                       //to the input fields as well as the output below the slider
                       
                           jQuery("[id$="+overlayBackgroundAlpha+"]").val(ui.values[0]);
                           jQuery("#"+dispOutput).html('alpha' + ui.values[0]);
                        }
                    });
                    //write the initial value in the display div
                   jQuery("#"+dispOutput).html('alpha' + startVal);
               }  

                // functions moved to appJs!!!
                // add button to layout or remove button from layout
                function addOrRemoveButton(categoryId, categoryName, eventType){
                    if(typeof categoryId.length == 'undefined' || typeof eventType.length == 'undefined' || typeof categoryName.length == 'undefined' || typeof id.length == 'undefined'){
                        return false;
                    }
                
                    if(categoryId.length == 0 || eventType.length == 0 || categoryName.length == 0 || id.length == 0){
                        return false;
                    }
        
                    showAsDialog('promptLoading'); 
                               
                    if(eventType == 'added'){
                        window[remotingPrefix].App_Config_Controller_JS.addMobileCategoryConfigToMAC(id, categoryId, function(result, event){
                            if(event.status) {
                                //Record added
                                // add button to page
                                jQuery('.selectCategoryList').addClass('editing');                      
                                jQuery('.selectCategoryForId-'+categoryId).addClass('added');
                                jQuery('.selectCategoryList').removeClass('editing');
                                jQuery('.selectCategoryForId-'+categoryId).css('background-color', 'dddddd');                       
                                var preparedLandscapeButton = setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'landscape-button');
                                var preparedPortraitButton = setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'portrait-button');                
                                setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'zoom-portrait-button');                        
                                setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'zoom-landscape-button');                       
                                if(jQuery('#zoom-layout-customizer').hasClass('portrait') && !jQuery('#promptZoom').hasClass('hidden')){
                                    //setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'zoom-portrait-button');                        
                                } else if(jQuery('#zoom-layout-customizer').hasClass('landscape') && !jQuery('#promptZoom').hasClass('hidden')){
                                    //setLayoutButton(result.Id, categoryName, categoryId , 0, 0, 'zoom-landscape-button');                       
                                }
        
                                var cmcId = result.Id;
                                renderCategories();                    
                            } else {
                                showError('Add buttons action failed.');
                            }
                            hideDivDialog('promptLoading');                 
                        });
                    } else if(eventType == 'removed' && typeof jQuery('span.'+categoryId).parent('div').parent('div').attr('id') != 'undefined' && jQuery('span.'+categoryId).parent('div').parent('div').attr('id').length != 0){
                        
                         window[remotingPrefix].App_Config_Controller_JS.removeMobileCategoryConfigFromMAC1(jQuery('span.'+categoryId).parent('div').parent('div').attr('id'), function(result, event){
                            if(event.status) {
                                
                                //Record deleted
                                 var ss = result;
                                 window[remotingPrefix].App_Config_Controller_JS.updateCategoryTree(ss, function(result4, event){
                                     if(event.status) {
                                     }
                                     else{
                                         showError('Delete buttons action failed.');
                                     }
                                });
                                // remove item with subcats from category-tree
                                jQuery('#category-tree').find('div[cat="'+categoryId+'"]').parent().remove(); //parent is containing <li>
                                
                                // remove button from page    
                                jQuery('.selectCategoryList').addClass('editing');
                                jQuery('.selectCategoryForId-'+categoryId).removeClass('added');      
                                jQuery('.selectCategoryList').removeClass('editing');
                                jQuery('.'+categoryId).parent().parent().draggable("destroy");
                                jQuery('.'+categoryId).parent().parent().remove();
                                // load first item to tree
                                if(jQuery('#category-tree').find('.category-tree-item').length != 0){
                                    jQuery('#category-tree').find('.category-tree-item').first().find('span.pointer-cursor').trigger('click');
                                } else {
                                    hideDivDialog('promptLoading');                        
                                }
                            } else {
                                showError('Remove button action failed.'); 
                                hideDivDialog('promptLoading');                                
                            
                            }                   
                        });
                    } else {
                        showError('Invalid action.');
                        hideDivDialog('promptLoading');    
                    }
                }
                
                // save dragged button position (drag - stop)
                function buttonDragged(event, ui){
                    var draggedButton = jQuery(ui.helper);
                    // remove scale before save
                    if(draggedButton.hasClass('zoom-portrait-button') || draggedButton.hasClass('zoom-landscape-button')){
                        scaleLX = defaultLandscapeWidth / zoomLandscapeWidth;
                        scaleLY = defaultLandscapeHeight / zoomLandscapeHeight;
                        scalePX = defaultPortraitWidth / zoomPortraitWidth;
                        scalePY = defaultPortraitHeight / zoomPortraitHeight;                               
                    } else if(draggedButton.hasClass('portrait-button') || draggedButton.hasClass('landscape-button')){
                        scalePX = defaultPortraitWidth / portraitWidth;
                        scalePY = defaultPortraitHeight / portraitHeight;               
                        scaleLX = defaultLandscapeWidth / landscapeWidth;
                        scaleLY = defaultLandscapeHeight / landscapeHeight;
                    } else {
                        showError('Unable to update button position.','Wrong scale.');
                        return false;               
                    }
                    
                    window[remotingPrefix].App_Config_Controller_JS.saveDraggedButton(
                        draggedButton.attr('id'),
                        ( draggedButton.hasClass('zoom-landscape-button') || draggedButton.hasClass('landscape-button') ) ? (ui.position.left * scaleLX) : '',
                        ( draggedButton.hasClass('zoom-landscape-button') || draggedButton.hasClass('landscape-button') ) ? (ui.position.top  * scaleLY) : '',
                        ( draggedButton.hasClass('zoom-portrait-button') || draggedButton.hasClass('portrait-button') ) ? (ui.position.left * scalePX) : '',
                        ( draggedButton.hasClass('zoom-portrait-button') || draggedButton.hasClass('portrait-button') ) ? (ui.position.top  * scalePY) : '',
                        function(result, event){
                            if(event.status) {
                                // 'Button dragged saved'
                            } else {
                                showError('Drag button action failed.');   
                            }
                    });
                }
        
                // remove rubbish from layout and option list)
                function cleanUp(result){
                
                    var needToDelete = true;
                    var temporaryButtonId = null;               
                    var temporaryCategoryId = null; 
                    
                    // CLEAN UP BUTTONS
                    jQuery('.custom-button').each(function(){
                        if(jQuery(this).attr('id').length != 0){
                            needToDelete = true;
                            temporaryButtonId = jQuery(this).attr('id');
                            jQuery.each(result, function(index,button){
                                if(temporaryButtonId == button.Id){
                                    needToDelete = false;
                                    return;
                                }
                            });
                            if(needToDelete){
                                jQuery(this).draggable("destroy");                          
                                jQuery(this).remove();
                            }
                        } else { // invalid button!
                            jQuery(this).remove();                      
                        }           
                    });
                    
                    jQuery('.selectCategory').each(function(){
                        jQuery('.selectCategoryList').addClass('editing');            
                        if(jQuery(this).attr('value').length != 0){
                            needToDelete = true;
                            temporaryCategoryId = jQuery(this).attr('value');
                            jQuery.each(result, function(index,button){
                                if(temporaryCategoryId == button[packagePrefix+'CategoryId__r'].Id){
                                    needToDelete = false;
                                    needToCreate = true;                                    
                                    return;
                                }
                            });
                            if(needToDelete){
                                if(jQuery(this).hasClass("added")){
                                    jQuery(this).removeClass("added");
                                }                           
                            }                       
                        } else { // invalid category option!
                            jQuery(this).remove();                      
                        }
                        jQuery('.selectCategoryList').removeClass('editing');
                    });
                }
        
                // function return button (div) for requested params
                function setLayoutButton(mobileCategoryId, CategoryName, CategoryId, positionX, positionY, buttonExtraClass){
                    if(typeof buttonExtraClass == 'undefined' || buttonExtraClass.length ==0){
                        showError('Unable to set button','Missing parameter.');
                        return false;
                    }
                    
                    if(buttonExtraClass == 'zoom-landscape-button'){
                        scaleX = zoomLandscapeWidth / defaultLandscapeWidth;
                        scaleY = zoomLandscapeHeight / defaultLandscapeHeight;
                        customizer = jQuery('#zoom-layout-customizer'); 
                    } else if(buttonExtraClass == 'zoom-portrait-button'){
                        scaleX = zoomPortraitWidth / defaultPortraitWidth;
                        scaleY = zoomPortraitHeight / defaultPortraitHeight;
                        customizer = jQuery('#zoom-layout-customizer'); 
                    } else if(buttonExtraClass == 'portrait-button'){
                        scaleX = portraitWidth / defaultPortraitWidth;
                        scaleY = portraitHeight / defaultPortraitHeight;
                        customizer = jQuery('#layout-portrait-customizer');         
                    } else if(buttonExtraClass == 'landscape-button'){
                        scaleX = landscapeWidth / defaultLandscapeWidth;
                        scaleY = landscapeHeight / defaultLandscapeHeight;
                        customizer = jQuery('#layout-landscape-customizer');        
                    } else {
                        showError('Unable to set button.','Wrong scale.');
                        return false;               
                    }
                    
                    if(imgButtonSrc != null){
                        var buttonWidth = (parseInt(imgButtonWidth) * scaleX)+'px';
                        var buttonHeigth = (parseInt(imgButtonHeight) *scaleY)+'px';
                        var buttonTextVerticalPostion = '-'+(((parseInt(imgButtonHeight) *scaleY)/2)+5)+'px';                
                        var buttonBackgroundSrc = imgButtonSrc;
                        imgButtonFlag = true;           
                    } else {
                        var buttonWidth = 'auto';
                        var buttonHegith = 'auto';
                        var buttonBackgroundSrc = null;
                        var buttonTextVerticalPostion = 'auto';
                        imgButtonFlag = false;
                    }
                    
                    if( !isNaN(parseInt(jQuery('.alphaButtonText').val())) ){
                        opacityValue = parseInt(jQuery('.alphaButtonText').val());
                    } else {
                        opacityValue = 100;
                    }
                    
                    var divButton = null;
                    if(customizer.find('#'+mobileCategoryId).length == 0){
                    
                        // add button
                        var divButtonString = '<div class="custom-button" id="'+mobileCategoryId+'">';
                            divButtonString += '<div class="custom-button-actions hidden"><div class="removing-button">X</div></div>';                
                            divButtonString += '<div class="background-wrapper" style="position: relative; top: 0px; left: 0px; width: 100%; height: 100%; z-index:100;">'
                            if(buttonBackgroundSrc != null){
                                divButtonString += '<img src="'+buttonBackgroundSrc+'" class="buttonBackgroundImg">';
                            }
                            divButtonString += '</div>';
                            divButtonString += '<div class="button-text-wrapper" style="position: relative; top: '+(buttonTextVerticalPostion)+'; left: 0px; width: 100%; height: 100%; z-index:101;">';
                                divButtonString += '<span class="'+CategoryId+'">'+encodeHTML(CategoryName)+'</span>';
                            divButtonString += '</div>';
                        divButtonString += '</div>';
                    
                        divButton = jQuery(divButtonString);
                        divButton.draggable({
                            containment: 'parent',
                            stop: buttonDragged
                        });
                        customizer.append(divButton);
                    } else {
                        divButton = customizer.find('#'+mobileCategoryId);
                        // update button                
                        divButton.attr('class','').addClass('custom-button').addClass('ui-draggable').addClass(buttonExtraClass);
                        
                        if(buttonBackgroundSrc == null){
                            if(divButton.find('.buttonBackgroundImg').length != 0){
                                divButton.find('.buttonBackgroundImg').remove();
                            }
                        }
                        if(divButton.find('.buttonBackgroundImg').length != 0 && buttonBackgroundSrc != null){
                            divButton.find('.buttonBackgroundImg').attr('src', buttonBackgroundSrc);                
                        } else if(divButton.find('.buttonBackgroundImg').length == 0 && buttonBackgroundSrc != null){
                            divButton.find('.background-wrapper').append('<img src="'+buttonBackgroundSrc+'" class="buttonBackgroundImg">');
                        }
                        divButton.find('.button-text-wrapper').css('top', buttonTextVerticalPostion);
                        divButton.find('.button-text-wrapper').css('opacity', (opacityValue/100));
                        divButton.find('.button-text-wrapper').find('span').attr('class','').addClass(CategoryId);
                        divButton.find('.button-text-wrapper').find('span').text(CategoryName);
                    }
                    divButton.css('position','absolute');
                    divButton.css('left', (positionX*scaleX));
                    divButton.css('top', (positionY*scaleY));
                    divButton.css('width', buttonWidth);
                    divButton.css('height', buttonHeigth);  
                    divButton.find('.buttonBackgroundImg').css('width', '100%');
                    divButton.find('.buttonBackgroundImg').css('height', '100%');
                    divButton.find('.button-text-wrapper').css('opacity', (opacityValue/100));
                    divButton.css('color', '#'+jQuery('.buttonTextColorInput').val());
                    divButton.addClass(buttonExtraClass);       
                    return divButton;
                }
        
                // init: get information about buttons 
                // get information about buttons (from category mobile configuration for requested mobile configuration id
                // add buttons to layout-customizer
                function reloadButtons(){
                    showAsDialog('promptLoading');  
                    // RELOAD BUTTONS&LISTS         
                    window[remotingPrefix].App_Config_Controller_JS.getCategoryConfigurationForMobApp(id, true, function(result, event){
                        // DE358: DSA Builder Freezes on IE8 
                        if (typeof console === 'undefined' || !console.log) {
                              window.console = {
                                  log: function() {}
                              };
                        } 
                        else {
                            // DE358.. ended here..
                            console.log('reloadButtons():getCategoryConfigurationForMobApp:id='+id);
                        }
                        if(event.status) {
                            // remove not existing (in db) buttons from layout and options from category lists
                            cleanUp(result); 
                            // reset category select list
                            // add not existing (layout) buttons to layout
                            jQuery.each(result, function(index,button){
                                
                                // create landscape button
                                setLayoutButton(button.Id, button[packagePrefix+'CategoryId__r'].Name, button[packagePrefix+'CategoryId__r'].Id, button[packagePrefix+'LandscapeX__c'], button[packagePrefix+'LandscapeY__c'], 'landscape-button');

                                // create portait button
                                setLayoutButton(button.Id, button[packagePrefix+'CategoryId__r'].Name, button[packagePrefix+'CategoryId__r'].Id, button[packagePrefix+'PortraitX__c'], button[packagePrefix+'PortraitY__c'], 'portrait-button');
                                if(!jQuery('.selectCategoryForId-'+button[packagePrefix+'CategoryId__r'].Id).hasClass('added')){
                                    jQuery('.selectCategoryList').addClass('editing');
                                    jQuery('.selectCategoryForId-'+button[packagePrefix+'CategoryId__r'].Id).addClass('added');
                                    jQuery('.selectCategoryList').removeClass('editing');                           
                                }
                            });
                        } 
                        else if (event.type === 'exception') {    
                            showError('Unable to load buttons.', event.message);                
                        } 
                        else {
                            showError('Unable to load buttons.', event.message);                
                        }
                        hideDivDialog('promptLoading');            
                    }, {escape:false});
                }
                
                jQuery("img").each(function(i, elem){
                    if (jQuery(elem).attr('id').search('imgButton') != -1){
                        if(!jQuery(elem).hasClass('imgButton')){
                            jQuery(elem).addClass('imgButton')
                        }
                    }
                });
        
                if(jQuery('.imgButton').length != 0){
                    var imgButtonSrc = jQuery('.imgButton').attr('src');
                    var imgButtonWidth = jQuery('.imgButton').width();          
                    var imgButtonHeight = jQuery('.imgButton').height();
                } else {
                    var imgButtonSrc = null;
                    var imgButtonWidth = 0;         
                    var imgButtonHeight = 0;
                }
                
                jQuery('.imgButton').load(function(){
                    imgButtonSrc = jQuery(this).attr('src');
                    imgButtonWidth = jQuery(this).width();          
                    imgButtonHeight = jQuery(this).height();
                    reloadButtons()
                });
                 
                
                // scale background images to layout customizer divs
                if(jQuery('.portrait-to-scale').length != 0){
                    jQuery('.portrait-to-scale').css('width', portraitWidth );
                    jQuery('.portrait-to-scale').css('height', portraitHeight );
                }
                if(jQuery('.landscape-to-scale').length != 0){
                    jQuery('.landscape-to-scale').css('width', landscapeWidth );
                    jQuery('.landscape-to-scale').css('height', landscapeHeight );
                }       
                
                // init: add classes and bind plugins to input elemenets
                jQuery('input[type=text]').each(function(i, elem){
                    if (jQuery(elem).attr('id').search('buttonTextPickColor') != -1){
                        if(!jQuery(elem).hasClass('buttonTextColorInput')){
                            jQuery(elem).addClass('buttonTextColorInput');    
                        }            
                    }                
                    if (jQuery(elem).attr('id').search('PickColor') != -1){
                        if(!jQuery(elem).hasClass('colorPickerBind')){
                            bindColorPicker(jQuery(elem));
                            jQuery(elem).addClass('colorPickerBind');                   
                        }
                    }
                    if (jQuery(elem).attr('id').search('Alpha') != -1){
                        if(!jQuery(elem).hasClass('AlphaInput')){
                            jQuery(elem).addClass('AlphaInput');            
                            jQuery(elem).attr('size',3);
                            jQuery(elem).attr('maxlength',3);
                            jQuery(elem).numeric(false);
                            jQuery(elem).focusout(function(event){
                                var elemVal = parseInt(jQuery(this).val());
                                if(isNaN(elemVal) || elemVal < 0) {
                                    jQuery(this).val(0);
                                }
                                if(!isNaN(elemVal) && elemVal > 100) {
                                    jQuery(this).val(100);
                                }                       
                            });
                        }                
                    }
                    if (jQuery(elem).attr('id').search('buttonTextAlpha') != -1){
                        if(!jQuery(elem).hasClass('alphaButtonText')){
                            jQuery(elem).addClass('alphaButtonText');
                        }         
                    }            
                });
                
                var alphaInput;
                var sliderObject;
                
                jQuery('.user-panel-content').bind('click', function(e) {
                    if(e.target != this) { return true; }
                    sliderObject.fadeOut("fast");
                });
                
                alphaInput = jQuery("[id$=titleBarTextAlpha]");
                alphaInput.bind('focus', function(e) {
                    if(sliderObject) {
                        sliderObject.fadeOut("fast");
                    }
                    sliderObject = jQuery("#slider_title_container");
                    sliderObject.fadeIn("fast");
                });
        
                alphaInput = jQuery("[id$=introTextAlpha]");
                alphaInput.bind('focus', function(e) {
                    if(sliderObject) {
                        sliderObject.fadeOut("fast");
                    }
                    sliderObject = jQuery("#slider_intro_container");
                    sliderObject.fadeIn("fast");
                });
        
                alphaInput = jQuery("[id$=buttonTextAlpha]");
                alphaInput.bind('focus', function(e) {
                    if(sliderObject) {
                        sliderObject.fadeOut("fast");
                    }
                    sliderObject = jQuery("#slider_button_container");
                    sliderObject.fadeIn("fast");
                });
                
                
                jQuery('.jPicker').mouseover(function() {
                    var siblings = jQuery(this).parent().children(':first-child').attr('class');
                    var first_sibling_class = siblings.split(' ')[0];
                    if(first_sibling_class == "tmp_title_bg_color"){
                        //jQuery('.dyn-title-bg-preview').effect("pulsate", { times:1 }, 2000);
                    }else if(first_sibling_class == "tmp_title_text_color"){
                        jQuery('.dyn-title-name-preview').effect("shake", { times:1 }, 400);
                    }else if(first_sibling_class == "tmp_button_text_color"){
                        jQuery('.button-text-wrapper').effect("pulsate", { times:1 }, 2000);
                    }else if(first_sibling_class == "tmp_button_highlight_text_color"){
                        jQuery('.button-text-wrapper').effect("pulsate", { times:1 }, 2000);
                    }
                });
                
        
                
                
                jQuery('.alphaButtonText').focusout(function(){
                    updateTextButtons();
                })
                
                // init: add classes to checkbox elemenets
                jQuery('input[type=checkbox]').each(function(i, elem){
                    if (jQuery(elem).attr('id').search('bundleCheckbox') != -1){
                        if(!jQuery(elem).hasClass('isBundleCheckbox')){
                            jQuery(elem).addClass('isBundleCheckbox');
                        }
                    }                   
                });
                        
                // init: add classes to select elemenets
                jQuery("select").each(function(i, elem){
                    
                    // same categories but from different lists
                    if (jQuery(elem).attr('id').search('portraitCategoryList') != -1 || jQuery(elem).attr('id').search('landscapeCategoryList') != -1 || jQuery(elem).attr('id').search('zoomCategoryList') != -1){
                        if(!jQuery(elem).hasClass('selectCategoryList')){
                            jQuery(elem).addClass('selectCategoryList');
                        }            
                        jQuery('option',elem).each(function(i,cat){
                            if(!jQuery(cat).hasClass('selectCategory')){
                                jQuery(cat).addClass('selectCategory');
                                jQuery(cat).addClass('selectCategoryForId-'+jQuery(cat).attr('value'));
                            }                    
                        });
                    }
                });
                
                
        
                
                // add category to layout: manage three different list
                jQuery('.selectCategoryList').change(function(){
                    var selectedCatObj = jQuery(this).find("option:selected").first();
                    if(selectedCatObj.length != 0 && !jQuery(this).hasClass('editing') && selectedCatObj.val() != 'SelectCategory'){
                        var categoryId = encodeHTML(selectedCatObj.val());
                        var categoryName = encodeHTML(selectedCatObj.text());    
                        if(!selectedCatObj.hasClass('added')){
                        // add
                            addOrRemoveButton(categoryId, categoryName, 'added');
                        } else {
                        // remove
                            addOrRemoveButton(categoryId, categoryName, 'removed');
                        }
                    }
                    selectedCatObj.focusout();
                    selectedCatObj.attr('selected', 'false');
                    jQuery('.selectCategoryList').val('SelectCategory');
                    jQuery(this).find("option").each(function(){
                        if(jQuery(this).val() == 'SelectCategory'){
                            jQuery(this).attr('selected', 'true');
                            return;
                        }
                    });
                    jQuery('.selectCategoryList').focus().blur();
                }).change();        
        
                jQuery('.rich-tab-header').live('click', function(){
                    if(jQuery(this).hasClass('rich-tab-disabled')){
                        showError('Cannot open this section.', 'No data to manage.');
                    }
                });
        
                // get current category config id
                jQuery('.category-tree-item').live('click',function(){
                    if(categoryConfigId != jQuery(this).attr('id')){
                        categoryConfigId = jQuery(this).attr('id');
                    }
                });
        
                jQuery('.indicator-expand-category').live('click',function(event){
                    event.preventDefault();     
                    if(jQuery(this).parent().attr('id').length !=0){
                        if(jQuery(this).hasClass('collapsed') ){
                            jQuery(this).removeClass('collapsed').addClass('expanded');
                            jQuery(this).text('-');             
                            jQuery('.category-tree-holder').find('.sub-for-cmcid-'+jQuery(this).parent().attr('id')).removeClass('hidden');
                        } else if(jQuery(this).hasClass('expanded') ){
                            jQuery(this).text('+');
                            jQuery(this).addClass('collapsed').removeClass('expanded');                    
                            jQuery('.category-tree-holder').find('.sub-for-cmcid-'+jQuery(this).parent().attr('id')).addClass('hidden');
                        }
                    }
                
                });
                
                
                jQuery('.sub-category-tree-item ').removeClass('hidden');
                    jQuery('.indicator-expand-category').removeClass('collapsed').addClass('expanded');
                    jQuery('.indicator-expand-category').text('-');
                    
                    if(jQuery('#category-tree').find('.category-tree-item').length != 0){
        //            jQuery('#category-tree').children(':nth-child(2)').trigger('click');
          //     jQuery('#category-tree').children(':nth-child(1)').children(':nth-child(2)').trigger('click');
               
               var first_subcat = jQuery('#category-tree').children(':nth-child(2)').attr('id');
               
               if(first_subcat != 0){
               
               jQuery('#'+first_subcat).click(function(){
               jQuery('#Img_Icon_'+first_subcat).effect("pulsate", { times:1 }, 2000);
              });
            }     
        }
        

            // if bundle: show/hide part of page
            jQuery('.isBundleCheckbox').live('click',function(){
                var showHide = jQuery(this).attr('checked');
                showAsDialog('promptLoading');               
                jQuery("div").each(function(i, elem){
                    if (jQuery(elem).attr('id').search('cicBlock') != -1){
                        if(showHide){
                            jQuery(elem).hide();
                        } else {
                            jQuery(elem).show();                    
                        }
                        return true;
                    }
                });     
    
            });
            
            
            
           
            
            jQuery('.customTabHeader').live('click', function(){
                jQuery('.customTabHeader').removeClass('BGactive');
                jQuery(this).addClass('BGactive');
                jQuery('.customTabHeader').children(':first-child').removeClass('active');
                jQuery(this).children(':first-child').addClass('active');
                
            
            });
            
            /* TODO: SW
            jQuery("div").each(function(i, elem){
                if (jQuery(elem).attr('id').search('giBlock') != -1 && {!!isSubCategorySelected}){
                    jQuery(elem).hide();
                    return true;
                }
            }); */
    
            // if checkbox is set as default clicked, check for others default
            jQuery('.isDefaultChbx').live('click', function(){
                if(jQuery(this).attr('checked') == true){
                    window[remotingPrefix].App_Config_Controller_JS.isOtherDefaultCategoryConfiguration(categoryConfigId, id, function(result, event){
                        if(event.status) {  
                            if(result != 0){
                                showAsDialog('promptOtherDefault');                        
                            }
                        } else if (event.type === 'exception') {    
                            showError('Check if other default configuration exist failed.', event.message);                
                        } else {
                            showError('Check if other default configuration exist failed.', event.message);                
                        }
                    }, {escape:true});     
                } else {
                    hideDivDialog('promptOtherDefault');              
                }
            });
    
            // button actions: click
    
            // add top level category dialog
            jQuery('.addTopLevelCategory').click(function(event){
                event.preventDefault();
                showAsDialog('promptAddTopLevelCategory')
            });
            // add category dialog
            jQuery('.addCategory').click(function(event){
                event.preventDefault();
                showAsDialog('promptAddCategory');
            });
            jQuery('.closeButtonImage').click(function(event){
                event.preventDefault();
                event.stopPropagation();
                var id = this.id.replace('_delete', '');
                
                if(id) {
                    deleteSubCategoryById(id);
                    jQuery("#" + id).remove();
                    jQuery("#tabHeader_4").trigger('click');
                }
            });
            // delete (global) dialog     
            jQuery('.deleteButton').click(function(event){
                event.preventDefault();
                showAsDialog('promptDelete');
            });        
            // cancel delete (global)         
            jQuery('#cancelDeleting').click(function(event){
                event.preventDefault();
                hideDivDialog('promptDelete');   
            });
            
            // cancel open warning (global)         
            jQuery('#cancelWarning').click(function(event){
                event.preventDefault();
                hideDivDialog('openWarning'); 
                warningAndWindowClose();  
            });
            
            // TODO SW
            jQuery('.deleteSubButton').click(function(event){   
                event.preventDefault();
                showAsDialog('promptSubDelete');
            });
           /* jQuery('#cancelSubDeleting').click(function(event){
                event.preventDefault();
                hideDivDialog('promptSubDelete');   
            });
            */
            
            // confirm set as default configuration
            jQuery('#changeDefaultConfiguration').click(function(event){
                event.preventDefault();
                hideDivDialog('promptOtherDefault');               
            });
            // cancel set as default configuration
            jQuery('#cancelDefaultConfiguration').click(function(event){
                event.preventDefault();
                hideDivDialog('promptOtherDefault');               
                jQuery('.isDefaultChbx').attr('checked', false);
            });
            // close error box
            jQuery('#closeError').click(function(event){
                event.preventDefault();
                hideDivDialog('promptError');
                jQuery('#error-msg').text('');
                jQuery('#error-msg-nofity').text('');
            });          
            // confirm add Top Level category
            jQuery('#saveTopLevelCategory').click(function(event){
                event.preventDefault();
                if(jQuery('#new-top-level-cateogry-name').length != 0){
                    var categoryNameField = jQuery('#new-top-level-cateogry-name');
                   // var categoryLanguageField = jQuery('#new-top-level-cateogry-language');
                    if(categoryNameField.val().length > 0 && categoryNameField.val().length < 80){
                        var categoryName = encodeHTML(categoryNameField.val());
                        var categoryNameActual = categoryNameField.val();
                     // var clanguage = categoryLanguageField.val();
                        window[remotingPrefix].App_Config_Controller_JS.addCategory(categoryNameActual, '', function(result, event){
                            if(event.status) {
                                if(result.Id != null && result.Id != ''){
                                    jQuery('.selectCategoryList').append('<option class="selectCategory selectCategoryForId-'+result.Id+'" value="'+result.Id+'">'+categoryName+'</option>');
                                }else{
                                    showError('Category already exists. Please use other name and try again.');
                                }                        
                            } else {
                                showError('Add category failed.');                                  
                            }
                        });                 
                        hideDivDialog('promptAddTopLevelCategory');
                    } else {
                        // invalid input
                    }
                }
                
            });
            
            // cancel add top level categories
            jQuery('#cancelAddTopLevelCategory').click(function(event){
                event.preventDefault();
                hideDivDialog('promptAddTopLevelCategory');               
            });
               
            // confirm add N-Level category
            jQuery('#saveCategory').click(function(event) {
                var mobileAppConfigId = '{!mobileAppConfig.Id}';
                var categoryName      = jQuery('input#cateogry-name').val();
                var parentCategory    = jQuery('select#selectParentCategory').val(); //id
                var parentName        = jQuery('select#selectParentCategory option:selected').text();
                console.log(mobileAppConfigId + categoryName + parentCategory + parentName);
                
                //does this subcat already exist for this parent?  let's find the parent in the tree, find it's immediate subcategories, and see if the new cat is in there
                var existingSubcats = jQuery('ul#tree').find("div[cat='"+parentCategory+"'] + ul > li[class='child'] > div > span[class='tree-item']").filter(function() {
                    return jQuery(this).text() == categoryName;
                });
                if (existingSubcats && existingSubcats.length > 0) {
                    //can't add the same subcat to a parent twice
                    hideDivDialog('promptAddCategory');
                    var errorMsg = "'" + categoryName + "' is already a sub-category of '" + parentName + "'.";
                    jQuery('#error-msg').text(errorMsg);
                    jQuery('#error-msg-nofity').text('Tip: Use the + button to expand categories in the Category List');
                    showAsDialog('promptError');
    
                }
    
                // amitchell 12/09 - WP89 bugfix
                if (!categoryName) {
                  hideDivDialog('promptAddCategory');
                  var errorMsg = 'A name field is required for a category or subcategory record';
                  jQuery('#error-msg').text(errorMsg);
                  showAsDialog('promptError');
                } 
                
                
                // end amitchell 12/09 WP89 bugfix
                else {
                  window[remotingPrefix].App_Config_Controller_JS.addCategory2(mobileAppConfigId, categoryName, parentCategory, function(result, event) {
                    if(!handleRemotingError(event)) {
                      renderCategoriesWithoutRepair();
                    }
                  });
                }
    
    
            });
            
            // cancel add category
            jQuery('#cancelAddCategory').click(function(event){
                event.preventDefault();
                hideDivDialog('promptAddCategory');               
            });    
    
            jQuery('.openZoom').click(function(event){
                // we have only one "zoom-compositor" (both for portrait and landscape)
                event.preventDefault();
                showAsDialog('promptLoading');  
                errorFlag = false;
                isPortrait = false;
                isLandscape = false;
                            
                if(jQuery(this).hasClass('landscape-zoom')){
                    currentZoomWidth = zoomLandscapeWidth;
                    currentZoomHeight = zoomLandscapeHeight;
                    backgroundImgDiv = jQuery('.layout-landscape-background').clone();
                    backgroundImgDiv.removeClass('layout-landscape-background');
                    isLandscape = true;             
                    buttonType = 'zoom-landscape-button';
                    jQuery('#zoom-layout-customizer').addClass('landscape').removeClass('portrait');
                } else if(jQuery(this).hasClass('portrait-zoom')){
                    currentZoomWidth = zoomPortraitWidth;
                    currentZoomHeight = zoomPortraitHeight;
                    backgroundImgDiv = jQuery('.layout-portrait-background').clone();
                    backgroundImgDiv.removeClass('layout-portrait-background');
                    isPortrait = true;              
                    buttonType = 'zoom-portrait-button';
                    jQuery('#zoom-layout-customizer').addClass('portrait').removeClass('landscape');
                } else {
                    showError('Unable to open zoom.','Invalid zoom type.');
                    errorFlag = true;
                }
    
                if(!errorFlag){
                    // set zoom size
                    jQuery('#zoom-layout-customizer').css('width', currentZoomWidth);
                    jQuery('#zoom-layout-customizer').css('height', currentZoomHeight);
                    
                    // reset background img             
                    jQuery('#zoom-layout-customizer').find('.layout-zoom-background').remove();
                    backgroundImgDiv.addClass('layout-zoom-background');
                    jQuery('#zoom-layout-customizer').append(backgroundImgDiv);
                    jQuery('.layout-zoom-background').find('img').attr('class', '');                
                    jQuery('.layout-zoom-background').find('img').css('width', currentZoomWidth);               
                    jQuery('.layout-zoom-background').find('img').css('height', currentZoomHeight);                     
                    
                    // we remove all button from zoom layout        
                    jQuery('#zoom-layout-customizer').find('.custom-button').remove();
                    
                    window[remotingPrefix].App_Config_Controller_JS.getCategoryConfigurationForMobApp( id, true, function(result, event){
                         console.log('.openZoom:getCategoryConfigurationForMobApp:id='+id);
                        
                        if(event.status) {
    
                            jQuery.each(result, function(index,button){
                                // set button
                                if(isLandscape && !isPortrait) {
                                    setLayoutButton(button.Id, button[packagePrefix+'CategoryId__r'].Name, button[packagePrefix+'CategoryId__r'].Id, button[packagePrefix+'LandscapeX__c'], button[packagePrefix+'LandscapeY__c'], 'zoom-landscape-button');
                                } else if(!isLandscape && isPortrait) {                     
                                    setLayoutButton(button.Id, button[packagePrefix+'CategoryId__r'].Name, button[packagePrefix+'button.CategoryId__r'].Id, button[packagePrefix+'PortraitX__c'], button[packagePrefix+'PortraitY__c'], 'zoom-portrait-button');
                                } else {
                                    showError("Unable to create button.","Invalid parameters.")
                                    return false;
                                }
                                if(!jQuery('.selectCategoryForId-'+button[packagePrefix+'CategoryId__r'].Id).hasClass('added')){
                                    jQuery('.selectCategoryList').addClass('editing');                              
                                    jQuery('.selectCategoryForId-'+button[packagePrefix+'CategoryId__r'].Id).addClass('added');
                                    jQuery('.selectCategoryList').removeClass('editing');                                   
                                }                           
                            });
                            showAsDialog('promptZoom');                     
                        } else if (event.type === 'exception') {    
                            showError('Unable to load buttons.', event.message);                
                        } else {
                            showError('Unable to load buttons.', event.message);                
                        }
                        hideDivDialog('promptLoading');            
                    }, {escape:false});
               } else {
                    hideDivDialog('promptLoading');
               }
            });  
            jQuery('#doneZoom').click(function(event){
                event.preventDefault();
                // hide zoom            
                hideDivDialog('promptZoom');
                // reload buttons positioning
                reloadButtons();            
            });
            jQuery('.reloadLayoutCustomizers').click(function(event){
                event.preventDefault();
                // reload buttons positioning
                reloadButtons();            
            });
            
            jQuery('.custom-button').live('mouseover',function(){
                if(!jQuery(this).hasClass('button-mouse-over')){
                    jQuery(this).addClass('button-mouse-over');
                    if(jQuery(this).find('.custom-button-actions').length != 0){
                        jQuery(this).find('.custom-button-actions').removeClass('hidden');
                    }
                }
            });
            jQuery('.custom-button').live('mouseout', function(){
                if(jQuery(this).hasClass('button-mouse-over')){
                    jQuery(this).removeClass('button-mouse-over');
                    if(jQuery(this).find('.custom-button-actions').length != 0){
                        jQuery(this).find('.custom-button-actions').addClass('hidden');
                    }
                }
            });
            jQuery('.removing-button').live('click', function(){
                var customButton = jQuery(this).parents('.custom-button');
                if(customButton.length != 0){
                    categoryId = encodeHTML(customButton.find('span').attr('class'));
                    categoryName = encodeHTML(customButton.find('span').text());
                }
                if(categoryId.length != 0 && categoryName.length != 0){
                    addOrRemoveButton(categoryId, categoryName, 'removed');
                }           
            }); 
            
            reloadButtons();
            jQuery('.AlphaInput').each(
                function(idx, obj) {
                    if( !isNaN(parseInt(jQuery(obj).val()))) {
                        jQuery(obj).val(parseInt(jQuery(obj).val()));
                    } else {
                        jQuery(obj).val(100);
                    }
                }
            )
        
            
        
                        //  END: previous code from $(document).ready();
                    });
                    //  END: document ready, execute the following
                    
                    
                    //  BEGIN: universal functions for DOM use
                    
                    
                    
    
                   
                   var selectedTabIndex = 1;
                   
                function doTabClick(index) { 
                 //MM dev Nov 9 work around for nicescroll stop working
                console.log('VF:Configurator:doTabClick():getNiceScroll().resize() 1' );
                jQuery('#tabContentLeftScroller').getNiceScroll().resize();
                jQuery('#tabContentRightScroller').getNiceScroll().resize();
               var tabHeaderID = "#tabHeader_" + selectedTabIndex;
                           
                            tabHeaderID = "#tabHeader_" + index;
                           
                          jQuery('.customTabHeader').removeClass('BGactive');
                jQuery(tabHeaderID).addClass('BGactive');
                jQuery('.customTabHeader').children(':first-child').removeClass('active');
                jQuery(tabHeaderID).children(':first-child').addClass('active');
                
               
                            var oldContentID = "#tabContent_" + selectedTabIndex;
                            var newContentID = "#tabContent_" + index;
                            
                            jQuery(oldContentID).css({
                              display: "none"
                            });
                            jQuery(newContentID).css({
                               display: "block"
                            });
                            jQuery('#tabContentLeftScroller').niceScroll();
                            
                            jQuery(newContentID).niceScroll();
                            //jQuery('#tabContent_1').niceScroll();
                            
                            selectedTabIndex = index;
                            saveToDraftDebug();
                            //Added
                             if({!isSubCategorySelected}){          
                                onCompleteSelectSubCategory('{!selectedCategory.Id}');
                             }
                            //Added Raj
                            if({!!categoryLevels}){
                                jQuery("#giBlock").hide();
                             }  
                            //MM dev Nov 9 work around for nicescroll stop working
                            console.log('VF:Configurator:doTabClick():getNiceScroll().resize() 2' );
                            jQuery('#tabContentLeftScroller').getNiceScroll().resize();
                            jQuery('#tabContentRightScroller').getNiceScroll().resize();
                     };
                        
                     jQuery(".overlay_background_alpha").keyup(function(){
                     var overlaybackground_j = jQuery('input.overlay_background_alpha').val();
                    createSlider_overlay('slider_overlay','disp','overlayBackgroundAlpha',overlaybackground_j,0,100);
                    //createSlider_overlayNew('slider_overlay','disp','overlayBackgroundAlpha',overlaybackgroundjNew,0,100);
                    
                }); 
                        
                    
                        
                    
                                        
                     jQuery('.overlay_background_alpha').mouseover(function() {
                        //$("span").show(2000);
                        jQuery('.overlay_background_cls').hide(400);
                        jQuery('.overlay_background_cls').show(400);
                        //jQuery('.overlay_background_cls').effect("pulsate", { times:1 }, 2000);
                    }); 
                                        
    
        
                    function createSlider_overlayNew(destination,dispOutput,overlayBackgroundAlpha,startVal,minVal,maxVal){
                                var containerID = destination + "_container";
                                var jDest = jQuery("#"+destination);
                                var htmlText = '' +
                                    '<img src="{!URLFOR($Resource.DSA_Assets, 'images/SliderBackground.png')}" style="position:absolute; top:-20px; left:145px;"></img>' +
                                    '<div id="' + containerID + '" style="top:33px; left: 174px;"/>';
                                jDest.html(htmlText);
                                jDest.css({
                                    display: "none",
                                    position: "absolute",
                                    width: "370px",
                                    zIndex: "3"
                                });
                    
                               jQuery("#"+containerID).slider({ 
                                   range: false, 
                                   min: minVal,
                                    max: maxVal,
                                    values: [startVal],
                                    slide: function(event, ui){ 
                                   //This function executes every time slider is moved and applies the slider values  
                                   //to the input fields as well as the output below the slider
                                       jQuery('.overlay_background_cls').css({"opacity":ui.values[0]/100});
                                       jQuery("[id$="+overlayBackgroundAlpha+"]").val(ui.values[0]);
                                       jQuery("#"+dispOutput).html('alpha' + ui.values[0]);
                                    }
                                });
                                //write the initial value in the display div
                               jQuery("#"+dispOutput).html('alpha' + startVal);
                               
                                jQuery("[id$="+overlayBackgroundAlpha+"]").bind('focus', function(e) {
                                    jQuery("#"+destination).fadeIn("fast");
                                });
                                
                                jQuery("[id$=thePanel]").bind('click', function(e) {
                                    console.log("got click: " + e.target.id);
                                    if(e.target != this) { return true; };
                                    jQuery("#"+destination).fadeOut("fast");
                                });
                                
                           }  
    
                    
                    function rebindColorPickers(){
                  jQuery('input[type=text]').each(function(i, elem){
                            if (jQuery(elem).attr('id').search('PickColor') != -1){
                                if(!jQuery(elem).hasClass('colorPickerBind')){
                                    bindColorPicker(jQuery(elem));
                                    jQuery(elem).addClass('colorPickerBind');                   
                                }
                            }
                            if (jQuery(elem).attr('id').search('Alpha') != -1){
                                if(!jQuery(elem).hasClass('AlphaInput')){
                                    jQuery(elem).addClass('AlphaInput');            
                                    jQuery(elem).attr('size',3);
                                    jQuery(elem).attr('maxlength',3);
                                    jQuery(elem).numeric(false);
                                    jQuery(elem).focusout(function(event){
                                        var elemVal = parseInt(jQuery(this).val());
                                        if(isNaN(elemVal) || elemVal < 0) {
                                            jQuery(this).val(0);
                                        }
                                        if(!isNaN(elemVal) && elemVal > 100) {
                                            jQuery(this).val(100);
                                        }                       
                                    });
                                }                
                            }
                        });
                        jQuery('input[type=checkbox]').each(function(i, elem){
                            if (jQuery(elem).attr('id').search('isDefault') != -1){
                                if(!jQuery(elem).hasClass('isDefaultChbx')){
                                    jQuery(elem).addClass('isDefaultChbx');
                                }            
                            }                      
                        });
                        
                         jQuery('span.jPicker').each(function(i, el) {
                            jQuery(el).click(function() {
                                var position = jQuery(this).offset();
                                position.top = jQuery(window).height() / 2;
                                var visiblePicker = null;
                                jQuery('div.jPicker.Container').each(function() {
                                    if(jQuery(this).css('display') == 'block') {
                                        visiblePicker = this;
                                        position.top -= jQuery(visiblePicker).height() / 2;
                                    }
                                });
                                
                                jQuery(visiblePicker).css({
                                    top: position.top + 100,
                                    left: position.left + 90,
                                });
                            });
                        });
                        
                    }
                    
            function onCompleteSelectCategory() {
                //MM dev bug fix Nov 8
                //filterByButtonTextAlignField();
                
                var overlaybackgroundjNew = jQuery('input.overlay_background_alpha').val();
                
                createSlider_overlayNew('slider_overlay','disp','overlayBackgroundAlpha',overlaybackgroundjNew,0,100);
              
                rebindColorPickers();
                jQuery('input[type=checkbox]').each(function(i, elem){  
                    if (jQuery(elem).attr('id').search('bundleCheckbox') != -1){
                        if(!jQuery(elem).hasClass('isBundleCheckbox')){
                            jQuery(elem).addClass('isBundleCheckbox');
                        }
                    }                   
                    jQuery('.AlphaInput').each(
                        function(idx, obj) {
                            if( !isNaN(parseInt(jQuery(obj).val()))) {
                                jQuery(obj).val(parseInt(jQuery(obj).val()));
                            } else {
                                jQuery(obj).val(100);
                            }
                        }
                    )
                });
                var showHide = jQuery('.isBundleCheckbox').attr('checked');
                /*
                jQuery("div").each(function(i, elem){
                        if (jQuery(elem).attr('id').search('cicBlock') != -1){
                            if(showHide){
                                jQuery(elem).hide();
                            } else {
                                jQuery(elem).show();                    
                            }
                            return true;
                        }
                */
                var el = document.getElementById('cicBlock');
                if(el) {el.style.display='block';}
                //el = document.getElementById('giBlock');
                //if(el) {el.style.display='none';}
                
                
                          jQuery('.jPicker').mouseover(function() {
                                var siblingsx = jQuery(this).parent().children('input:first').attr('class');
                                var first_sibling_classx = siblingsx.split(' ')[0]; 
                                if(first_sibling_classx == "overlay_background_css"){
                                            jQuery('.overlay_background_cls').hide(400);
                                            jQuery('.overlay_background_cls').show(400);
                                } else if(first_sibling_classx == "overlay_text_css"){
                                            jQuery('.sub_category_description').effect("pulsate", { times:1 }, 1000);
                                } else if(first_sibling_classx == "sub_category_bg_css"){
                                            jQuery('.sub_category_hover').effect("pulsate", { times:1 }, 1000);
                                } else if(first_sibling_classx == "subcategory_heading_text_css"){ //Added by KR DE449
                                            jQuery('.sub_category_text_color').effect("pulsate", { times:1 }, 1000);
                                }
                            });
                
                          jQuery('.overlay_background_alpha').mouseover(function() {
                 
                                jQuery('.overlay_background_cls').hide(400);
                                jQuery('.overlay_background_cls').show(400);
                            }); 
                        
                                jQuery('.content_list_bg_preview').mouseover(function() {
                                jQuery('.Content_List_bg_cls').effect("pulsate", { times:1 }, 2000);
                            }); 
                           
                        
                                jQuery('.background-wrapper').mouseover(function() {
                                jQuery('.main_button_bg_cls').effect("pulsate", { times:1 }, 2000);
                            });  
                              
        
                            jQuery('.background-wrapper').mouseover(function() {
                                jQuery('.main_button_div_cls').effect("pulsate", { times:1 }, 2000);
                            });  
        
        
                         
                             jQuery('.category_image_preview').mouseover(function() {
                              jQuery('.subcategory_gallery_image').effect("pulsate", { times:1 }, 2000);
                            }); 
                            
                            //reverse highlighitng
                              jQuery('.category_l_bg_preview').mouseover(function() {
                              jQuery('.Category_Landscape_bg_cls').effect("pulsate", { times:1 }, 2000);
                            });  
                            
                            
                            
                              jQuery('.category_p_bg_preview').mouseover(function() {
                              jQuery('.Category_portrait_bg_cls').effect("pulsate", { times:1 }, 2000);
                            }); 
                        
                        
                          jQuery('.overlay_background_cls').mouseover(function() {
                              jQuery('.overlay_background_css').effect("pulsate", { times:1 }, 2000);
                              jQuery('.overlay_background_alpha').effect("pulsate", { times:1 }, 2000);
                            }); 
                             jQuery('.sub_category_description').mouseover(function() {
                              jQuery('.overlay_text_css').effect("pulsate", { times:1 }, 2000);
                            });  
                            jQuery('.sub_category_hover').mouseover(function() {
                              jQuery('.sub_category_bg_css').effect("pulsate", { times:1 }, 2000);
                            }); 
                            //Added by KR DE449
                            jQuery('.sub_category_text_color').mouseover(function() {
                              jQuery('.subcategory_heading_text_css').effect("pulsate", { times:1 }, 2000);
                            }); 
    
                    jQuery('.sub-category-tree-item').click(function(){
                               var s_s_cat = jQuery(this).next().attr('id');
                              
                               jQuery('.sub-category-tree-item').removeClass("sub_category_zoom_out");
                               jQuery('#Img_Iconl_'+s_s_cat).addClass("sub_category_zoom_in");
                               jQuery('.sub-category-tree-item').removeClass("sub_category_zoom_out");
                               jQuery('#Img_Icon_'+s_s_cat).addClass("sub_category_zoom_in");
                           
                      
                          jQuery('#Img_Iconl_'+s_s_cat).effect("pulsate", { times:2 }, 2000);
                         jQuery('#Img_Icon_'+s_s_cat).effect("pulsate", { times:2 }, 2000);
                           
                    });
                    
                    //MM dev Nov 9 work around for nicescroll stop working
                     jQuery('#tabContentLeftScroller').getNiceScroll().resize(); 
                     jQuery('#tabContentRightScroller').getNiceScroll().resize(); 
                     jQuery('#div_sub_category_description').niceScroll();        
            }
        
        
            function onCompleteSelectSubCategory(subCategId){
                rebindColorPickers();
        
                var showHide = jQuery('#scOut1');
                var showHide = jQuery('#scOut12');
                var showHide = jQuery('#scOut13');
                
                //jQuery("#cicBlock").hide();
                jQuery("#giBlock").show();
                //jQuery("#giBlock").show();
                jQuery('#giBlock').css("display","block");
                         
                
                var oldSrc = "/servlet/servlet.FileDownload?file=";
                var imageId;
                jQuery("input").each(function(i, elem){
                        if (jQuery(elem).attr('id').search('theHiddenImageId') != -1){
                                imageId = jQuery(elem).attr('value');
                        }
                });
                var newSrc = oldSrc + imageId;
                jQuery(".categoryImage").attr('src',newSrc);
                
                        jQuery(".sub_category_title_cls").keyup(function(){
                                    jQuery(".sub_cat_desc_title").html(jQuery('.sub_category_title_cls').val());
                            });
    
                        
                       jQuery(".sub_category_desc_cls").keyup(function(){
                       jQuery(".sub_cat_desc_text").html(jQuery('.sub_category_desc_cls').val());
                            });
                        jQuery('.sub_category_parent_cls').mouseover(function() {
                            jQuery('.custom-button').effect("pulsate", { times:1 }, 2000);
                        });  
                        
                        jQuery('.custom-button').mouseover(function() {
                            jQuery('.sub_category_parent_cls').effect("pulsate", { times:1 }, 2000);
                        }); 
                    
                         jQuery('.sub_cat_desc_title').mouseover(function() {
                          jQuery('.sub_category_title_cls').effect("pulsate", { times:1 }, 2000);
                        });  
                        jQuery('.sub_cat_desc_text').mouseover(function() {
                          jQuery('.sub_category_desc_cls').effect("pulsate", { times:1 }, 2000);
                        });
    
    
            //  This function will schedule a 'saveSubCategory()' call
            // every time any of the fields of the subCategory are
            // updated by the user.  The function cancels a
            // previous schedule if the fields are changed again
            // before the function is called.  This way there
            // aren't multiple calls scheduled at the same time.
            var saveSubCagetoryTimedFunction = function() {
                
                //  If we've already scheduled a call, we cancel it first...
                if(saveSubCategoryTimer) {
                    clearTimeout(saveSubCategoryTimer);
                }
                
                //  We schedule a new call to save the sub category's data
                // for 1 second (1000 ms) from now...
                saveSubCategoryId = subCategId;
                saveSubCategoryTimer = setTimeout(tmpSaveSubCategory, 1000);
                
                //  This bit makes sure that the item's name matches in the
                // category tree list.
                jQuery("#" + saveSubCategoryId + "_name").html( jQuery("[id$=subCategoryName]").val() );
            };
            
            jQuery("[id$=subCategoryDescription]").keyup(saveSubCagetoryTimedFunction);
            jQuery("[id$=subCategoryName]").keyup(saveSubCagetoryTimedFunction);
            jQuery("[id$=subCategoryOrder]").keyup(saveSubCagetoryTimedFunction);
            jQuery("[id$=subCategoryTodaysSpecial]").change(saveSubCagetoryTimedFunction);
            jQuery("[id$=selectParentCategory2]").change(saveSubCagetoryTimedFunction); 
            
            //MM dev Nov 9 work around for nicescroll stop working
            console.log('VF:Configurator:onCompleteSelectSubCategory():getNiceScroll().resize()' );
            jQuery('#tabContentLeftScroller').getNiceScroll().resize();
            jQuery('#tabContentRightScroller').getNiceScroll().resize();
            jQuery('#div_sub_category_description').niceScroll();
        }
        
        var saveSubCategoryTimer;
        var saveSubCategoryId;
        function tmpSaveSubCategory() {
            console.log("Updating server...");
            jQuery();
            saveSubCategory();
        }
    
        function onCompleteIsBundleCategory(){
            rebindColorPickers();
            jQuery('input[type=checkbox]').each(function(i, elem){  
                if (jQuery(elem).attr('id').search('bundleCheckbox') != -1){
                    if(!jQuery(elem).hasClass('isBundleCheckbox')){
                        jQuery(elem).addClass('isBundleCheckbox');
                    }
                }                   
            });
                            
            hideDivDialog('promptLoading'); 
                 
        }
        
        function encodeHTML(s){
            return s.replace(/</g, '&lt;').replace(/>/g, "&gt;").replace(/"/g, '&quot;').replace(/\'/g,'&#39');
        }
        
        function decodeHTML(s){
            return s.replace(/&amp;/g,'&');
        }
        
        function deleteCat(){   
            //event.preventDefault();
            showAsDialog('promptSubDelete');
        }
                    //  END: universal functions for DOM use
                </script>
                <div id="overlay-disable"></div>
        
        <apex:actionStatus id="ajax-status" onstart="showAsDialog('promptLoading');" onstop="hideDivDialog('promptLoading');">
            <apex:facet name="start">
                <div id="ajax-loader" style="position: fixed; top:3px; right:5px;" >
                    Loading...
                </div>
            </apex:facet>
        </apex:actionStatus>
        
    
        <div id="promptAddTopLevelCategory" class="hidden dialog">
            <apex:pageBlock title="Category">
            <div class="padding-box">        
                <table>
                    <tr><td class="column">
                        <apex:outputLabel value="Top Level Category Name" /><br/>
                    </td></tr>
                    <tr><td class="column">
                        <input type="text" id="new-top-level-cateogry-name"/>
                    </td></tr> 
                   <!--User for localization of DSA
                   
                   <tr><td class="column">
                        <apex:outputLabel value="Language" /><br/>
                    </td></tr>
                    <tr><td class="column">
                       <input type="text" id="new-top-level-cateogry-language"/>  -->
                                     
                </table>
                <br/>
                <div class="wrap">
                    <button class="btn" id="saveTopLevelCategory">Save</button>
                    <button class="btn" id="cancelAddTopLevelCategory">Cancel</button>
                </div>
            </div>            
            </apex:pageBlock>        
        </div>
        
        
        <div id="promptAddCategory" class="hidden dialog">
            <apex:pageBlock title="Category">
            <div class="padding-box">
                <apex:outputPanel id="promptAddCategoryPanel">         
                <table>
                    <tr><td class="column">
                        <apex:outputLabel value="Category Name" /><br/>
                    </td></tr>
                    <tr><td class="column">
                        <input type="text" id="cateogry-name"/>
                    </td></tr>
                    <tr><td class="column">
                        <apex:outputLabel value="Select Parent Category" /><br/>
                            <select id="selectParentCategory">
                            </select>         
                            <br/>
                            <br/>
                         
                    </td></tr>
                    <tr><td class="column">
                       
                    </td></tr>                         
                </table>
                </apex:outputPanel>
                <br/>
                <div class="wrap">
                    <button class="btn" id="saveCategory">Save</button>
                    <button class="btn" id="cancelAddCategory">Cancel</button>
                </div>
            </div>
            </apex:pageBlock>        
        </div>    
       
        <div id="promptDelete" class="hidden dialog">
            <apex:pageBlock title="Confirm">
                <div class="padding-box">
                    Are you sure you wish to delete this configuration?<br/><br/>
                    <div class="wrap"> 
                        <apex:form >
                        <apex:commandButton action="{!delete}" value="Delete"/>
                        <button class="btn" id="cancelDeleting">Cancel</button>
                        </apex:form>
                    </div>
                </div>
            </apex:pageBlock>        
        </div>
        
       <div id="openWarning" class="hidden dialog">
            <apex:pageBlock title="Error">
                <div class="padding-box">
                    The Mobile application you have selected is already open for editing. Please check with your team members. To override, uncheck the inEdit checkbox on the Mobile App Configuration.<br/><br/>
                    <div class="wrap"> 
                        <apex:form >
                            <button class="btn" id="cancelWarning">OK</button>
                        </apex:form>
                    </div>
                </div>
            </apex:pageBlock>        
        </div>
        
        <div id="promptSubDelete" class="hidden dialog">
            <apex:pageBlock title="Confirm">
                <div class="padding-box">
                    WARNING: This will delete the categeory from ALL mobile configurations IMMEDIATELY.<br/><br/>This action CANNOT be undone.  Proceed?<br/><br/>
                    <div class="wrap"> 
                        <apex:form >
                        <apex:commandButton action="{!deleteSubCategory}" value="Delete"/>
                        <button class="btn" id="cancelSubDeleting">Cancel</button>
                        </apex:form>
                    </div>
                </div>
            </apex:pageBlock>        
        </div>
    
        <div id="promptOtherActive" class="hidden dialog">
            <apex:pageBlock title="Warning">
                <div class="padding-box">        
                    Another active configuration was found. Do you want to make this the new active configuration?<br/><br/>
                    <div class="wrap"> 
                        <button class="btn" id="changeActiveConfiguration">OK</button>            
                        <button class="btn" id="cancelActiveConfiguration">Cancel</button>
                    </div>
                </div>
            </apex:pageBlock>        
        </div>
    
        <div id="promptOtherDefault" class="hidden dialog">
            <apex:pageBlock title="Warning">
                <div class="padding-box">        
                    Another category config is currently used as the default config. Do you want to change to this one?<br/><br/>
                    <div class="wrap"> 
                        <button class="btn" id="changeDefaultConfiguration">OK</button>            
                        <button class="btn" id="cancelDefaultConfiguration">Cancel</button>
                    </div>
                </div>
            </apex:pageBlock>        
        </div>
                                    
        <div id="promptError" class="hidden dialog">
            <apex:pageBlock title="Error">
                <div class="padding-box">
                    <table>
                        <tr><td>
                            <span id="error-msg"></span>
                        </td></tr>                
                        <tr><td>
                            <span id="error-msg-nofity" class="hint"></span>
                        </td></tr>       
                    </table>
                    <br/>          
                    <div class="wrap"> 
                        <button class="btn" id="closeError">Close</button>            
                    </div>
                </div>
            </apex:pageBlock>        
        </div>    
        
        <div id="promptLoading" class="hidden dialog">
            <apex:pageBlock title="Processing">
                <div class="padding-box">        
                    <div class="loading-text">
                        <img src="{!URLFOR($Resource.Barclays_SA__loading)}"/><br/>
                        Please wait...            
                    </div>
                </div>
            </apex:pageBlock>        
        </div> 
               
        <div id="promptZoom" class="hidden dialog promptZoomcls">
            <apex:pageBlock title="Zoom">
                <div class=" padding-box">
                   <button class="btn zoom-cancel-button" style="position:relative;" id="doneZoom"><span style="position:relative;top:-1px;left:1px;">X</span></button>
                    <div id="zoom-layout-customizer" class="compositor-zoom">
                     
                    </div>
                </div>            
            </apex:pageBlock>        
        </div>

            <script type="text/javascript">
                var currentStandingButton= 'brand2';
                var refreshed=0;
                function onPageLoad(){
                    showAsDialog('promptLoading');
                
                    ShowLandscapePreview_Category();    
                    ShowLandscapePreview();
                    hideDivDialog('promptLoading');  
                }
                    
                 //Please replace this Javascript code to Jquery Show() and hide(): this will reduce lot of lines
                        
                function ShowLandscapePreview_Category(){
                    
                    document.getElementById("category_landscape_background").style.display="block";
                    document.getElementById("category_Portrait_background").style.display="none";
                    document.getElementById("Category_landscape_switch_active").style.display="block";
                    document.getElementById("Category_landscape_switch_inactive").style.display="none";
                    document.getElementById("Category_portrait_switch_active").style.display="none";
                    document.getElementById("Category_portrait_switch_inactive").style.display="block";
                }
                
                function ShowPortraitPreview_Category(){
                    
                    document.getElementById("category_Portrait_background").style.display="block";
                    document.getElementById("category_landscape_background").style.display="none";
                    document.getElementById("Category_landscape_switch_active").style.display="none";
                    document.getElementById("Category_landscape_switch_inactive").style.display="block";
                    document.getElementById("Category_portrait_switch_active").style.display="block";
                    document.getElementById("Category_portrait_switch_inactive").style.display="none";
                 
                }
                
                function ShowLandscapePreview(){
                   
                    document.getElementById("tabLandscape1").style.padding="0px";
                    document.getElementById("tabLandscape1").style.display="block";
                    document.getElementById("tabPortrait").style.display="none";
                    document.getElementById("landscape_switch_active").style.display="block";
                    document.getElementById("landscape_switch_inactive").style.display="none";
                    document.getElementById("portrait_switch_active").style.display="none";
                    document.getElementById("portrait_switch_inactive").style.display="block";
                 
                }
                function ShowPortraitPreview(){
                 
                    document.getElementById("tabPortrait").style.padding="0px";
                    document.getElementById("tabLandscape1").style.display="none";
                    document.getElementById("tabPortrait").style.display="block";
                    document.getElementById("landscape_switch_active").style.display="none";
                    document.getElementById("landscape_switch_inactive").style.display="block";
                    document.getElementById("portrait_switch_active").style.display="block";
                    document.getElementById("portrait_switch_inactive").style.display="none";
                 
                }
                
                function updateNumberImage(num){
                
                    jQuery(".active_number").removeClass("active_number").addClass("inactive_number");
                    jQuery("#number_"+num).toggleClass('active_number inactive_number');
                   
                    if(num != 4){
                       rebindColorPickers();
                    }
                }
                
                function refreshImageButton() {
                    setTimeout(function(){jQuery('.imgButton').trigger('load')}, 1);
                }
                    
                function saveToDraftDebug() {
                     
                   // var configlanguage           = jQuery('.tmp_config_language option:selected').val();
                    var titleText                = jQuery('input.tmp_title_text').val();
                    var titleBgColor             = jQuery('input.tmp_title_bg_color').val();
                    var titleTextColor           = jQuery('input.tmp_title_text_color').val();
                    var titleTextAlpha           = jQuery('input.tmp_title_text_alpha').val();
                    var introText                = jQuery('input.tmp_intro_text').val();
                    var introTextColor           = jQuery('input.tmp_intro_text_color').val();
                    var introTextAlpha           = jQuery('input.tmp_intro_text_alpha').val();
                    var buttonTextColor          = jQuery('input.tmp_button_text_color').val();
                    var buttonTextAlpha          = jQuery('input.tmp_button_text_alpha').val();
                    var buttonHighlightTextColor = jQuery('input.tmp_button_highlight_text_color').val();
                   
                    saveToDraft( titleText, titleBgColor, titleTextColor, titleTextAlpha, introText, introTextColor, introTextAlpha, buttonTextColor, buttonTextAlpha, buttonHighlightTextColor);
                }
                
                function saveToDraftDebugprofile() {
                       
                    var isActiveConfig           = jQuery('input.tmp_is_active_config').is(':checked');
                    var SelectedProfilesString   = jQuery('select.tmp_profile_list').val().join(';');
                    var checkInEnabled           = jQuery('input.tmp_check_in_enabled').is(':checked');
                    saveToDraftProfile(isActiveConfig, SelectedProfilesString, checkInEnabled);
                }
                
                              
                function Clicked_navigation(){
                    //MM dev Nov 8 fixing button text align
                    //Raj Commented 01/03
                    //filterByButtonTextAlignField();
                    setTimeout(function() {
                        jQuery(".switch_CategoryConfig").get(0).click();
                    }, 500);
                    
                /*
                jQuery('input.Ok').live('click',function() {
                            jQuery('.sub_category_description').css({"color":"#"+jQuery('.overlay_text_css').val()});
                              jQuery('.overlay_background_cls').css({"background-color":"#"+jQuery('.overlay_background_css').val()});
                              jQuery('.sub_category_hover').css({"background-color":"#"+jQuery('.subcategory_background_css').val()});
                )};
                }*/
                }   
                
                function theme_color_clicked(){
                
                rebindColorPickers();
                jQuery('.theme_class').load(function() {
                  // Handler for .load() called.
                  rebindColorPickers();
                });
                
                }
       
                function next_theme(){
                jQuery(".next_brand").trigger('click');
                }
                
            </script>
        </head>
        <apex:form >
            <apex:pageBlock id="saveTmp"></apex:pageBlock>
            <apex:pageBlock id="saveTmpProfile"></apex:pageBlock>
            <apex:actionFunction action="{!saveToDraft}" name="saveToDraft" reRender="saveTmp">
                <apex:param name="titleText" assignTo="{!mobileAppConfigTemp.Barclays_SA__TitleText__c}" value="" />
                <apex:param name="titleBgColor" assignTo="{!mobileAppConfigTemp.TitleBgColor__c}" value="" />
                <apex:param name="titleTextColor" assignTo="{!mobileAppConfigTemp.TitleTextColor__c}" value="" />
                <apex:param name="titleTextAlpha" assignTo="{!mobileAppConfigTemp.TitleTextAlpha__c}" value="" />
                <apex:param name="introText" assignTo="{!mobileAppConfigTemp.IntroText__c}" value="" />
                <apex:param name="introTextColor" assignTo="{!mobileAppConfigTemp.IntroTextColor__c}" value="" />
                <apex:param name="introTextAlpha" assignTo="{!mobileAppConfigTemp.IntroTextAlpha__c}" value="" />
                <apex:param name="buttonTextColor" assignTo="{!mobileAppConfigTemp.Barclays_SA__ButtonTextColor__c}" value="" />
                <apex:param name="buttonTextAlpha" assignTo="{!mobileAppConfigTemp.Barclays_SA__ButtonTextAlpha__c}" value="" />
                <apex:param name="buttonHighlightTextColor" assignTo="{!mobileAppConfigTemp.Barclays_SA__ButtonHighlightTextColor__c}" value="" />
                
            </apex:actionFunction>
            
            
            <apex:actionFunction action="{!saveToDraftProfile}" name="saveToDraftProfile" reRender="saveTmpProfile">
             <apex:param name="isActiveConfig" assignTo="{!mobileAppConfigTemp.Barclays_SA__Active__c}" value="" />
                <apex:param name="SelectedProfilesString" assignTo="{!SelectedProfilesString}" value="" />
                <apex:param name="checkInEnabled" assignTo="{!mobileAppConfigTemp.Barclays_SA__Check_In_Enabled__c}" value="" />
            </apex:actionFunction>
        </apex:form>
        
        <body> 
        <!--<body onLoad="alreadyOpen()" > -->
        <apex:form id="form1">
        <script type="text/javascript" >
            window.onload = new function()
            {
                if({!!active})
                {
                    //don't mark inEdit false on browser close if we're not the one editing
                    doCleanup=false;
                    showAsDialog('openWarning')
                }
            }
        </script>
            <!-- Called onBeforeUnload to cleanup temp docs-->
            <apex:actionFunction action="{!init}" name="initializeDSA" />
            <apex:actionFunction action="{!cancelEdit}" name="browserClose" />
            <apex:actionFunction action="{!cancelMultipleOpen}" name="warningAndWindowClose" />
            <!--  -->
            <div id="mainFrame">
                <div id="mainHeader" class="dsa_builder_header"
                    style="background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/images_v4/Header_Bar_1pixel.png')}');
                    background-repeat:repeat-x;
                    height:48px;">
                    <img style="left:8px;
                        height: 54px;
                        position: relative; 
                        top: -2px;"
                        src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/SalesforceServicesLogo.png')}"
                        alt="MM DSA" />
                    <img style="left:13px;
                        position: relative;
                        top: -7px;"
                        src="{!URLFOR($Resource.DSA_Assets, 'images/images_v7/break.png')}"
                        alt="MM DSA" />
                    <img style="left:35px;
                        position: relative;
                        top: -10px;"
                        src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/DSA-Builder-Logo.png')}"
                        alt="MM DSA" />
                        <p style="position:relative;top:-48px;right:20px;left:-10px;font-family: Verdana;font-size:16px;text-align:right;color:#707070;">Welcome {!$User.FirstName}!</p>
                </div>
                <div id="tabButtons" style="background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/Gray_Rectangle.png')}'); background-repeat:repeat-x;height: 48px;">
                    <div style="display:inline;position:absolute; right:10px; padding-top:1.5px;">
                        <apex:outputPanel rendered="{!active}" >
                            <apex:commandButton onclick="saveToDraftDebug()" styleclass="main_button_save" action="{!saveAll}" value="Save"/>
                            <div style="display:inline;width:4px;"></div>
                            <apex:commandButton action="{!cancelEdit}" styleclass="main_button_delete" value="Cancel"/>
                            <button class="main_button_delete btn deleteButton" id="deleteButton2">Delete</button>
                            <apex:messages styleClass="errorMessagesList" />       
                        </apex:outputPanel>             
                   </div>
                   <table cellspacing="0px">
                        <tr>
                            <!-- Tab #1 tab graphic -->
                            <td id="tabHeader_1"
                                class="customTabHeader BGactive select_home_preview" onclick="window.doTabClick(1);">
                                <div class="customTabHeaderInner colorsTab active"></div>
                            </td>
                            <td class="vertical_image"></td>
                            <!-- Tab #2 tab graphic -->
                            <td id="tabHeader_2"
                                class="customTabHeader select_home_preview " onclick="window.doTabClick(2);">
                                <div class="customTabHeaderInner brandTab">
                                    
                                </div>
                            </td>
                            <td class="vertical_image"></td>
                            <!-- Tab #3 tab graphic -->
                            <td id="tabHeader_3"
                                class="customTabHeader select_home_preview "
                                onclick="window.doTabClick(3);" >
                                <div class="customTabHeaderInner buttonsTab">
                                </div>
                            </td>
                            <td class="vertical_image"></td>
                            <!-- Tab #4 tab graphic -->
                            <td id="tabHeader_4"
                                class="customTabHeader "
                                onclick="Clicked_navigation();window.doTabClick(4);">
                                <div class="customTabHeaderInner categoriesTab">
                                   
                                </div>
                            </td>
                            <td class="vertical_image"></td>
                            <!-- Tab #5 tab graphic -->
                            <td id="tabHeader_5"
                                class="customTabHeader select_home_preview"
                                onclick="window.doTabClick(5);">
                                <div class="customTabHeaderInner settingTab">
                                    
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <table id="tabContent" style="background-image:url('{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/BG_Pixel.png')}'); width:100%;">
                    <tr>
                        <td id="tabContentLeft" Style="" class="scroll-left-div">
                            <div id="tabContentLeftScroller" style="overflow-x:hidden;overflow-y:auto;">
                         <!-- START: Put all content here that you want to be scrollable on the left -->
                                
                            <!-- START: Tab #1 content -->
                            <!-- HOME-->
                                <div id="tabContent_1" class="scroll-left-div">
                                    
                                    <!--
                                    <div class="user-panel">
                                        <div class="user-panel-title-text"><div style="display:inline;" class="circular_pointer"> </div>Intro</div>
                                        <div class="user-panel-content intro_text_div_cls">
                                            <table class="colorTable">
                                                <tr>
                                                    <td><apex:outputLabel value="Intro Text Color  " /></td>
                                                    <td><apex:outputLabel value="Opacity" /></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField value="{!mobileAppConfigTemp.IntroTextColor__c}" id="introTextPickColor" styleClass="tmp_intro_text_color"/></td>
                                                    <td><apex:inputField value="{!mobileAppConfigTemp.IntroTextAlpha__c}" id="introTextAlpha" styleClass="tmp_intro_text_alpha"/> %</td>
                                                </tr>
                                            </table>
                                            <div id="slider_intro_container" class='hiding-slider' style='display:none; position:absolute; width:370px; z-index:3; margin-top: -20px; margin-left: -10px;'>
                                                <img src="{!URLFOR($Resource.DSA_Assets, 'images/SliderBackground.png')}" style="position:absolute;"></img>
                                                <div id="slider_intro" class="tmp_intro_text_alpha" style="top: 55px; left: 25px;"/>
                                            </div>
                                        </div>
                                    </div>
                                    -->
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Main Buttons</div>
                                        <div class="user-panel-content main_button_div_cls">
                                            <table class="colorTable">
                                                <tr>
                                                    <td><apex:outputLabel value="Button Text Color" /></td>
                                                    <td><apex:outputLabel value="Opacity" /></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField value="{!mobileAppConfigTemp.Barclays_SA__ButtonTextColor__c}" id="buttonTextPickColor" styleClass="tmp_button_text_color"/></td>
                                                    <td><apex:inputField value="{!mobileAppConfigTemp.Barclays_SA__ButtonTextAlpha__c}" id="buttonTextAlpha" styleClass="tmp_button_text_alpha"/> %</td>
                                                </tr>
                                            </table>
                                            <div id="slider_button_container" class='hiding-slider' style='display:none; position:absolute; width:370px; z-index:3; margin-top: -20px; margin-left: -10px;'>
                                                <img src="{!URLFOR($Resource.DSA_Assets, 'images/SliderBackground.png')}" style="position:absolute;"></img>
                                                <div id="slider_button" class="tmp_button_text_alpha" style="top: 55px; left: 25px;"/>
                                            </div>
                                            <table class="colorTable">
                                                <tr>
                                                    <td><apex:outputLabel value="Button Highlight Text Color" /></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField value="{!mobileAppConfigTemp.Barclays_SA__ButtonHighlightTextColor__c}" id="buttonHighlightTextPickColor" styleClass="tmp_button_highlight_text_color tmp_button_text_color"/></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            <!-- END: Tab #1 content -->
                                
                            <!-- START: Tab #2 content -->
                            <!-- BRAND-->
                                <div id="tabContent_2" style="display:none;" class="scroll-left-div">

                                    <div class="user-panel">
                                        <div class="user-panel-title-text" >Application Title</div>
                                        <div class="user-panel-content">
                                            <div class="wrap">
                                                <apex:outputLabel value="Application Title Text"/><br/>
                                                <apex:inputField value="{!mobileAppConfigTemp.Barclays_SA__TitleText__c}" styleClass="tmp_title_text"/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Logo</div>
                                        <div class="user-panel-content">
                                            <div class="wrap">          
                                                <apex:outputLabel value="Logo Image" /><br/><br/>
                                                
                                                <apex:inputFile filename="{!logoImage.name}" value="{!logoImage.body}" styleclass="logo_input_file_cls" ></apex:inputFile>
                                                <apex:commandbutton action="{!uploadLogoImage}" value="Upload" styleclass="button_upload" /><br/>
                                                <apex:outputLabel value="Ideal Image Resolution: 150x29" styleClass="hint" /><br/><br/>
                                            </div>Preview:<apex:outputLabel value="{!logoAttachmentName}"/>
                                            <div class="wrap preview-logo">
                                                <apex:image id="logoImage" rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="width:150px;height:29px;"/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Background Image for Landscape Orientation</div>
                                        <div class="user-panel-content">
                                            <div class="wrap">
                                                <apex:outputLabel value="Upload Image Landscape" /><br/><br/>
                                                <apex:inputFile value="{!landscapeImage.body}" filename="{!landscapeImage.name}" styleclass="main_Landscape_background" />
                                                <apex:commandbutton action="{!uploadLandscapeImage}"  value="Upload" styleclass="button_upload"/><br/>
                                                <apex:outputLabel value="Landscape background image resolution: 2048x1536px" styleClass="hint" /><br/>
                                                <br/>
                                                <apex:outputLabel value="{!landscapeBackgroundAttachmentName}"/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Background Image for Portrait Orientation</div>
                                        <div class="user-panel-content">   
                                            <div class="wrap">
                                                <apex:outputLabel value="Upload Image Portrait" /><br/><br/>
                                                <apex:inputFile value="{!portraitImage.body}" filename="{!portraitImage.name}" styleclass="main_portrait_background" />
                                                <apex:commandbutton action="{!uploadPortraitImage}" value="Upload" styleclass="button_upload"/ ><br/>
                                                <apex:outputLabel value="Portrait background image resolution: 1536x2048px" styleClass="hint" /><br/>
                                                <br/>
                                                <apex:outputLabel value="{!portraitBackgroundAttachmentName}"/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="wrap" style="visibility:hidden;">          
                                        <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Check_In_Enabled__c}" styleClass="tmp_check_in_enabled"/>
                                        <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Active__c}" styleClass="tmp_is_active_config"/>
                                        <apex:selectList value="{!selectedProfiles}" multiselect="true" size="0" styleClass="tmp_profile_list">
                                            <apex:selectOptions value="{!profileList}"/>
                                        </apex:selectList>
                                    </div>
                                    
                                </div>
                            <!-- END: Tab #2 content -->
                                
                            <!-- START: Tab #3 content -->
                            <!-- BUTTONS-->
                                <div id="tabContent_3" style="display:none;" class="scroll-left-div">
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Landing Page Layout</div>                           
                                        <div class="user-panel-content">
                                            <div class="wrap">Select category name to add/remove from layout</div>
                                            <apex:selectList size="10" id="landscapeCategoryList" styleclass="Landing_page_layout_cls scrollSelectList">
                                                <apex:selectOptions value="{!categoriesOptions}"/>
                                            </apex:selectList><br/>
                                            <button class="btn addTopLevelCategory sub_button_save" style="font-size:12px!important;">Add New Category</button>
                                            
                                        </div>
                                    </div>
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Main Button</div>
                                        <div class="user-panel-content">
                                            <div class="wrap">          
                                                <apex:outputLabel value="Main Button Image" /><br/><br/>
                                                <apex:inputFile value="{!mainButtonImage.body}" filename="{!mainButtonImage.name}" styleclass="main_button_bg_cls"  />
                                                <apex:commandbutton action="{!uploadMainButtonImage}" value="Upload" styleclass="button_upload"/>
                                            </div>Preview:<apex:outputLabel value="{!defaultButtonAttachmentName}"/><br/>
                                            <div class="wrap preview">
                                                <apex:image rendered="{!mobileAppConfigTemp.Barclays_SA__ButtonDefaultAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__ButtonDefaultAttachmentId__c}" style=""/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Main Button Selected</div>
                                        <div class="user-panel-content">
                                            <div class="wrap">          
                                                <apex:outputLabel value="Main Button Highlight Image" /><br/><br/>
                                                <apex:inputFile value="{!mainButtonHighlightImage.body}" filename="{!mainButtonHighlightImage.name}" styleclass="main_button_bg_cls" />
                                                <apex:commandbutton action="{!uploadMainButtonHighlightImage}" value="Upload" styleclass="button_upload"/>
                                            </div>Preview:<apex:outputLabel value="{!highlightedButtonAttachmentName}"/><br/>
                                            <div class="wrap preview">
                                                <apex:image id="imgHighlightButton" rendered="{!mobileAppConfigTemp.Barclays_SA__ButtonHighlightAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__ButtonHighlightAttachmentId__c}" style=""/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            <!-- END: Tab #3 content -->
                                
                            <!-- START: Tab #4 content -->
                            <!-- CATEGORIES-->
                                <div id="tabContent_4" style="display:none;" class="scroll-left-div">
                                
                                    <apex:actionRegion >
                                        <apex:actionFunction action="{!selectCategoryMobileConfig}" 
                                                             name="selectCategoryMobileConfig" 
                                                             reRender="thesettingpanel,thePanel,thePanel2,cmcOut1,scOut1,scOut12,scOut13,cmcOut2,cmcOut3,cmcOut4,cmcOut5,cmcOut6,cmcBck1,cmcBck2,cmcContImg1,cmcContImg2,thePanel_category_desc_l,thePanel_category_desc_p"
                                                             oncomplete="onCompleteSelectCategory();"
                                                             status="ajax-status">
                                            <apex:param name="categoryMobileConfigId" assignTo="{!categoryMobileConfigId}" value="" />
                                        </apex:actionFunction>                                   

                                        <apex:actionFunction action="{!selectCategoryAndCMC}" 
                                                             name="selectCategoryAndCMC" 
                                                             reRender="thesettingpanel,thePanel,thePanel2,cmcOut1,scOut1,scOut12,scOut13,cmcOut2,cmcOut3,cmcOut4,cmcOut5,cmcOut6,cmcBck1,cmcBck2,cmcContImg1,cmcContImg2,thePanel_category_desc_l,thePanel_category_desc_p"
                                                             oncomplete="onCompleteSelectCategory();onCompleteSelectSubCategory('{!categoryId}');initializeButtons();"
                                                             status="ajax-status">
                                            <apex:param name="categoryMobileConfigId" assignTo="{!categoryMobileConfigId}" value="" />
                                            <apex:param name="categoryId" assignTo="{!categoryId}" value="" />
                                        </apex:actionFunction>

                                        <apex:actionFunction action="{!selectSubCategory}" 
                                                             name="selectSubCategory" 
                                                             reRender="thePanel,thePanel2,thePanel_category_desc_l,thePanel_category_desc_p,cmcBck1,cmcBck2,cmcContImg1,cmcContImg2"
                                                             oncomplete="onCompleteSelectSubCategory('{!categoryId}');"
                                                             status="ajax-status">
                                            <apex:param name="categoryId" assignTo="{!categoryId}" value="" />
                                        </apex:actionFunction>
                                        
                                        <apex:actionFunction action="{!deleteSubCategoryById}" 
                                                             name="deleteSubCategoryById"
                                                             oncomplete=""
                                                             status="ajax-status">
                                            <apex:param name="deleteId" assignTo="{!deleteId}" value="" />
                                        </apex:actionFunction>
                                    
                                        <apex:actionFunction action="{!saveSubCategory}" 
                                                             name="saveSubCategory"
                                                             oncomplete=""
                                                             status="ajax-status">
                                        </apex:actionFunction>

                        
                                        <apex:pageBlock id="pb1">
                                            <div class="user-panel">
                                                <div class="user-panel-title-text">Categories</div>                         
                                                <div class="user-panel-content-ctree " style="color:#black !important;">                
                            
                                                    <div class="wrap">
                                                        <button class="main_button_save addCategory left" style="width: auto !important; height:28px !important;">Add New Sub-Category</button>                      
                                                   <!-- <button id="collapseCategoryTree" class="expand_collapse_button right">-</button>
                                                        <button id="expandCategoryTree" class="expand_collapse_button right">+</button>
                                                   -->
                                                    </div>
                                                    <div id="category-tree" class="category-tree-holder">
                                                        <ul id="tree"></ul>
                                                    </div>
                                                </div>
                                            </div>          
                                                    
                                                <div class="user-panel">  
                                                    <apex:outputpanel id="thesettingpanel">
                                                        <div class="user-panel-title-text">Selected Category: {!categoryMobileConfig.CategoryId__r.Name}</div>                
                                                    </apex:outputpanel>
                                                    
                                                    <div class="user-panel-content"> 
                                            
                                                        <apex:outputPanel id="thePanel">
                                                        
                                                            <apex:panelGrid columns="3" id="cmcOut6">
                                                                <apex:commandButton action="{!saveCMC}" styleclass="sub_button_save" value="Save"/>  
                                                                 <!-- <button class="btn sub_button_delete" id="cancelButton">Cancel</button>-->
                                                                <button class="btn sub_button_delete deleteSufbButton" onclick="deleteCat();return false;">Delete</button> 
                                                                <!-- temporarly removed this button <button class="btn" id="deleteButton">Delete</button> -->
                                                            </apex:panelGrid>
                                                            <br/>
                                                            
                                                            <apex:panelGrid columns="2" id="cmcOut1" styleClass="colorTable">
                                                                <apex:outputLabel value="Category Name" />
                                                                <apex:outputLabel value="Button Text Align" />
                                                                <apex:inputtext value="{!categoryMobileConfig.CategoryId__r.Name}"  disabled="true" id="categoryName"/>                                    
                                                                <table style="background-color:#293037;" ><tr>
                                                                    <td id="buttonAlignRight" style="{!If(categoryMobileConfig.Button_Text_Align__c == 'Right','background-color:rgba(245, 245, 245, 0.6);width:22px; height:23px;float:right;','width:22px; height:23px;float:right;')}"><img class="cont_left_align" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/right_J.png')}" style="float:center;width:26px; height:23px;"></img></td>
                                                                    <td id="buttonAlignCenter"  style="{!If(categoryMobileConfig.Button_Text_Align__c == 'Center','background-color:rgba(245, 245, 245, 0.6);width:22px; height:23px;float:right;','width:22px; height:23px;float:right;')}"><img class="cont_centre_align" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/center_j.png')}" style="float:center;width:26px; height:23px;"></img></td>
                                                                    <td id="buttonAlignLeft"  style="{!If(categoryMobileConfig.Button_Text_Align__c == 'Left','background-color:rgba(245, 245, 245, 0.6);width:22px; height:23px;float:right;','width:22px; height:23px;float:right;')}"><img class="cont_right_align" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx6/left_j.png')}" style="float:center;width:26px; height:23px;"></img></td>
                                                                </tr></table>
                                                                    <apex:inputhidden value="{!categoryMobileConfig.Barclays_SA__Button_Text_Align__c}" id="Button_text_align"/>
                                                                <!--  apex:selectList id="buttonTextAlign" value="{!categoryMobileConfig.Barclays_SA__Button_Text_Align__c}" style="width: 100px;" size="1" styleClass="buttonTextAlignSelectUni">
                                                                    <apex:selectOption itemValue="Left" itemLabel="Left"/>
                                                                    <apex:selectOption itemValue="Center" itemLabel="Center"/>
                                                                    <apex:selectOption itemValue="Right" itemLabel="Right"/>
                                                                </apex:selectList-->
                                                               <!-- -->
                                                            </apex:panelGrid>
                                    
                                                            <apex:panelGrid columns="1" id="cmcOut12" styleClass="colorTable" rendered="{!(categoryMobileConfig.Barclays_SA__UseCategoryBundle__c)}">
                                                                <apex:outputLabel id="labelBundle" value="Bundle Content Id" />
                                                                <apex:inputField id="bundleValue" value="{!categoryMobileConfig.Barclays_SA__CategoryBundleId__c}"/>
                                                            </apex:panelGrid>
                                                            
                                                            <apex:panelGrid columns="2" id="cmcOut2" styleClass="colorTable" rendered="{!(!categoryMobileConfig.Barclays_SA__UseCategoryBundle__c)}">
                                                                <apex:outputLabel value="Overlay Background Color" />
                                                                <apex:outputLabel value="Opacity" />
                                                                <apex:inputField value="{!categoryMobileConfig.Barclays_SA__OverlayBgColor__c}" id="overlayBackgroundPickColor" styleclass="overlay_background_css"/>
                                                                <apex:pageBlockSection ><apex:inputText value="{!categoryMobileConfig.Barclays_SA__OverlayBgAlpha__c}" size="3" styleclass="overlay_background_alpha" id="overlayBackgroundAlpha" rendered="{!$ObjectType.Barclays_SA__CategoryMobileConfig__c.fields.Barclays_SA__OverlayBgAlpha__c.Updateable}"/>%</apex:pageBlockSection>
                                                            </apex:panelGrid>
                                                            
                                                            <div style="min-wdith:120px;" id="slider_overlay"></div>
                                                            <apex:panelGrid columns="1" id="cmcOut3" styleClass="colorTable" rendered="{!(!categoryMobileConfig.Barclays_SA__UseCategoryBundle__c)}">
                                                                <apex:outputLabel value="Overlay Text Color" />
                                                                 <apex:inputField value="{!categoryMobileConfig.Barclays_SA__OverlayTextColor__c}" id="overlayTextPickColor" styleclass="overlay_text_css"/>
                                                                <apex:outputlabel value="Navigation Area: Background Color"/>
                                                               <apex:inputField value="{!categoryMobileConfig.Barclays_SA__Sub_Category_Background_Color__c}" id="subcategoryPickColor" styleclass="sub_category_bg_css subcategory_background_css"/>
                                                            </apex:panelGrid>
                            
                                                            <apex:panelGrid columns="2" id="cmcOut4" rendered="{!(!categoryMobileConfig.Barclays_SA__UseCategoryBundle__c)}">
                                                                <apex:outputLabel value="Gallery/Subcategory Heading" />
                                                                <apex:inputField value="{!categoryMobileConfig.Barclays_SA__GalleryHeadingText__c}" styleclass="subcategory_heading" />
                                                            </apex:panelGrid> 
                                                            
                                                            <apex:panelGrid columns="1" id="cmcOut5" rendered="{!(!categoryMobileConfig.Barclays_SA__UseCategoryBundle__c)}">
                                                                <apex:outputLabel value="Gallery/Subcategory Heading Text Color" />
                                                                <apex:inputField value="{!categoryMobileConfig.Barclays_SA__GalleryHeadingTextColor__c}" id="galleryHeadingTextPickColor" styleclass="subcategory_heading_text_css" />
                                                            </apex:panelGrid> 
                                                                                                                                             
                                                        </apex:outputPanel>
                                
                                                        <apex:outputPanel id="thePanel2">
                                                            <apex:panelGrid id="scOut1" styleClass="colorTable">
                                                                <apex:inputHidden value="{!selectedCategoryImageId}" id="theHiddenImageId"/>
                                                             <!--  Removed as requested for task: WP80 -->
                                                             <!-- <apex:outputLabel value="Category Name" />
                                                             <apex:inputField value="{!selectedCategory.Name}" id="subCategoryName" styleclass="sub_category_title_cls"/>  -->
                                                            </apex:panelGrid>
                                                            <apex:panelGrid columns="2" id="scOut12" styleClass="colorTable">     
                                                                
                                                                <apex:outputLabel value="Category Order" />
                                                                <apex:outputLabel value="Today's Special" />
                                                                <apex:inputField value="{!selectedCategory.Barclays_SA__Order__c}" id="subCategoryOrder" styleclass="sub_category_title_cls" style=" width: 40px;"/>
                                                               <apex:inputField value="{!selectedCategory.Barclays_SA__Todays_Special__c}" id="subCategoryTodaysSpecial" styleclass="sub_category_title_cls"/>
                                                                
                                                            </apex:panelGrid>    
                                                            <apex:panelGrid id="scOut13" styleClass="colorTable">     
                                                                <apex:outputLabel value="Category Description" />
                                                                <apex:inputTextarea value="{!selectedCategory.Barclays_SA__Description__c}" id="subCategoryDescription" styleclass="sub_category_desc_cls" cols="35" rows="4"/>
                                                                <br/>
                                                                <apex:outputLabel value="Select Parent Category" />
                                                                <apex:selectList id="selectParentCategory2" value="{!newParentCatForSubcategory}" size="1" styleclass="sub_category_parent_cls"> 
                                                                    <apex:selectOptions value="{!parentCategoriesList}"/>
                                                                </apex:selectList> 
                                                                <!--Added Auto save and delete-image-button on the subcategory for the below:No cancel function.
                                                                
                                                                <apex:panelGrid columns="3">
                                                                    <apex:commandButton action="{!saveSubCategory}" styleclass="sub_button_save" value="Save"/>
                                                                    <apex:commandButton styleClass="cancelButton sub_button_save" action="{!cancelEditSubCategory}" value="Cancel" />
                                                                    
                                                                    <input onclick="showAsDialog('promptSubDelete');" type="button" class="deleteSubButton sub_button_delete" value="Delete" /> 
                                                                </apex:panelGrid>-->
                                                            </apex:panelGrid>
                                                        </apex:outputPanel>
                                
                                                    </div>                                                
                                                </div>
                                                <!-- newly added divs for adding sub cat information-->
                                            </apex:pageBlock>
                                        </apex:actionRegion>
                                        <div class="wrap" style="display: none;">          
                                            <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Check_In_Enabled__c}"   styleClass="tmp_check_in_enabled"/>
                                            <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Active__c}"   styleClass="tmp_is_active_config"/>
                                            <apex:selectList value="{!selectedProfiles}" multiselect="true" size="0" styleClass="tmp_profile_list">
                                                <apex:selectOptions value="{!profileList}"/>
                                            </apex:selectList>
                                        </div> 
                                         <!--   <div>     -->     
                                            <!--  <div id="sub_category_selected" Style="position:relative;top:-69px;">-->
                                                <div id="giBlock" style="display:{!HTMLENCODE(giupload)};">
                                                    <div class="user-panel">
                                                        <div class="user-panel-title-text" >Sub-Category Gallery Image</div>                                     
                                                        <div class="user-panel-content">           
                                                            <apex:outputLabel value="Gallery Category Image" /><br/><br/>
                                                            <apex:inputFile value="{!galleryCategoryImage.body}" filename="{!galleryCategoryImage.name}" styleclass="subcategory_gallery_image" />
                                                            <apex:commandbutton action="{!uploadGalleryCategoryImage}" value="Upload" styleclass="button_upload"/><br/>
                                                            <apex:outputLabel value="Category background image resolution: 136x136px at 132dpi" styleClass="hint" /><br/><br/>
                                                            <br/><br/>   
                                                            <apex:panelGrid style="width:136px; height: 136px;padding-bottom: 70px;" columns="1" id="giPreview" border="0" cellspacing="0px" cellpadding="0px">
                                                                <apex:image styleClass="categoryImage" style="width:136px; height: 136px;" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!selectedCategoryImageId}" />
                                                            </apex:panelGrid>  
                                                        </div>
                                                    </div>                                                      
                                                </div>
                                            <!--  </div>-->
                                                    
                                            <div id="category_selected" Style="position:relative;top:-69px;" class="show_division">   
                                             <!-- Added Raj -->
                                             <div id="cicBlock" style="display:{!HTMLENCODE(showcic)}">
                                                <div class="user-panel">
                                                    <div class="user-panel-title-text" >Category Background: Landscape</div>                           
                                                    <div class="user-panel-content">                   
                                                        <apex:outputLabel value="Category Background Image - Landscape" /><br/><br/>
                                                        <apex:inputFile value="{!categoryLandscapeBgImage.body}" filename="{!categoryLandscapeBgImage.name}" styleclass="Category_Landscape_bg_cls" />
                                                        <apex:commandbutton action="{!uploadCategoryLandscapeBgImage}" value="Upload" styleclass="button_upload"/><br/>
                                                        <apex:outputLabel value="Category landscape background image resolution: 1024x768px at 132dpi" styleClass="hint" /><br/><br/>          
                                                    </div>
                                                </div> 
                                                <div class="user-panel" >
                                                        <div class="user-panel-title-text" >Category Background: Portrait</div>                            
                                                        <div class="user-panel-content">               
                                                            <apex:outputLabel value="Category Background Image - Portrait" /><br/><br/>
                                                            <apex:inputFile value="{!categoryPortraitBgImage.body}" filename="{!categoryPortraitBgImage.name}" styleclass="Category_portrait_bg_cls" />
                                                            <apex:commandbutton action="{!uploadCategoryPortraitBgImage}" value="Upload" styleclass="button_upload"/><br/>
                                                            <apex:outputLabel value="Category portrait background image resolution: 768x1024px at 132dpi" styleClass="hint" /><br/><br/>                        
                                                        </div>
                                                 </div> 
                                                <div class="user-panel">
                                                    <div class="user-panel-title-text">Content List Background Bar</div>                           
                                                    <div class="user-panel-content">                  
                                                        <apex:outputLabel value="Content List Background Image" /><br/><br/>
                                                        <apex:inputFile value="{!contentBackgroundImage.body}" filename="{!contentBackgroundImage.name}" styleclass="Content_List_bg_cls" />
                                                        <apex:commandbutton action="{!uploadContentBackgroundImage}" value="Upload" styleclass="button_upload"/><br/>
                                                         <apex:outputLabel value="Content list background image resolution: 55x55px at 132dpi" styleClass="hint" /><br/><br/>
                                                        
                                                        Preview:
                                                        <div class="cmcOutImg preview">                        
                                                            <apex:panelGrid id="cmcContImg1" border="0" cellspacing="0px" cellpadding="0px">
                                                                <apex:image rendered="{!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c}" />
                                                            </apex:panelGrid>
                                                        </div>  
                                                    </div>
                                                </div>                              
                                                <div class="user-panel">
                                                    <div class="user-panel-title-text">Content List Background Bar Selected</div>                            
                                                    <div class="user-panel-content">                  
                                                        <apex:outputLabel value="Content List Background Overlay Image" /><br/><br/>
                                                        <apex:inputFile value="{!contentOverBackgroundImage.body}" filename="{!contentOverBackgroundImage.name}" styleclass="Content_List_bg_cls"  />
                                                        <apex:commandbutton action="{!uploadContentOverBackgroundImage}" value="Upload" styleclass="button_upload"/><br/>
                                                        <apex:outputLabel value="Content list background Overlay image resolution: 55x55px at 132dpi" styleClass="hint" /><br/><br/>  
                                                        Preview:                                
                                                        <div class="cmcOutImg preview">
                                                            <apex:panelGrid id="cmcContImg2" border="0" cellspacing="0px" cellpadding="0px" styleClass="fullwidth">
                                                                <apex:image rendered="{!categoryMobileConfig.Barclays_SA__ContentOverAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__ContentOverAttachmentId__c}" />
                                                            </apex:panelGrid>
                                                        </div>
                                                    </div>
                                                </div>
                      <!-- Added Raj -->  </div>
                                    </div>
                                     <div class="wrap" style="visibility:hidden;">          
                                        <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Check_In_Enabled__c}"   styleClass="tmp_check_in_enabled"/>
                                        <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Active__c}"   styleClass="tmp_is_active_config"/>
                                        <apex:selectList value="{!selectedProfiles}" multiselect="true" size="0" styleClass="tmp_profile_list scrollSelectList">
                                            <apex:selectOptions value="{!profileList}"/>
                                        </apex:selectList>
                                     </div>
                               </div>
                                                       
                       <!--Added Raj</div>  -->
                           <!-- END: Tab #4 content -->
                                                    
                           <!-- START: Tab #5 content -->
                           <!-- SETTINGS-->
                                <div id="tabContent_5" style="display:none;" class="scroll-left-div">
                                
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Active Configuration Settings</div>
                                        <div class="user-panel-content">
                                                 
                                            <div class="wrap">          
                                                   <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Check_In_Enabled__c}"  id="checkInEnabled" styleClass="tmp_check_in_enabled"/>
                                                   <apex:outputLabel value="Check In" />
                                            </div>
                                            <div class="wrap">          
                                                <apex:inputCheckbox value="{!mobileAppConfigTemp.Barclays_SA__Active__c}"  id="isActiveConfig" styleClass="tmp_is_active_config"/>
                                                <apex:outputLabel value="Active Configuration" />
                                            </div>
                                                 
                                        </div>
                                    </div>
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Permissions</div>
                                        <div class="user-panel-content">  
                                            <div class="wrap">          
                                                <apex:selectList value="{!selectedProfiles}" multiselect="true" size="15" styleClass="tmp_profile_list scrollSelectList">
                                                    <apex:selectOptions value="{!profileList}"/>
                                                </apex:selectList>
                                            </div>         
                                        </div>
                                    </div>
                                    <div class="user-panel">
                                        <div class="user-panel-title-text">Report an Issue</div>
                                        <div class="user-panel-content">  
                                            <div class="wrap">      
                                                <apex:outputLabel value="Email address: " />    
                                                <apex:inputText value="{!mobileAppConfigTemp.Barclays_SA__Report_an_Issue__c}"  id="reportAnIssue" styleClass="tmp_report_an_issue"/>     
                                            </div>         
                                        </div>
                                    </div>      
                                </div>
                                <!-- END: Tab #5 content -->
                    
                        <!-- END: Put all content here that you want to be scrollable on the left -->
                            </div>
                        </td>
                        <td id="tabContentRight" Style="">
                            <div id="tabContentRightScroller" style="" class="scroll-right-div">
                                <!-- START: Put all content here that you want to be scrollable on the right -->
                                <div><!--style="position:absolute;left:570px;top:180px;float:center">-->
                                    <apex:tabPanel switchType="client" value="{!tabInFocuseBG}" inactiveTabClass="inactiveWhite" activeTabClass="activeWhite" headerAlignment="center" style="width:auto;" contentClass="sub-tab-style" > 
                                        <apex:tab label="Home" id="AppConfig" name="AppConfig" styleclass="switch_home" > 
                                            <div style="position:absolute;top:-51px;left:665px;border-radius: 0px; width:100px;">     
                                                <table class="customizer-bottom-table">
                                                    <tr>
                                                        <td class="left" align="left" width="40%">
                                                            <span class="landascapeview">
                                                                <img id="landscape_switch_active"  src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/Ipad-landscape-On.png')}" alt="l" onclick="ShowLandscapePreview()"/>
                                                                <img id="landscape_switch_inactive"  src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/Ipad-landscape-Off.png')}" alt="l" onclick="ShowLandscapePreview()"/>
                                                            </span>  
                                                        </td>
                                                        <td class="right" align="right" width="1%">
                                                        </td>
                                                        <td class="left" align="left" width="40%">
                                                            <span class="patriotview">
                                                                <img id="portrait_switch_active" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/ipad-portrait-On.png')}" alt="p" onclick="ShowPortraitPreview()"/>
                                                                <img id="portrait_switch_inactive" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/ipad-portrait-off.png')}" alt="p" onclick="ShowPortraitPreview()"/>
                                                            </span>                           
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <!-- LANDSCAPE PREVIEW-->
                                            <div id="tabLandscape1" style="position:static;top:0px;">
                                                <table class="user-panel-table" >
                                                    <tr>
                                                        <td class="column" >
                                                            <div class="user-panel-preview" >                      
                                                                <div Style="height: 616px;position: static;width: 768px;">
                                                                    <div style="position:absolute;left:18px;top:42px;float:center">
                                                                        <img style="width:780px;height:616px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/iPadFrameL.png')}"  />
                                                                    </div> 
                                                                     
                                                                    <div style="position:absolute;left:88px;top:108px;float:center ">
                                                                        <!-- Landscape Home View -->
                                                                        <apex:outputPanel layout="none" rendered="{!ISBLANK(mobileAppConfigTemp.Barclays_SA__LandscapeAttachmentId__c)}">
                                                                            <img style="  height: 15px;position: absolute;top: 0px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Landscape_first_header.png')}"  />
                                                                            <img style="height: 30px;position: absolute;top: 15px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                                                            <div class="compositor-landscape customizer" id="layout-landscape-customizer" style="height:480px !important;">
                                                                                <div class="layout-landscape-background" />
                                                                            </div>
                                                                            <img style="position:absolute;top:448px;left:-2px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="643" height="34"/>
                                                                            <apex:image styleclass="logo_preview_cls" rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:452px;left:4px;width:145px;height:32px;"/>
                                                                        </apex:outputPanel> 
                                                                        <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(mobileAppConfigTemp.Barclays_SA__LandscapeAttachmentId__c))}">
                                                                            <img style="height: 15px;position: absolute;top: 0px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Landscape_first_header.png')}"  />
                                                                            <img style="height: 30px;position: absolute;top: 15px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                                                            
                                                                            <div style="position:absolute;height:480px !important" class="compositor-landscape customizer" id="layout-landscape-customizer">
                                                                                <div class="layout-landscape-background">
                                                                                    <img class="landscape-to-scale" src="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.LandscapeAttachmentId__c}"/>
                                                                                </div>                                
                                                                            </div>
                                                                            
                                                                            <img style="position:absolute;top:448px;left:-2px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="643" height="34"/>
                                                                            <apex:image styleclass="logo_preview_cls" rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:450px;left:4px;width:145px;height:32px;"/>
                                                                        </apex:outputPanel>
                                                                                
                                                                        <!--<apex:image styleclass="logo_preview_cls" rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:-11px;left:4px;width:145px;height:28px;"/>-->
                                                                    </div> 
                                                                </div>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <!-- PORTRAIT PREVIEW-->
                                            <div id="tabPortrait" style="position:static;top:0px;display:none">
                                                <table class="user-panel-table" ><tr>
                                                    <td class="column">
                                                        <div class="user-panel-preview">
                                                            <div Style="position:static; width: 768px;height:852px;" >
                                                                <div style="position:absolute;left:57px;top:43px;float:center">
                                                                    <img Style="width:619px;height:793px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/iPadFrameP.png')}"  />
                                                                </div>
                                                                                        
                                                                <div style="position:absolute;left:129px;top:119px;float:center "> 
                                                                <!-- Portrait Home View -->
                                                                    <apex:outputPanel layout="none" rendered="{!ISBLANK(mobileAppConfigTemp.Barclays_SA__PortraitAttachmentId__c)}">
                                                                        <img style="  height: 15px;position: absolute;top: 0px;width: 480px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Portrait_first_header.png')}"  />
                                                                        <img style="height: 30px;position: absolute;top: 15px;width: 480px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                                    
                                                                        <div class="compositor-portrait customizer" id="layout-portrait-customizer">
                                                                            <div class="layout-portrait-background" />                                                             
                                                                        </div>
                                                    
                                                                        <img style="position:absolute;top:607px;left:0px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="480" height="34"/>
                                                                        <apex:image styleclass="logo_preview_cls"  rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:609px;left:4px;width:145px;height:32px;"/>
                                                                    </apex:outputPanel>
                                                        
                                                                    <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(mobileAppConfigTemp.Barclays_SA__PortraitAttachmentId__c))}">
                                                                        <img style="  height: 15px;position: absolute;top: 0px;width: 480px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Portrait_first_header.png')}"  />
                                                                        <img style="height: 30px;position: absolute;top: 15px;width: 480px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                                                        <div style="position:absolute;" class="compositor-portrait customizer" id="layout-portrait-customizer">                            
                                                                            <div class="layout-portrait-background">
                                                                                <img class="portrait-to-scale" src="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.PortraitAttachmentId__c}"/>
                                                                            </div>                                     
                                                                        </div>
                                                                        <img style="position:absolute;top:607px;left:0px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="480" height="34"/>
                                                                        <apex:image styleclass="logo_preview_cls"  rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:609px;left:4px;width:145px;height:32px;"/>
                                                                    </apex:outputPanel>
                                                
                                                                    <!--<apex:image styleclass="logo_preview_cls"  rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:-11px;left:4px;width:145px;height:31px;"/>-->
                                                
                                                                </div>
                                                            </div>
                                                        </div>
                                                   </td>
                                                </tr>
                                            </table>                         
                                        </div>
                                    </apex:tab>
                                    
                                   <apex:tab label="Category View" name="CategoryConfig" id="CategoryConfig" styleclass="switch_CategoryConfig">
                                   <div style="position:absolute;top:-51px;left:700px;border-radius: 0px; width:100px;">     
                                        <table class="customizer-bottom-table"><tr>
                                                            
                                                              <td class="left" align="left" width="40%">
                                                                <span class="landascapeview">
                                                              
                                                                <img id="Category_landscape_switch_active"  src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/Ipad-landscape-On.png')}" alt="l" onclick="ShowLandscapePreview_Category()"/>
                                                               <img id="Category_landscape_switch_inactive"  src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/Ipad-landscape-Off.png')}" alt="l" onclick="ShowLandscapePreview_Category()"/>
                                                                </span>   
                                                                </td>
                                                                 <td class="right" align="right" width="1%">
                                                               
                                                            </td>
                                                                
                                                                <td class="left" align="left" width="40%">
                                                                
                                                                <span class="patriotview">
                                                                
                                                                <img id="Category_portrait_switch_active" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/ipad-portrait-On.png')}" alt="p" onclick="ShowPortraitPreview_Category()"/>
                                                                <img id="Category_portrait_switch_inactive" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/ipad-portrait-off.png')}" alt="p" onclick="ShowPortraitPreview_Category()"/>
                                                                
                                                                </span>                           
                                                            </td>
                                                           
                                                             </tr></table>
                                                        </div>
                                                        <div>
                                
                                                    <!-- id="cicBlock"  -->
                                                    <apex:pageBlock id="cicBlock"  >
                                    <table class="user-panel-table" ><tr>
                                        <!-- Category Landscape Background -->
                                        <td class="column" id="category_landscape_background">
                                        <div class="user-panel-preview">
                                        <div Style="height: 616px;position: static;width: 768px;" >
                        
                                        <div style="position:absolute;left:18px;top:42px;float:center;">
                                            <img style="width:780px;height:616px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/iPadFrameL.png')}"  />
                                             
                                        </div>  
                                        <div style="position:absolute;left:88px;top:108px;float:center;">
                                            <apex:outputPanel layout="none">
                                                <img style="height: 15px;position: absolute;top: 0px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Landscape_first_header.png')}"  />
                                                <img style="height: 30px;position: absolute;top: 15px;width: 640px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                            </apex:outputPanel>
                                            <!--
                                            <div class="dyn-title-bg-preview" style="position:relative; top:-15px !important; height:29px; width:640px;background-color:#{!HTMLENCODE(mobileAppConfigTemp.TitleBgColor__c)};float:center"><p class="dyn-title-name-preview" style="position:relative;top:0px;padding:4px;font-size:15px;text-align:center;color:#{!HTMLENCODE(mobileAppConfigTemp.TitleTextColor__c)};">{!mobileAppConfigTemp.Barclays_SA__TitleText__c}</p></div>
                                            -->         
                                            <!-- <div class="compositor-landscape category-background-landscape cmcOutImg"> -->
                                                <div style="background-color: #d2d2d2; overflow: hidden; position: relative;" class="cmcOutImg">
                                                <apex:panelGrid columns="1" style="width: 640px; height: 475px;" id="cmcBck2"  border="0" cellspacing="0px" cellpadding="0px">
                                                <apex:image styleclass="category_l_bg_preview" style="height: 475px;left: 0px;position: absolute;top: 0px;width: 640px;" rendered="{!categoryMobileConfig.Barclays_SA__LandscapeAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__LandscapeAttachmentId__c}" />
                                                                    
                                                <div class="sub_category_hover"  style="background-color: #{!HTMLENCODE(categoryMobileConfig.Sub_Category_Background_Color__c)};height:475px;left: 0px;position: absolute;top: 0px;width: 150px;opacity:0.9;filter:Alpha(opacity=90);">                                                  
                                                    <ul>
                                                         <apex:variable value="{!40}" var="rowNum"/>
                                                         <apex:variable value="{!136}" var="rowNum_text"/>
                                                         <apex:repeat value="{!CurrentCategoryGalleryImages}" var="imgId_l">
                                                             <img id="Img_Iconl_{!imgId_l.ParentId}" Class="category_image_preview" style="position:absolute;top:{!rowNum}px;left: 30px;
                                                                width:90px; height: 90px; align: middle;" src="https://{!orgUrl}/servlet/servlet.FileDownload?file={!imgId_l}" />
                                                             <div style="position:absolute;top:{!rowNum_text}px;left:30px;
                                                                width:90px;font-size:12px;font-family:American Typewriter; text-align:center;">{!imgId_l.Parent.Name}</div>
                                                             <apex:variable var="rowNum" value="{!rowNum + 130}"/>
                                                             <apex:variable var="rowNum_text" value="{!rowNum + 100}"/> 
                                                        </apex:repeat>  
                                                    </ul>   
                                                </div>
                                                
                                                <div class="overlay_background_cls" style="background-color: #{!HTMLENCODE(categoryMobileConfig.OverlayBgColor__c)};height:439px;left: 150px;position: absolute;top: 0px;width: 490px;opacity: {!categoryMobileConfig.OverlayBgAlpha__c/100};filter:Alpha(opacity={!categoryMobileConfig.Barclays_SA__OverlayBgAlpha__c}); "></div>
    
                                                <img style="position:absolute;top:435px;left:-2px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="643" height="42"/>
                                                <apex:image styleclass="logo_preview_cls"  rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:440px;left:4px;width:145px;height:31px;"/>
                                                <div style="position:absolute; width: 300px;top:44px;left:164px;" class="Category_Description_Wrapper">
                                                      <apex:outputPanel id="thePanel_category_desc_l" style="position:absolute; width: 250px;top:44px;left:300px;" styleclass="Category_Description_Wrapper_l" rendered="{!isSecondLevelCategory}">
                                                            <p> <span style ="font-family:American Typewriter;font-size:22px;color:#{!HTMLENCODE(categoryMobileConfig.GalleryHeadingTextColor__c)};"><apex:outputtext value="{!categoryMobileConfig.Barclays_SA__GalleryHeadingText__c}" /></span>
                                                            <br/>
                                                            <span class="sub_category_description sub_cat_desc_title" style="font-size:22px;color:#{!HTMLENCODE(categoryMobileConfig.OverlayTextColor__c)};"><apex:outputtext value="{!selectedCategory.Name}" /></span></p>
                                                            <div id="div_sub_category_description" style="height:160px;overflow-x: hidden;overflow-y:hidden;">
                                                                <p class="sub_category_description sub_cat_desc_text" style="width:240px;font-size:14px;color:#000000;"><apex:outputtext value="{!selectedCategory.Barclays_SA__Description__c}" /></p>
                                                            </div>
                                                            <br/><br/>
                                                            <!-- <p class="sub_category_description" style="font-size:19px;font-weight:bold;position:absolute;left:0px;top:231px;color:#{!HTMLENCODE(categoryMobileConfig.OverlayTextColor__c)};">Related Content:</p> -->
                                                            <span style="font-size:16px;font-family:American Typewriter;color:#e2e2e2;top: 200px; position:absolute;left: 5px; z-index:1;">content pdf</span>
                                                            <span style="font-size:16px;font-family:American Typewriter;color:#e2e2e2;top: 200px; position:absolute;left: 280px; z-index:1;">></span>
                                                            <div style="left: -10px;position: absolute;top: 185px; width: 300px;height: 30px;background-color: #000000;opacity: 0.4;filter:alpha(opacity=40);margin: 10px;"> </div>
                                                            <apex:image styleclass="content_list_bg_preview" rendered="{!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c}" style="position: absolute;left: 0px;top: 195px;height: 30px;width: 300px;"/>
                                                    </apex:outputPanel>
                                                </div>     
                                                </apex:panelGrid>
                                            </div>
                                       </div>
                                       </div>
                                       </div>                                  
                                       </td>
                                       
                                       <!-- Category Portrait Background -->
                                       <td class="column" id="category_Portrait_background">
                                            <div class="user-panel-preview" style="min-width:664px;">
                                            <div  Style="position:static; width: 768px;height:800px;"> 
                                            <div style="position:absolute;left:62px;top:39px;float:center">
                                                <img Style="width:708px;height:826px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsav3_imx/iPadFrameP.png')}"  />
                                            </div>
                                           <!-- <div style="position:absolute;left:132px;top:100px;float:center;"  class="compositor-portrait category-background-portrait cmcOutImg">  -->
                                            <div style="position:absolute;left:145px;top:101px;float:center;">
                                                <img style="height: 17px;position: absolute;left:0px;top:17px;width: 550px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_first_headers/Portrait_first_header.png')}"  />
                                                <img style="height: 30px;position: absolute;top: 34px;width: 550px; z-index: 1;" src="{!URLFOR($Resource.DSA_Assets, 'images/ipad_headers/Landscape_DSA_Top_Bar.png')}"  />
                                                <!--<div class="dyn-title-bg-preview" style="position:relative; top:-18px !important; height:35px; width:568px;background-color:#{!HTMLENCODE(mobileAppConfigTemp.TitleBgColor__c)};float:center"><p class="dyn-title-name-preview" style="position:relative;top:0px;padding:7px;font-size:17px;text-align:center;color:#{!HTMLENCODE(mobileAppConfigTemp.TitleTextColor__c)};">{!mobileAppConfigTemp.Barclays_SA__TitleText__c}</p></div>-->
                                                
                                                <apex:panelGrid columns="1" style="width: 550px; height: 678px;" id="cmcBck1" border="0" cellspacing="0px" cellpadding="0px">
                                                    <apex:image styleclass="category_p_bg_preview" style="height: 678px;position: absolute;top: 17px;width: 550px;left:0px" rendered="{!categoryMobileConfig.Barclays_SA__PortraitAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__PortraitAttachmentId__c}" />
                                                    <div  class="overlay_background_cls" style="background-color: #{!HTMLENCODE(categoryMobileConfig.OverlayBgColor__c)};height:678px;left: 100px;position: absolute;top: 17px;width: 450px;opacity:{!categoryMobileConfig.OverlayBgAlpha__c/100}; filter:Alpha(opacity={!categoryMobileConfig.Barclays_SA__OverlayBgAlpha__c}); ">
                                                    </div>
                                                    <div class="sub_category_hover" style="background-color: #{!HTMLENCODE(categoryMobileConfig.Sub_Category_Background_Color__c)};height: 678px;left: 0;position: absolute; top:17px;width: 100px;opacity: 0.9;filter:Alpha(opacity=90); ">
                                                        <apex:variable value="{!260}" var="rowNump"/>
                                                        <apex:variable value="{!330}" var="rowNump_text"/>
                                                        <apex:repeat value="{!CurrentCategoryGalleryImages}" var="imgAttach">                                       
                                                           <img id="Img_Icon_{!imgAttach.ParentId}" class="category_image_preview" style="position:absolute;top:{!rowNump}px;left:15px;
                                                                width:60px; height: 60px;" src="https://{!orgUrl}/servlet/servlet.FileDownload?file={!imgAttach.Id}" />
                                                            <div style="position:absolute;top: {!rowNump_text}px;left:15px;
                                                                width:60px;font-size:12px;font-family:American Typewriter;">{!imgAttach.Parent.Name}</div>                                                        
                                                            <apex:variable var="rowNump" value="{!rowNump + 130}"/>
                                                            <apex:variable var="rowNump_text" value="{!rowNump + 70}"/>
                                                        </apex:repeat>
                                                     </div>    

                                                    <img style="position:absolute;top:655px;left:0px;" src="{!URLFOR($Resource.DSA_Assets, 'images/dsa_images/l_dsa_tab_bar.png')}" alt="l" width="550" height="42"/>
                                                    <apex:image styleclass="logo_preview_cls"  rendered="{!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__LogoAttachmentId__c}" style="position:absolute; top:660px;left:4px;width:145px;height:31px;"/>
                                                 </apex:panelGrid>       
                                                 <div style="position:absolute; width: 300px;top:150px;left:200px;" class="Category_Description_Wrapper">
                                                    <!-- <apex:outputPanel id="thePanel_category_desc_p" style="position:absolute;top:-6px; left:14px; width: 250px;" styleclass="Category_Description_Wrapper_l" rendered="{!isSecondLevelCategory}"> -->
                                                    <apex:outputPanel id="thePanel_category_desc_p" style="position:absolute;top:0px; left:0px; width: 250px;" styleclass="Category_Description_Wrapper_l">
                                                                <p> <span style ="font-family:American Typewriter;font-size:14px;color:#{!HTMLENCODE(categoryMobileConfig.GalleryHeadingTextColor__c)};"><apex:outputtext value="{!categoryMobileConfig.Barclays_SA__GalleryHeadingText__c}" /></span>
                                                                    <br/>
                                                                    <span class="sub_category_description sub_cat_desc_title" style="font-size:22px;color:#{!HTMLENCODE(categoryMobileConfig.OverlayTextColor__c)};"><apex:outputText value="{!selectedCategory.Name}"/></span>
                                                                </p>
                                                                <p class="sub_category_description sub_cat_desc_text" style="font-size:14px;color:#000000;"><apex:outputtext value="{!selectedCategory.Barclays_SA__Description__c}" /></p>
                                                                <br/><br/>
                                                                <span style="font-size:16px;font-family:American Typewriter;color:#e2e2e2;top: 200px; position:absolute;left: 5px; z-index:1;">content pdf</span>
                                                                <span style="font-size:16px;font-family:American Typewriter;color:#e2e2e2;top: 200px; position:absolute;left: 280px; z-index:1;">></span>
                                                                <div style="left: -10px;position: absolute;top: 185px; width: 300px;height: 30px;background-color: #000000;opacity: 0.4;filter:alpha(opacity=40);margin: 10px;"> </div>
                                                                <apex:image styleclass="content_list_bg_preview" rendered="{!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!categoryMobileConfig.Barclays_SA__ContentAttachmentId__c}" style="position: absolute;left: 0px;top: 195px;height: 30px;width: 300px;"/>
                                                     </apex:outputPanel>
                                                </div>    
                                            </div>
                                        </div>
                                    </div>                                  
                                </td>
                            </tr></table>
                                    
                         </apex:pageBlock>
                        </div>
                                        
                                
                                   </apex:tab>
                                                 
                                    </apex:tabPanel>
                                    <div class="wrap preview" style="visibility:hidden;">
                                              <apex:image id="imgButton1" rendered="{!mobileAppConfigTemp.Barclays_SA__ButtonDefaultAttachmentId__c != ''}" value="https://{!orgUrl}/servlet/servlet.FileDownload?file={!mobileAppConfigTemp.Barclays_SA__ButtonDefaultAttachmentId__c}" />
                                              </div>
                                    </div>
                                 <!-- END: Put all content here that you want to be scrollable on the right -->
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </apex:form>
     
     
       <script>
       /*
 window.onbeforeunload = function() {
        browserClose();
        };
       */     
var tabfocus = '{!JSENCODE(tabInFocuse)}';

if(tabfocus=="Brand"){
                doTabClick(2);
                
                }else if(tabfocus=="Layout"){
                doTabClick(3);
                }else if(tabfocus=="Navigation"){
                doTabClick(4);
                

                }else if(tabfocus=="ConfigSettings"){
                doTabClick(5);
                }
                    </script>
        
        </body>
    </html>
</apex:page>