<apex:page controller="advpm.ExportTemplateDataController" language="en-US" showHeader="false" sidebar="false" cache="true" contentType="text/csv#dataExport.csv">
<apex:variable var="i" value="{!0}" /><apex:repeat value="{!columnValues}" var="c"><apex:variable var="i" value="{!(i + 1)}" /><apex:outputPanel layout="none" rendered="{!c.isAddress==false}">"{!c.label}"{!IF(i < columnValues.size, ',', '')}</apex:outputPanel><apex:outputPanel layout="none" rendered="{!c.isAddress==true}">"{!c.label} Line 1","{!c.label} Line 2","{!c.label} Line 3"{!IF(i < columnValues.size, ',', '')}</apex:outputPanel></apex:repeat>{!NewLine}<apex:repeat value="{!ExportData}" var="e"><apex:variable var="j" value="{!0}" /><apex:repeat value="{!columnValues}" var="c"><apex:variable var="j" value="{!(j + 1)}" />"<apex:outputText rendered="{!c.datatype=='DATE'}" value="{0,date,yyyy-MM-dd}"><apex:param value="{!e[c.name]}" /></apex:outputText><apex:outputText rendered="{!c.datatype=='DATETIME'}" value="{0,date,yyyy-MM-dd'T'hh:mm:ssZ}"><apex:param value="{!e[c.name]}" /></apex:outputText><apex:outputPanel layout="none" rendered="{!(c.datatype!='DATE' && c.datatype!='DATETIME' && c.isAddress==false)}">{!e[c.name]}</apex:outputPanel><apex:outputPanel layout="none" rendered="{!(c.datatype!='DATE' && c.datatype!='DATETIME' && c.isAddress==true)}"><apex:repeat value="{!map_addr_values[e.Id]}" var="addr">{!addr}","</apex:repeat></apex:outputPanel>"{!IF(j < columnValues.size, ',', '')}</apex:repeat>{!NewLine}</apex:repeat>
</apex:page>